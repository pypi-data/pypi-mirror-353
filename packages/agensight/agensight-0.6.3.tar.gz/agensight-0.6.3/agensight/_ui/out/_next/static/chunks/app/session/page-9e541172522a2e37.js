(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[501],{285:(e,t,r)=>{"use strict";r.d(t,{$:()=>l});var s=r(5155);r(2115);var a=r(9708),n=r(2085),c=r(9434);let i=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all cursor-pointer disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function l(e){let{className:t,variant:r,size:n,asChild:l=!1,...o}=e,d=l?a.DX:"button";return(0,s.jsx)(d,{"data-slot":"button",className:(0,c.cn)(i({variant:r,size:n,className:t})),...o})}},746:(e,t,r)=>{Promise.resolve().then(r.bind(r,8538))},4186:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(9946).A)("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},6126:(e,t,r)=>{"use strict";r.d(t,{E:()=>i});var s=r(5155);r(2115);var a=r(2085),n=r(9434);let c=(0,a.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:r,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)(c({variant:r}),t),...a})}},6654:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useMergedRef",{enumerable:!0,get:function(){return a}});let s=r(2115);function a(e,t){let r=(0,s.useRef)(null),a=(0,s.useRef)(null);return(0,s.useCallback)(s=>{if(null===s){let e=r.current;e&&(r.current=null,e());let t=a.current;t&&(a.current=null,t())}else e&&(r.current=n(e,s)),t&&(a.current=n(t,s))},[e,t])}function n(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let r=e(t);return"function"==typeof r?r:()=>e(null)}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},7652:(e,t,r)=>{"use strict";r.d(t,{Dq:()=>i,Np:()=>l,_K:()=>c,_k:()=>o,j:()=>d,um:()=>a,zi:()=>n});let s="http://0.0.0.0:5001/api";async function a(e){for(let t=1;t<=3;t++)try{let t=await fetch("".concat(s,"/traces/").concat(e,"/spans"));if(!t.ok){let e=await t.text();throw console.error("Error fetching trace: ".concat(t.status," ").concat(t.statusText),e),Error("Error fetching trace: ".concat(t.statusText))}return await t.json()}catch(r){if(console.error("Failed to fetch trace with ID ".concat(e," (attempt ").concat(t,"/").concat(3,"):"),r),3===t)throw r;await new Promise(e=>setTimeout(e,500*Math.pow(2,t-1)))}}async function n(e){for(let t=1;t<=3;t++)try{let t=await fetch("".concat(s,"/span/").concat(e,"/details"));if(!t.ok){let e=await t.text();throw console.error("Error fetching span details: ".concat(t.status," ").concat(t.statusText),e),Error("Error fetching span details: ".concat(t.statusText))}return await t.json()}catch(r){if(console.error("Failed to fetch span details with ID ".concat(e," (attempt ").concat(t,"/").concat(3,"):"),r),3===t)throw r;await new Promise(e=>setTimeout(e,500*Math.pow(2,t-1)))}throw Error("Failed to fetch span details")}async function c(){try{let e=await fetch("".concat(s,"/traces"));if(!e.ok)throw Error("Error fetching traces");return await e.json()}catch(e){throw console.log("Failed to fetch all traces:",e),e}}async function i(){try{let e=await fetch("".concat(s,"/sessions"));if(!e.ok)throw Error("Error fetching sessions: ".concat(e.statusText));return await e.json()}catch(e){throw console.error("Failed to fetch sessions:",e),e}}async function l(e){try{let t=await fetch("".concat(s,"/sessions/").concat(e,"/traces"));if(!t.ok)throw Error("Error fetching traces: ".concat(t.statusText));return await t.json()}catch(e){throw console.error("Failed to fetch traces:",e),e}}async function o(e){try{let t=await fetch("".concat(s,"/traces/").concat(e,"/spans"));if(!t.ok)throw Error("Error fetching spans: ".concat(t.statusText));return await t.json()}catch(e){throw console.error("Failed to fetch spans:",e),e}}async function d(e){try{let t=await fetch("".concat(s,"/span/").concat(e,"/details"));if(!t.ok)throw Error("Error fetching spans: ".concat(t.statusText));return await t.json()}catch(e){throw console.error("Failed to fetch spans:",e),e}}},8538:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>N});var s=r(5155),a=r(2115),n=r(5695),c=r(2960),i=r(7652),l=r(9946);let o=(0,l.A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);var d=r(4186),u=r(6474);let x=(0,l.A)("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);var h=r(285),f=r(6126),m=r(8856),p=r(8643),g=r(6874),b=r.n(g);function v(){var e,t;let r=(0,n.useSearchParams)().get("sessionId"),{data:l,isLoading:x,error:m}=(0,c.I)({queryKey:["session-traces",r],queryFn:()=>r?(0,i.Np)(r):[],enabled:!!r}),[g,v]=a.useState([]),[N,k]=a.useState({}),z=a.useRef(null),_=a.useRef(null),E=e=>{k(t=>({...t,[e]:!t[e]}))};a.useEffect(()=>{l&&Array.isArray(l)&&(async()=>{v(await Promise.all(l.map(e=>(0,i._k)(e.id))))})()},[l]);let T=a.useMemo(()=>l&&Array.isArray(l)&&g.length===l.length?l.map((e,t)=>{let r=g[t];return Array.isArray(r)&&(r=void 0),{traceId:e.id,trace_input:(null==r?void 0:r.trace_input)||"",trace_output:(null==r?void 0:r.trace_output)||"",agents:(null==r?void 0:r.agents)||[],trace:e,timestamp:e.started_at||0}}).sort((e,t)=>e.timestamp-t.timestamp):[],[l,g]),A=a.useCallback(e=>{if(_.current){let t=e.currentTarget.scrollTop/(e.currentTarget.scrollHeight-e.currentTarget.clientHeight)*(_.current.scrollHeight-_.current.clientHeight);_.current.scrollTop=t}},[]),I=a.useCallback(e=>{if(z.current){let t=e.currentTarget.scrollTop/(e.currentTarget.scrollHeight-e.currentTarget.clientHeight)*(z.current.scrollHeight-z.current.clientHeight);z.current.scrollTop=t}},[]);return x?(0,s.jsx)(j,{}):m?(0,s.jsx)(w,{}):T.length?(0,s.jsxs)("div",{className:"flex flex-col w-full h-screen bg-zinc-50 dark:bg-zinc-900",children:[(0,s.jsx)("header",{className:"sticky top-0 z-10 w-full bg-white dark:bg-zinc-950 border-b border-zinc-200 dark:border-zinc-800 px-3 py-2",children:(0,s.jsxs)("div",{className:"flex items-center justify-between max-w-screen-2xl mx-auto",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(h.$,{variant:"ghost",size:"icon",className:"h-7 w-7",asChild:!0,children:(0,s.jsxs)(b(),{href:"/sessions",children:[(0,s.jsx)(o,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Back"})]})}),(0,s.jsx)("h1",{className:"text-sm font-semibold",children:"Session Viewer"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(f.E,{variant:"outline",className:"font-mono text-xs h-5 px-1.5",children:[null==r?void 0:r.substring(0,8),"..."]}),(0,s.jsxs)(f.E,{variant:"secondary",className:"text-xs h-5 px-1.5",children:[(0,s.jsx)(d.A,{className:"mr-1 h-3 w-3"}),(null==(t=T[0])||null==(e=t.trace)?void 0:e.started_at)?new Date(1e3*T[0].trace.started_at).toLocaleTimeString():"N/A"]})]})]})}),(0,s.jsx)("div",{className:"flex-1 overflow-hidden max-w-screen-2xl w-full mx-auto",children:(0,s.jsxs)("div",{className:"flex h-[calc(100vh-3rem)]",children:[(0,s.jsx)("div",{className:"w-[65%] border-r border-zinc-200 dark:border-zinc-800",children:(0,s.jsx)("div",{className:"h-full overflow-y-auto",ref:z,onScroll:A,children:(0,s.jsx)("div",{className:"p-3 space-y-4",children:T.map((e,t)=>{var r,a;return(0,s.jsxs)("div",{className:"relative pb-4",id:"trace-".concat(e.traceId),children:[(0,s.jsxs)(f.E,{variant:"outline",className:"absolute left-0 top-0 font-mono text-xs px-1.5 bg-zinc-100 dark:bg-zinc-800 rounded-md",children:["Trace ID: ",e.traceId]}),(0,s.jsxs)("div",{className:"flex flex-col items-end space-y-1 mb-3 mt-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("span",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:"User"}),(0,s.jsx)("div",{className:"h-5 w-5 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-blue-600 dark:text-blue-300 text-xs font-medium",children:"U"})})]}),(0,s.jsx)("div",{className:"bg-blue-500 text-white px-3 py-2 rounded-xl rounded-tr-none max-w-[90%]",children:(0,s.jsx)("p",{className:"whitespace-pre-line text-xs",children:e.trace_input})}),(0,s.jsx)("span",{className:"text-[10px] text-zinc-500 dark:text-zinc-400",children:(null==(r=e.trace)?void 0:r.started_at)?new Date(1e3*e.trace.started_at).toLocaleTimeString():""})]}),e.trace_output&&(0,s.jsxs)("div",{className:"flex flex-col items-start space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("div",{className:"h-5 w-5 rounded-full bg-purple-100 dark:bg-purple-900 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-purple-600 dark:text-purple-300 text-xs font-medium",children:"A"})}),(0,s.jsx)("span",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:"Assistant"})]}),(0,s.jsx)("div",{className:"bg-zinc-100 dark:bg-zinc-800 px-3 py-2 rounded-xl rounded-tl-none w-full max-w-[90%]",children:(0,s.jsx)("p",{className:"whitespace-pre-line text-xs",children:e.trace_output})}),(0,s.jsx)("span",{className:"text-[10px] text-zinc-500 dark:text-zinc-400",children:(null==(a=e.trace)?void 0:a.ended_at)?new Date(1e3*e.trace.ended_at).toLocaleTimeString():""})]}),t<T.length-1&&(0,s.jsx)("div",{className:"border-b border-dashed border-zinc-200 dark:border-zinc-800 mt-3"})]},e.traceId)})})})}),(0,s.jsx)("div",{className:"w-[35%] bg-zinc-50 dark:bg-zinc-900",children:(0,s.jsx)("div",{className:"h-full overflow-y-auto",ref:_,onScroll:I,children:(0,s.jsxs)("div",{className:"p-3",children:[(0,s.jsx)("div",{className:"text-xs font-medium mb-2 text-zinc-500 dark:text-zinc-400 border-b border-zinc-200 dark:border-zinc-800 pb-1",children:"Agent Details"}),T.map((e,t)=>{var r;return(0,s.jsxs)("div",{className:"mb-4",id:"details-".concat(e.traceId),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,s.jsxs)(f.E,{variant:"outline",className:"font-mono text-[10px] h-4 px-1",children:["Trace ID: ",e.traceId]}),(0,s.jsx)("span",{className:"text-[10px] text-zinc-500 dark:text-zinc-400",children:(null==(r=e.trace)?void 0:r.started_at)?new Date(1e3*e.trace.started_at).toLocaleTimeString():""})]}),e.agents&&e.agents.length>0?(0,s.jsxs)(p.Nt,{open:N[e.traceId],onOpenChange:()=>E(e.traceId),className:"w-full",children:[(0,s.jsx)(p.R6,{asChild:!0,children:(0,s.jsxs)(h.$,{variant:"ghost",size:"sm",className:"w-full h-6 px-2 text-xs justify-between mb-1 bg-white dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 rounded",children:[(0,s.jsxs)("span",{children:[e.agents.length," Agent",e.agents.length>1?"s":""]}),(0,s.jsx)(u.A,{className:"h-3 w-3 transition-transform ".concat(N[e.traceId]?"rotate-180":"")})]})}),(0,s.jsx)(p.Ke,{className:"space-y-2 mt-1",children:e.agents.map((e,t)=>(0,s.jsxs)("div",{className:"bg-white dark:bg-zinc-950 rounded border border-zinc-200 dark:border-zinc-800 p-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,s.jsxs)("span",{className:"text-[10px] font-medium",children:["Agent ",t+1]}),(0,s.jsx)(f.E,{variant:"outline",className:"text-[10px] h-4 px-1",children:e.model||"Unknown"})]}),(0,s.jsxs)("div",{className:"text-[10px] text-zinc-500 dark:text-zinc-400 mb-1",children:["Tokens: ",e.tokens||"N/A"]}),(0,s.jsx)("div",{className:"bg-zinc-50 dark:bg-zinc-900 rounded p-1 max-h-[80px] overflow-y-auto",children:(0,s.jsx)("p",{className:"text-[10px] whitespace-pre-line",children:e.final_completion})})]},e.span_id||t))})]}):(0,s.jsx)("div",{className:"text-[10px] text-zinc-500 dark:text-zinc-400 italic",children:"No agent data available"}),t<T.length-1&&(0,s.jsx)("div",{className:"border-b border-dashed border-zinc-200 dark:border-zinc-800 mt-2"})]},"details-".concat(e.traceId))})]})})})]})})]}):(0,s.jsx)(y,{})}function j(){return(0,s.jsx)("div",{className:"flex flex-col items-center justify-center h-screen p-4",children:(0,s.jsxs)("div",{className:"w-full max-w-md space-y-4",children:[(0,s.jsx)(m.E,{className:"h-6 w-3/4 mx-auto"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m.E,{className:"h-16 w-full"}),(0,s.jsx)(m.E,{className:"h-16 w-full"}),(0,s.jsx)(m.E,{className:"h-16 w-full"})]})]})})}function w(){return(0,s.jsx)("div",{className:"flex flex-col items-center justify-center h-screen p-4",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-red-500 mb-2",children:"Error Loading Traces"}),(0,s.jsx)("p",{className:"text-sm text-zinc-600 dark:text-zinc-400 mb-4",children:"There was a problem loading the session data. Please try again."}),(0,s.jsx)(h.$,{asChild:!0,size:"sm",children:(0,s.jsx)(b(),{href:"/sessions",children:"Return to Sessions"})})]})})}function y(){return(0,s.jsx)("div",{className:"flex flex-col items-center justify-center h-screen p-4",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(x,{className:"h-10 w-10 text-zinc-400 mx-auto mb-3"}),(0,s.jsx)("h2",{className:"text-xl font-bold mb-2",children:"No Conversation Data"}),(0,s.jsx)("p",{className:"text-sm text-zinc-600 dark:text-zinc-400 mb-4",children:"There are no traces available for this session."}),(0,s.jsx)(h.$,{asChild:!0,size:"sm",children:(0,s.jsx)(b(),{href:"/sessions",children:"Return to Sessions"})})]})})}function N(){return(0,s.jsx)(a.Suspense,{fallback:(0,s.jsx)("div",{children:"Loading session..."}),children:(0,s.jsx)(v,{})})}},8643:(e,t,r)=>{"use strict";r.d(t,{Ke:()=>i,Nt:()=>n,R6:()=>c});var s=r(5155),a=r(8106);function n(e){let{...t}=e;return(0,s.jsx)(a.bL,{"data-slot":"collapsible",...t})}function c(e){let{...t}=e;return(0,s.jsx)(a.R6,{"data-slot":"collapsible-trigger",...t})}function i(e){let{...t}=e;return(0,s.jsx)(a.Ke,{"data-slot":"collapsible-content",...t})}},8856:(e,t,r)=>{"use strict";r.d(t,{E:()=>n});var s=r(5155),a=r(9434);function n(e){let{className:t,...r}=e;return(0,s.jsx)("div",{"data-slot":"skeleton",className:(0,a.cn)("bg-accent animate-pulse rounded-md",t),...r})}},9434:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n});var s=r(2596),a=r(9688);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,s.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[126,525,960,348,441,684,358],()=>t(746)),_N_E=e.O()}]);