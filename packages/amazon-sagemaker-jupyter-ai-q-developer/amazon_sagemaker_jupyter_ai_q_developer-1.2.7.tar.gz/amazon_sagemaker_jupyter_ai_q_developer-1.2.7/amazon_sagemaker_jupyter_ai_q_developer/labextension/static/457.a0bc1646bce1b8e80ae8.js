"use strict";(self.webpackChunk_amzn_amazon_sagemaker_jupyter_ai_q_developer=self.webpackChunk_amzn_amazon_sagemaker_jupyter_ai_q_developer||[]).push([[457],{9457:(e,t,a)=>{a.r(t),a.d(t,{customPlaceholderPlugin:()=>I,customQHeaderPlugin:()=>T,default:()=>O,footerPlugin:()=>j,telemetryPlugin:()=>A,unifiedStudioConcealedLLMConfigPlugin:()=>L});var n=a(9844),o=a(1689),i=a(186);const r=[200,201];var s;!function(e){e.POST="POST",e.GET="GET",e.PUT="PUT"}(s||(s={}));class l extends Error{constructor(e,t,a,n){super(e),this.errorStatus=t,this.errorCode=a,this.cause=n,Object.setPrototypeOf(this,l.prototype)}}const d=async(e,t,a,n)=>{var s,d;const c=i.ServerConnection.makeSettings({}),u=o.URLExt.join(c.baseUrl,e),v={method:t};a&&(v.body=a),n&&(v.headers=n);const m=await i.ServerConnection.makeRequest(u,v,c);if(!r.includes(m.status)){const e=await m.json(),t=null!==(s=e.errorCode)&&void 0!==s?s:void 0,a=null!==(d=e.errorMessage)&&void 0!==d?d:"unable to fetch data";throw new l(a,m.status,t)}return m},c="@amzn/amazon_sagemaker_jupyter_ai_q_developer";var u;!function(e){e.SMStudio="SageMaker Studio",e.SMStudioSSO="SageMaker Studio SSO",e.MD_IAM="MD_IAM",e.MD_IDC="MD_IDC",e.MD_SAML="MD_SAML",e.UNKNOWN="UNKNOWN"}(u||(u={}));const v=async()=>{try{const e=await d("/aws/sagemaker/api/auth-details",s.POST),t=await e.json();return{env:t.environment,isQDeveloperEnabled:t.isQDeveloperEnabled}}catch(e){console.error("Failed to fetch environment: ",e)}};var m=a(3345),p=a.n(m),g=a(3860),h=a.n(g),f=a(2395),y=a(9708),_=a(484);const S=new _.LabIcon({name:`${c}:upvote-icon`,svgstr:'<svg class="jp-icon3" width="32" height="32" viewBox="0 0 36 36" fill="#616161" xmlns="http://www.w3.org/2000/svg">\n  <path\n        clipRule="evenodd"\n        d="M18.522 12.173l-2.486 4.14v5.723h5.44a1 1 0 00.969-.76l1.01-4.049a1 1 0 00-.97-1.24h-2.44a1 1 0 01-1-1v-2.67a.276.276 0 00-.28-.28.293.293 0 00-.243.136zm-4.486 9.863v-5h-1v5h1zm.434-7l2.338-3.895.002-.003a2.293 2.293 0 011.956-1.102 2.276 2.276 0 012.28 2.28v1.67h1.44a3 3 0 012.91 3.719v.003l-1.01 4.048v.001a3 3 0 01-2.91 2.28h-9.44a1 1 0 01-1-1v-7a1 1 0 011-1h2.434z"\n        fillRule="evenodd"\n      />\n</svg>'}),b=new _.LabIcon({name:`${c}:downvote-icon`,svgstr:'<svg class="jp-icon3" transform="scale(-1,-1)" width="32" height="32" viewBox="0 0 36 36" fill="#616161" xmlns="http://www.w3.org/2000/svg">\n  <path\n        clipRule="evenodd"\n        d="M18.522 12.173l-2.486 4.14v5.723h5.44a1 1 0 00.969-.76l1.01-4.049a1 1 0 00-.97-1.24h-2.44a1 1 0 01-1-1v-2.67a.276.276 0 00-.28-.28.293.293 0 00-.243.136zm-4.486 9.863v-5h-1v5h1zm.434-7l2.338-3.895.002-.003a2.293 2.293 0 011.956-1.102 2.276 2.276 0 012.28 2.28v1.67h1.44a3 3 0 012.91 3.719v.003l-1.01 4.048v.001a3 3 0 01-2.91 2.28h-9.44a1 1 0 01-1-1v-7a1 1 0 011-1h2.434z"\n        fillRule="evenodd"\n      />\n</svg>'});var k;!function(e){e.Upvote="upvote",e.Downvote="downvote"}(k||(k={}));const D=({message:e})=>{const t=(0,n.useTelemetry)(),[a,o]=p().useState({submitted:!1,likeDisabled:!1,dislikeDisabled:!1}),i=n=>{a.submitted||(t.onEvent(((e,t)=>({type:e,message:{id:t.id,type:t.type,time:t.time,metadata:"metadata"in t?t.metadata:{}}}))(n,e)),o(h()((e=>{e.submitted=!0,n===k.Upvote?e.dislikeDisabled=!0:e.likeDisabled=!0}))))};return p().createElement(f.A,{sx:{display:"flex",justifyContent:"flex-end",alignItems:"center",padding:"6px 2px",marginBottom:"1em"}},p().createElement(y.A,{sx:{padding:"4px",...a.likeDisabled&&{opacity:.5}},onClick:()=>i(k.Upvote),"data-testid":"upvote-button",disabled:a.likeDisabled,title:a.dislikeDisabled?"Thank you for your feedback":a.likeDisabled?void 0:"Good response"},p().createElement(S.react,{elementPosition:"center",tag:"span"})),p().createElement(y.A,{sx:{padding:"4px",...a.dislikeDisabled&&{opacity:.5}},onClick:()=>i(k.Downvote),"data-testid":"downvote-button",disabled:a.dislikeDisabled,title:a.likeDisabled?"Thank you for your feedback":a.dislikeDisabled?void 0:"Bad response"},p().createElement(b.react,{elementPosition:"center",tag:"span"})))},w=e=>"agent"!==e.message.type&&"agent-stream"!==e.message.type||"agent-stream"===e.message.type&&!e.message.complete||void 0===e.message.metadata.q_conversation_id||void 0===e.message.metadata.q_message_id?null:p().createElement(D,{message:e.message});var E,C=a(5256);function x(){return p().createElement("div",{style:{display:"flex"}},p().createElement(M,null),p().createElement(z,null))}function M(){return p().createElement("div",{className:"jp-RenderedHTMLCommon",style:{fontSize:"1.1rem",fontWeight:700}},"Amazon Q")}function z(){const[e,t]=p().useState(null);return p().useEffect((()=>{(async()=>{try{const n=await v();if(!n)return;const o=(e=n.env,a=n.isQDeveloperEnabled,e===u.MD_IDC||e===u.SMStudioSSO&&a?E.Q_DEV:E.FREE);t(o)}catch(e){console.error("Error fetching data to set Q tier:",e)}var e,a})()}),[]),e?p().createElement("div",{style:P(e)},e):null}!function(e){e.FREE="Free Tier",e.Q_DEV="Pro Tier"}(E||(E={}));const P=e=>{const t={zIndex:5,borderRadius:"4px",padding:"2px 8px 2px 8px",textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",height:"100%"};return E.FREE===e?{...t,color:"white",backgroundColor:"#414D5C"}:{...t,color:"white",background:"linear-gradient(90deg, #3C1987CC 0%, #5073FECC 100%)",fontWeight:"500"}};class q extends _.ReactWidget{render(){return p().createElement(x,null)}}const A={id:`${c}:custom-telemetry`,autoStart:!0,provides:n.IJaiTelemetryHandler,activate:()=>(console.log("JupyterLab extension telemetry plugin is activated"),{onEvent:e=>{d("/amazon_sagemaker_jupyter_ai_q_developer/telemetry",s.POST,JSON.stringify(e))}})},I={id:`${c}:custom-placeholder-plugin`,autoStart:!0,requires:[n.IJaiCore],activate:(e,{chatWidget:t})=>{console.log("JupyterLab custom placeholder plugin is activated"),e.restored.then((()=>{var e;null===(e=null==t?void 0:t.renderPromise)||void 0===e||e.then((()=>{const e=t.node.querySelector('*[placeholder="Ask Amazon Q"]');e&&(e.placeholder='Ask any question or type "/" for actions')}))}))}},T={id:"@amzn/amazon_sagemaker_jupyter_ai_q_developer:custom-q-header-plugin",autoStart:!0,requires:[n.IJaiCore],activate:(e,{chatWidget:t})=>{e.restored.then((()=>{var e;const a=new q;null===(e=null==t?void 0:t.renderPromise)||void 0===e||e.then((()=>{var e;const n=null===(e=Array.from(t.node.querySelectorAll("p")).find((e=>"Amazon Q"===e.innerText)))||void 0===e?void 0:e.parentElement;n&&(n.replaceChildren(),C.Widget.attach(a,n))}))})),console.log("amazon_sagemaker_jupyter_ai_q_developer:custom-q-header-plugin is activated!")}},j={id:`${c}:custom-footer`,autoStart:!0,provides:n.IJaiMessageFooter,activate:e=>(console.log("JupyterLab extension footer plugin is activated"),{component:w})},L={id:`${c}:unified-studio-concealed-llm-config-plugin`,autoStart:!0,requires:[n.IJaiCore],activate:(e,{chatWidget:t})=>{e.restored.then((async()=>{var e;const a=await v();null===(e=null==t?void 0:t.renderPromise)||void 0===e||e.then((()=>{var e,n;if(!a||![u.MD_IAM,u.MD_IDC,u.MD_SAML].includes(a.env))return;const o=null===(e=t.node.firstChild)||void 0===e?void 0:e.firstChild,i=null===(n=null==o?void 0:o.lastChild)||void 0===n?void 0:n.lastChild;i&&i.remove()}))}))}},O=[A,j,I,L,T]}}]);