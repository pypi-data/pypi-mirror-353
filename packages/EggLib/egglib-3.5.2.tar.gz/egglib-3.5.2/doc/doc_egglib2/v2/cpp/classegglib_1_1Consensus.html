<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>EggLib C++ library reference manual</title><link href="doxygen.css" rel="stylesheet" type="text/css">
<head>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname"><a href="../index.html">Egglib</a>&#160;<span id="projectnumber">2.1.11</span></div>
   <div id="projectbrief">C++&#160;library&#160;reference&#160;manual</div>
  </td>
 </tr>
 </tbody>
</table>
</head>
</html>
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>egglib</b></li><li class="navelem"><a class="el" href="classegglib_1_1Consensus.html">Consensus</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classegglib_1_1Consensus-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Consensus Class Reference<div class="ingroups"><a class="el" href="group__polymorphism.html">polymorphism</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Generates consensus sequences.  
 <a href="classegglib_1_1Consensus.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="Consensus_8hpp_source.html">Consensus.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a671153f7dd5053329d44622e126355dd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classegglib_1_1Consensus.html#a671153f7dd5053329d44622e126355dd">Consensus</a> ()</td></tr>
<tr class="memdesc:a671153f7dd5053329d44622e126355dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a671153f7dd5053329d44622e126355dd">More...</a><br /></td></tr>
<tr class="separator:a671153f7dd5053329d44622e126355dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8157140e8031f642fb78b77c5ce7314"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classegglib_1_1Consensus.html#aa8157140e8031f642fb78b77c5ce7314">~Consensus</a> ()</td></tr>
<tr class="memdesc:aa8157140e8031f642fb78b77c5ce7314"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#aa8157140e8031f642fb78b77c5ce7314">More...</a><br /></td></tr>
<tr class="separator:aa8157140e8031f642fb78b77c5ce7314"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3193bc0370089f5492db68f32ea682c7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3193bc0370089f5492db68f32ea682c7"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classegglib_1_1Consensus.html#a3193bc0370089f5492db68f32ea682c7">setMissing</a> (char)</td></tr>
<tr class="memdesc:a3193bc0370089f5492db68f32ea682c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the character interpreted as missing (default: ?) <br /></td></tr>
<tr class="separator:a3193bc0370089f5492db68f32ea682c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2aeb85ea5c460de152102c74fb24912b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2aeb85ea5c460de152102c74fb24912b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classegglib_1_1Consensus.html#a2aeb85ea5c460de152102c74fb24912b">setDisagreement</a> (char)</td></tr>
<tr class="memdesc:a2aeb85ea5c460de152102c74fb24912b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the character used to point to disagreements (default: Z) <br /></td></tr>
<tr class="separator:a2aeb85ea5c460de152102c74fb24912b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a260d5b6ff0c0e0f15537460db350e16a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a260d5b6ff0c0e0f15537460db350e16a"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classegglib_1_1Consensus.html#a260d5b6ff0c0e0f15537460db350e16a">check_sequences</a> (<a class="el" href="classegglib_1_1Align.html">Align</a> &amp;align)</td></tr>
<tr class="memdesc:a260d5b6ff0c0e0f15537460db350e16a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks all the characters. <br /></td></tr>
<tr class="separator:a260d5b6ff0c0e0f15537460db350e16a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a293df08cdf8e0d9c02ddfacccba09c28"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classegglib_1_1Align.html">Align</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classegglib_1_1Consensus.html#a293df08cdf8e0d9c02ddfacccba09c28">consensus</a> (<a class="el" href="classegglib_1_1Align.html">Align</a> &amp;align, char separator='_', bool rigorous=true)</td></tr>
<tr class="memdesc:a293df08cdf8e0d9c02ddfacccba09c28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reduces the sequence alignment by making consensus sequences.  <a href="#a293df08cdf8e0d9c02ddfacccba09c28">More...</a><br /></td></tr>
<tr class="separator:a293df08cdf8e0d9c02ddfacccba09c28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afec71c91e0b416a601e412a4189c0381"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afec71c91e0b416a601e412a4189c0381"></a>
const std::vector&lt; std::string &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classegglib_1_1Consensus.html#afec71c91e0b416a601e412a4189c0381">firstSequenceNames</a> ()</td></tr>
<tr class="memdesc:afec71c91e0b416a601e412a4189c0381"><td class="mdescLeft">&#160;</td><td class="mdescRight">First name of consensed pairs. <br /></td></tr>
<tr class="separator:afec71c91e0b416a601e412a4189c0381"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a440513c07b7759ae8f81f43fc5e82add"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a440513c07b7759ae8f81f43fc5e82add"></a>
const std::vector&lt; std::string &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classegglib_1_1Consensus.html#a440513c07b7759ae8f81f43fc5e82add">secondSequenceNames</a> ()</td></tr>
<tr class="memdesc:a440513c07b7759ae8f81f43fc5e82add"><td class="mdescLeft">&#160;</td><td class="mdescRight">Second names of consensed pairs. <br /></td></tr>
<tr class="separator:a440513c07b7759ae8f81f43fc5e82add"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3a09abfd46fefffa7d8e3c2a12ab985"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af3a09abfd46fefffa7d8e3c2a12ab985"></a>
const std::vector&lt; std::string &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classegglib_1_1Consensus.html#af3a09abfd46fefffa7d8e3c2a12ab985">roots</a> ()</td></tr>
<tr class="memdesc:af3a09abfd46fefffa7d8e3c2a12ab985"><td class="mdescLeft">&#160;</td><td class="mdescRight">Root names of consensed pairs. <br /></td></tr>
<tr class="separator:af3a09abfd46fefffa7d8e3c2a12ab985"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa59e572e06f484903ba4229f420f6592"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa59e572e06f484903ba4229f420f6592"></a>
const std::vector&lt; int &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classegglib_1_1Consensus.html#aa59e572e06f484903ba4229f420f6592">consistentPositions</a> ()</td></tr>
<tr class="memdesc:aa59e572e06f484903ba4229f420f6592"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of consistent positions for all consensed pairs. <br /></td></tr>
<tr class="separator:aa59e572e06f484903ba4229f420f6592"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a156e3d4334a45c4b25ca3969f377a370"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a156e3d4334a45c4b25ca3969f377a370"></a>
const std::vector&lt; int &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classegglib_1_1Consensus.html#a156e3d4334a45c4b25ca3969f377a370">complementaryPositions</a> ()</td></tr>
<tr class="memdesc:a156e3d4334a45c4b25ca3969f377a370"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of complementary positions for all consensed pairs. <br /></td></tr>
<tr class="separator:a156e3d4334a45c4b25ca3969f377a370"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fd1a6e98a3f3a7ad0a1ce0aef6d471b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9fd1a6e98a3f3a7ad0a1ce0aef6d471b"></a>
const std::vector&lt; int &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classegglib_1_1Consensus.html#a9fd1a6e98a3f3a7ad0a1ce0aef6d471b">uninformativePositions</a> ()</td></tr>
<tr class="memdesc:a9fd1a6e98a3f3a7ad0a1ce0aef6d471b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of uninformative positions for all consensed pairs. <br /></td></tr>
<tr class="separator:a9fd1a6e98a3f3a7ad0a1ce0aef6d471b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea24645164e7d4c29198d6d797801db2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aea24645164e7d4c29198d6d797801db2"></a>
const std::vector&lt; int &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classegglib_1_1Consensus.html#aea24645164e7d4c29198d6d797801db2">ambiguousPositions</a> ()</td></tr>
<tr class="memdesc:aea24645164e7d4c29198d6d797801db2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of ambiguous positions for all consensed pairs. <br /></td></tr>
<tr class="separator:aea24645164e7d4c29198d6d797801db2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d382a0819318c8aaae1e73bded2a0e7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8d382a0819318c8aaae1e73bded2a0e7"></a>
const std::vector&lt; int &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classegglib_1_1Consensus.html#a8d382a0819318c8aaae1e73bded2a0e7">atLeastPartiallyResolvedAmbiguities</a> ()</td></tr>
<tr class="memdesc:a8d382a0819318c8aaae1e73bded2a0e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of at least partially resolved ambiguities for all consensed pairs. <br /></td></tr>
<tr class="separator:a8d382a0819318c8aaae1e73bded2a0e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0aa0a28a37e37ecfa30682780b3ef060"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0aa0a28a37e37ecfa30682780b3ef060"></a>
const std::vector&lt; std::vector&lt; int &gt; &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classegglib_1_1Consensus.html#a0aa0a28a37e37ecfa30682780b3ef060">inconsistentPositions</a> ()</td></tr>
<tr class="memdesc:a0aa0a28a37e37ecfa30682780b3ef060"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector of inconsistent positions ofr all consensed pairs. <br /></td></tr>
<tr class="separator:a0aa0a28a37e37ecfa30682780b3ef060"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Generates consensus sequences. </p>
<p>A consensus is generated when two sequences have the same name, ignoring everything after the first separator character (by default, "_"). Hence, the names "foo", "foo_goo" and "foo_third" will be treated as identical and the root will be "foo". The root will be used to name the resulting sequence. Note that the class works only for DNA sequences.</p>
<p>Symbol convention:</p><ul>
<li>A: adenosine</li>
<li>C: cytosine</li>
<li>G: guanine</li>
<li>T: thymine</li>
<li>M: A or C</li>
<li>R: A or G</li>
<li>W: A or T (weak)</li>
<li>S: C or G (strong)</li>
<li>Y: C or T</li>
<li>K: G or T</li>
<li>B: C or G or T(not A)</li>
<li>D: A or G or T (not C)</li>
<li>H: A or C or T (not G)</li>
<li>V: A or C or G (not T)</li>
<li>N: A or C or G or T</li>
<li>?: nonsequenced position</li>
</ul>
<p>Other symbols will be treated as ? (lowercase are supported).</p>
<p>Rigorous (alias liberal or strong) mode:</p><ul>
<li>If two characters are the same, it is retained whatever it is (A + A = A)</li>
</ul>
<p>Otherwise:</p><ul>
<li>If one is the missing character (?) the other is retained whatever it is (A + ? = A).<ul>
<li>If characters are consistent, that is one contains more information, that one is retained (A + M = A).</li>
<li>If characters are not consistent, the closest generic symbol is retained (A + C = M).</li>
</ul>
</li>
</ul>
<p>Note that the feedback of inconsistent characters in the outcome is not garanteed. In fact, (A + A + G) will result in R (as expected) but (A + G + A) will result in A, masking the problem. However, the position will indeed be counted as inconsistent.</p>
<p>Not rigorous (conservative/weak) mode:</p><ul>
<li>If two characters are the same, it is retained whatever it is (A + A = A).</li>
<li>Otherwise:<ul>
<li>If one is ? the other is retained whatever it is (A + ? = A).</li>
<li>Otherwise an inconsistent character (by default, Z) is retained (A + C = Z).</li>
</ul>
</li>
</ul>
<p>Iterative process of consensus:</p><ul>
<li>Each sequence is taken in turn.</li>
<li>Each pair involving the focus sequence is processed and a consensus is generated.</li>
<li>When all pair have been processsed, the consensus already generated are themselves iteratively processed until only one remains.</li>
<li>Note that at each time the last two are taken first.</li>
</ul>
<p>A transparent interface gives access to the data for all steps of the consensus process, as vectors that covers all pairs (including intermediate steps of the iterative procedure described above) as well as singleton sequences. For the latter, the second name is not filled and all counts are set to 0. Note also that the name of such singleton sequence is shortened to the separator as well. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a671153f7dd5053329d44622e126355dd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classegglib_1_1Consensus.html">Consensus</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>

</div>
</div>
<a class="anchor" id="aa8157140e8031f642fb78b77c5ce7314"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual ~<a class="el" href="classegglib_1_1Consensus.html">Consensus</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a293df08cdf8e0d9c02ddfacccba09c28"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classegglib_1_1Align.html">Align</a> consensus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classegglib_1_1Align.html">Align</a> &amp;&#160;</td>
          <td class="paramname"><em>align</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>separator</em> = <code>'_'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>rigorous</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reduces the sequence alignment by making consensus sequences. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">align</td><td>the original alignment.</td></tr>
    <tr><td class="paramname">separator</td><td>the character used to separated the root name of sequences to the variable part, as in (for the default value: "sequence_read1".</td></tr>
    <tr><td class="paramname">rigorous</td><td>consensus mode.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An <a class="el" href="classegglib_1_1Align.html" title="Handles a sequence alignment. ">Align</a> instance with duplicated sequences consensed. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/stephane/Documents/devel/egglib2/egglib-cpp/<a class="el" href="Consensus_8hpp_source.html">Consensus.hpp</a></li>
<li>/home/stephane/Documents/devel/egglib2/egglib-cpp/Consensus.cpp</li>
</ul>
</div><!-- contents -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head></head><body><hr size="1">
<address style="text-align: right;"><small>Hosted by&nbsp;</address>
<a href="http://sourceforge.net/projects/egglib"><img src="http://sflogo.sourceforge.net/sflogo.php?group_id=232965&amp;type=8" width="80" height="15" alt="Get EggLib at SourceForge.net. Fast, secure and Free Open Source software downloads" / ALIGN=RIGHT BORDER=0></a>
</body></html>
