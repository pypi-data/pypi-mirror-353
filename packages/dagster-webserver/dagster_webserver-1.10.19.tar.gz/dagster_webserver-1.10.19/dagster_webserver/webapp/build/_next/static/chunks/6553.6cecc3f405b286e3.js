"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6553],{63827:function(e,n,t){t.d(n,{EP:function(){return I},NX:function(){return E},VM:function(){return R}});var i=t(52322),s=t(94466),o=t(20940),l=t(56876),r=t(48177),a=t(2784),c=t(15569),u=t(20913),d=t(86224),p=t(41349),h=t(95426),x=t(9979),m=t(9129),g=t(29872),f=t(71498),v=t(2281),j=t(1168),y=t(84991),S=t(26496),k=t(49515),w=t(71271);let b=e=>{let{run:n}=e,{id:t,canTerminate:l}=n,[r,c]=(0,a.useState)(!1),u=(0,a.useCallback)(()=>c(!1),[]),d=(0,a.useCallback)(async e=>{let{errors:n}=e,i=t&&n[t];i&&"message"in i&&await (0,g.B)({message:i.message,icon:"error",intent:"danger"})},[t]);return t?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.zx,{icon:(0,i.jsx)(o.JO,{name:"cancel"}),intent:"danger",disabled:r,onClick:()=>c(!0),children:"Terminate"}),(0,i.jsx)(h.A,{isOpen:r,onClose:u,onComplete:d,selectedRuns:{[t]:l}})]}):null};function C(e,n){let t=e.keys.map(e=>{var t;return e&&(null===(t=n.steps[e])||void 0===t?void 0:t.state)||c.TN.PREPARING});return{...e,present:e.keys.length>0,failed:e.keys.length&&t.includes(c.TN.FAILED),finished:t.every(e=>[c.TN.FAILED,c.TN.SUCCEEDED].includes(e))}}let I=e=>u.cv.has(e.status),R=e=>e.executionPlan&&u.hd.has(e.status),E=e=>{var n,t,s;let{metadata:o,graph:a,run:c}=e,h=(0,w.n)(c),g=(0,x.J)(c),{flagAssetRetries:E}=(0,f.gV)(),N=null==c?void 0:null===(n=c.executionPlan)||void 0===n?void 0:n.artifactsPersisted,T=C(e.selection,o),_=function(e,n,t){let i=e.tags.find(e=>e.key===d.H.StepSelection);return i?C({keys:(0,v.V)(n,i.value).all.map(e=>e.name),query:i.value},t):null}(c,a,o),P=null===(t=c.tags)||void 0===t?void 0:t.some(e=>e.key===d.H.IsResumeRetry&&"true"===e.value),L=(0,m.D)(),D=async e=>{if(!c||!h||!c.pipelineSnapshotId)return;let n=(0,p.DP)({run:c,selection:e,repositoryLocationName:h.match.repositoryLocation.name,repositoryName:h.match.repository.name});await L.onClick(c,n,!1)},F={icon:"cached",scope:"*",title:"All steps in root run",tooltip:"Re-execute the pipeline run from scratch. Shift-click to adjust tags.",disabled:!I(c),onClick:e=>L.onClick(c,y.hmq.ALL_STEPS,e.shiftKey)},A={icon:"linear_scale",scope:(null==_?void 0:_.query)||"*",title:"Same steps",disabled:!_||!(_.finished||_.failed),tooltip:(0,i.jsxs)("div",{children:[_&&_.present?_.finished?"Re-execute the same step subset used for this run:":"Wait for all of the steps to finish to re-execute the same subset.":"Re-executes the same step subset used for this run if one was present.",(0,i.jsx)(O,{selection:_})]}),onClick:()=>D(_)},V={icon:"op",scope:T.query,title:T.keys.length>1?"Selected steps":"Selected step",disabled:!T.present||!(T.finished||T.failed),tooltip:(0,i.jsxs)("div",{children:[T.present?T.finished?"Re-execute the selected steps with existing configuration:":"Wait for the steps to finish to re-execute them.":"Select a step or type a step subset to re-execute.",(0,i.jsx)(O,{selection:T})]}),onClick:()=>D(T)},U={icon:"arrow_forward",title:"From selected",disabled:!I(c)||1!==T.keys.length,tooltip:"Re-execute the pipeline downstream from the selected steps.",onClick:async()=>{if(!c.executionPlan)return console.warn("Run execution plan must be present to launch from-selected execution"),Promise.resolve();let e=T.keys.map(e=>"".concat(e,"*")).join(","),n=T.keys.map(e=>'name:"'.concat(e,'"+')).join(" or "),t=(0,k.Z)(a,n).all.map(e=>e.name);await D({keys:t,query:e})}},q=R(c),K={icon:"arrow_forward",title:"From failure",disabled:!q,tooltip:q?"Retry the pipeline run, skipping steps that completed successfully. Shift-click to adjust tags.":"Retry is only enabled when the pipeline has failed.",onClick:e=>L.onClick(c,y.hmq.FROM_FAILURE,e.shiftKey)};N||[V,A,K,U].forEach(e=>{e.disabled=!0,e.title="Retry and re-execute are only enabled on persistent storage. Try rerunning with a different storage configuration."});let z=[F,A,V,U,K,E&&(null===(s=c.executionPlan)||void 0===s?void 0:s.assetSelection.length)?{icon:"arrow_forward",title:"From asset failure",disabled:!q,tooltip:q?"Retry the pipeline run, selecting only assets that did not complete successfully. Shift-click to adjust tags.":"Retry is only enabled when the pipeline has failed.",onClick:e=>L.onClick(c,y.hmq.FROM_ASSET_FAILURE,e.shiftKey)}:null].filter(Boolean),J=T.present?V:q&&P?K:(null==_?void 0:_.present)?A:null,M=N&&J?J:F;return(0,i.jsxs)(l.Z,{direction:"row",spacing:8,children:[(0,i.jsx)(r.x,{flex:{direction:"row"},children:(0,i.jsx)(S.D,{runCount:1,primary:M,options:z,title:"*"===M.scope?"Re-execute all (*)":M.scope?"Re-execute (".concat(M.scope,")"):"Re-execute ".concat(M.title),tooltip:(null==g?void 0:g.tooltip)?null==g?void 0:g.tooltip:c.hasReExecutePermission?void 0:j.Qr,icon:null==g?void 0:g.icon,disabled:(null==g?void 0:g.disabled)||!c.hasReExecutePermission})}),u.cv.has(c.status)?null:(0,i.jsx)(b,{run:c}),L.launchpadElement]})},O=e=>{let{selection:n}=e;return(0,i.jsx)("div",{style:{paddingLeft:"10px"},children:((null==n?void 0:n.keys)||[]).map(e=>(0,i.jsx)("span",{style:{display:"block"},children:"* ".concat(e)},e))})}},16553:function(e,n,t){t.r(n),t.d(n,{RunRoot:function(){return eZ},default:function(){return eB}});var i=t(73235),s=t(52322),o=t(48177),l=t(71018),r=t(54854),a=t(15997),c=t(20940),u=t(18984),d=t(3217),p=t(56328),h=t(2784),x=t(7267),m=t(47933),g=t(8941),f=t(26834),v=t(94466),j=t(44067),y=t(35505),S=t(89628),k=t(54786),w=t(13070),b=t(4226),C=t(63827),I=t(38995),R=t(15569),E=t(21876),O=t(13547),N=t(34515),T=t(9628),_=t(46473),P=t(40552),L=t(84991),D=t(93781);let F=e=>{(0,h.useEffect)(()=>{let n=document.querySelector('link[rel="icon"][type="image/svg+xml"]');if(!n)return;let t=n.getAttribute("href");return n.setAttribute("href",e),()=>{t&&n.setAttribute("href",t)}},[e])};var A=t(22710),V=t(56806),U=t(49515),q=t(4993),K=t(75665);let z=e=>{switch(e){case L.VOA.FAILURE:return"/favicon-run-failed.svg";case L.VOA.SUCCESS:return"/favicon-run-success.svg";case L.VOA.STARTING:case L.VOA.STARTED:case L.VOA.CANCELING:return"/favicon-run-pending.svg";default:return"/favicon.svg"}},J=(0,h.memo)(e=>{let{run:n,runId:t}=e,[i,o]=(0,K.Bz)(),[l,r]=(0,A.q)({queryKey:"selection",defaults:{selection:""}});F(n?z(n.status):"/favicon.svg"),(0,D.j)(n?"".concat((0,T.pv)(n.pipelineName)?"":n.pipelineName," ").concat(t.slice(0,8)," [").concat(n.status,"]"):"Run: ".concat(t));let a=(e,n)=>{let t=n.find(n=>"ExecutionStepFailureEvent"===n.__typename&&n.stepKey===e);t&&(0,O._K)({body:(0,s.jsx)(N.T9,{error:t})})},c=e=>{r(e),o({...i,logQuery:"*"!==e?[{token:"query",value:e}]:[]})},u=(0,V.FE)("RunLogs");return(0,s.jsx)(I.A.Provider,{value:n,children:(0,s.jsx)(k.C,{runId:t,children:e=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(M,{dependency:u,logs:e}),(0,s.jsx)(R.jp,{logs:e,children:r=>(0,s.jsx)(H,{run:n,runId:t,logs:e,logsFilter:i,metadata:r,selectionQuery:l,onSetLogsFilter:o,onSetSelectionQuery:c,onShowStateDetails:a})})]})},t)})}),M=e=>{let{dependency:n,logs:t}=e;return(0,h.useLayoutEffect)(()=>{t.loading||n.completeDependency(V.Os.SUCCESS)},[n,t]),null},Q=e=>{switch(e){case"stdout":return b.hi.stdout;case"stderr":return b.hi.stderr;default:return b.hi.structured}},H=e=>{let{run:n,runId:t,logs:i,logsFilter:l,metadata:r,selectionQuery:u,onSetLogsFilter:d,onSetSelectionQuery:p}=e,[x,y]=(0,A.q)({queryKey:"logType",defaults:{logType:b.hi.structured}}),k=Q(x),[I,R]=(0,h.useState)(null),O=JSON.stringify(Object.keys(r.steps).sort()),N=(0,h.useMemo)(()=>JSON.parse(O),[O]),T=(null==n?void 0:n.executionPlan)&&(0,P.J)(null==n?void 0:n.executionPlan,r.steps),L=(0,h.useMemo)(()=>T&&u&&"*"!==u?(0,U.Z)(T,u).all.map(e=>e.name):[],[T,u]),D=(0,h.useMemo)(()=>({query:u,keys:L}),[L,u]),{logCaptureInfo:F,computeLogFileKey:V,setComputeLogFileKey:K}=(0,q.r)({stepKeys:N,selectionStepKeys:L,metadata:r,defaultToFirstStep:!1}),z=(0,h.useMemo)(()=>T?l.logQuery.filter(e=>e.token&&"query"===e.token).reduce((e,n)=>(e.push(...(0,U.Z)(T,n.value).all.map(e=>e.name)),e),[]):[],[l.logQuery,T]),[J,M]=(0,h.useState)(null),H=(0,h.useRef)(null);(0,h.useLayoutEffect)(()=>{if(H.current){let e=H.current.getSize();100===e?M("top"):0===e&&M("bottom")}},[]);let B="top"===J,W="bottom"===J,G=()=>{var e;null===(e=H.current)||void 0===e||e.changeSize(50),M(null)};return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(j.O,{ref:H,axis:"vertical",identifier:"run-gantt",firstInitialPercent:35,firstMinSize:56,first:n?n.executionPlan&&T?(0,s.jsx)(g.S,{region:"gantt chart",children:(0,s.jsx)(_.hj,{options:{mode:_.hS.WATERFALL_TIMED},toolbarActions:(0,s.jsxs)(o.x,{flex:{direction:"row",alignItems:"center",gap:12},children:[(0,s.jsx)(f.u,{content:B?"Collapse":"Expand",children:(0,s.jsx)(v.zx,{icon:(0,s.jsx)(c.JO,{name:B?"collapse_arrows":"expand_arrows"}),onClick:B?G:()=>{var e;null===(e=H.current)||void 0===e||e.changeSize(100),M("top")}})}),(0,s.jsx)(C.NX,{run:n,graph:T,metadata:r,selection:D})]}),runId:t,graph:T,metadata:r,selection:D,onClickStep:(e,n)=>{let t=L.indexOf(e),i=u;if(n.shiftKey){var s,o;i=-1!==t?(s=i,"(".concat(s,') and not name:"').concat(e,'"')):(o=i,"(".concat(o,') or name:"').concat(e,'"'))}else if(1===L.length&&-1!==t)i="";else{i='name:"'.concat(e,'"');let n=(0,q.c)(r.logCaptureSteps,e);n&&K(n)}p(i)},onSetSelection:p,focusedTime:l.focusedTime})}):(0,s.jsx)(a.t,{icon:"error",title:"Unable to build execution plan"}):(0,s.jsx)(_.ZW,{runId:t}),secondMinSize:56,second:(0,s.jsx)(g.S,{region:"logs",children:(0,s.jsxs)($,{children:[(0,s.jsx)(b.KZ,{logType:k,onSetLogType:e=>y(b.hi[e]),filter:l,onSetFilter:d,steps:N,metadata:r,computeLogFileKey:V,onSetComputeLogKey:K,computeLogUrl:I,counts:i.counts,isSectionExpanded:W,toggleExpanded:W?G:()=>{var e;null===(e=H.current)||void 0===e||e.changeSize(0),M("bottom")}}),(null==n?void 0:n.status)==="QUEUED"?(0,s.jsx)(a.t,{icon:"arrow_forward",title:"Run queued",description:"This run is queued for execution and will start soon.",action:(0,s.jsx)(m.rU,{to:(0,E.it)([{token:"status",value:"QUEUED"}]),children:"View queued runs"})}):k===b.hi.structured?(0,s.jsx)(w.S,{logs:i,filter:l,filterStepKeys:z,filterKey:"".concat(JSON.stringify(l)),metadata:r}):V?(0,s.jsx)(S.h,{logKey:V?[t,"compute_logs",V]:[],logCaptureInfo:F,visibleIOType:b.hi[k],onSetDownloadUrl:R}):(0,s.jsx)(Z,{type:k})]})})})})},$=y.ZP.div.withConfig({componentId:"sc-bb581f4d-0"})(["display:flex;flex-direction:column;height:100%;"]),Z=e=>{let{type:n}=e;return(0,s.jsx)(o.x,{flex:{direction:"row",grow:1,alignItems:"center",justifyContent:"center"},style:{background:d.v8()},children:(0,s.jsx)(a.t,{title:"Select a step to view ".concat(n),icon:"warning",description:"Select a step on the Gantt chart or from the dropdown above to view logs."})})};var B=t(79066),W=t(4760);function G(){let e=(0,i._)(["\n  query RunAssetChecksQuery($runId: ID!) {\n    pipelineRunOrError(runId: $runId) {\n      ... on Run {\n        id\n        assetChecks {\n          name\n          assetKey {\n            path\n          }\n        }\n      }\n    }\n  }\n"]);return G=function(){return e},e}let X=e=>{let{run:n}=e,t=(0,T.pv)(n.pipelineName),{data:i,loading:o}=(0,W.aM)(Y,{variables:{runId:n.id},skip:t});if(o||!i||"Run"!==i.pipelineRunOrError.__typename)return null;let l=t?n.assetCheckSelection:i.pipelineRunOrError.assetChecks;return(0,s.jsx)(B.ms,{assetChecks:l})},Y=(0,W.Ps)(G());var ee=t(41349);function en(){let e=(0,i._)(["\n  query RunAssetsQuery($runId: ID!) {\n    pipelineRunOrError(runId: $runId) {\n      ... on Run {\n        id\n        assets {\n          id\n          key {\n            path\n          }\n        }\n      }\n    }\n  }\n"]);return en=function(){return e},e}let et=e=>{let{run:n}=e,t=(0,T.pv)(n.pipelineName),i=(0,W.aM)(ei,{variables:{runId:n.id},skip:t,fetchPolicy:"no-cache"}),o=(0,h.useMemo)(()=>{let{data:e}=i,s=null;return(null==e?void 0:e.pipelineRunOrError.__typename)==="Run"&&(s=e.pipelineRunOrError.assets.map(e=>e.key)),t?(0,ee.Bo)(n):s},[i,n,t]);return(0,s.jsx)(B.mP,{useTags:!0,assetKeys:o})},ei=(0,W.Ps)(en());var es=t(42266),eo=t(56876),el=t(76154),er=t(60206);let ea=e=>null;var ec=t(76760),eu=t(59596),ed=t(62458),ep=t(26855),eh=t(39361),ex=t(5024);let em=e=>{let{isOpen:n,onClose:t,pools:i}=e;return(0,s.jsxs)(eh.Vq,{isOpen:n,onClose:t,canOutsideClickClose:!0,canEscapeKeyClose:!0,title:"Pools",children:[(0,s.jsx)(o.x,{margin:{horizontal:24,vertical:12},flex:{gap:12},children:i.map(e=>(0,s.jsx)(ex.F,{pool:e},e))}),(0,s.jsx)(eh.cN,{topBorder:!0,children:(0,s.jsx)(v.zx,{onClick:t,intent:"primary",children:"Close"})})]})};var eg=t(20913),ef=t(95426),ev=t(21210),ej=t(12546),ey=t(29872),eS=t(17046),ek=t(6023),ew=t(18328);let eb=e=>{var n,t;let{run:i,isJob:o}=e,l=i.hasRunMetricsEnabled,[r,a]=(0,h.useState)(null),{rootServerURI:u}=(0,h.useContext)(ej.I),{refetch:d}=(0,h.useContext)(ee.Lw),p=(0,x.k6)(),[m]=(0,W.Db)(eS.dP),g=async()=>{var e;(null===(e=(await m({variables:{runId:i.id}})).data)||void 0===e?void 0:e.freeConcurrencySlots)&&await (0,ey.B)({intent:"success",icon:"check_circle",message:"Freed concurrency slots"})},j=(0,ew.$y)({repositoryName:null===(n=i.repositoryOrigin)||void 0===n?void 0:n.repositoryName,repositoryLocationName:null===(t=i.repositoryOrigin)||void 0===t?void 0:t.repositoryLocationName,run:i,isJob:o});return(0,s.jsxs)("div",{children:[(0,s.jsxs)(eo.Z,{direction:"row",spacing:8,children:[(0,s.jsx)(ea,{runId:i.id}),j.disabledReason?(0,s.jsx)(f.u,{content:j.disabledReason,useDisabledButtonTooltipFix:!0,children:(0,s.jsx)(v.zx,{icon:(0,s.jsx)(c.JO,{name:j.icon}),disabled:!0,children:j.label})}):(0,s.jsx)(ek.A,{icon:(0,s.jsx)(c.JO,{name:j.icon}),to:j.to,children:j.label}),(0,s.jsx)(v.zx,{icon:(0,s.jsx)(c.JO,{name:"tag"}),onClick:()=>a("config"),children:"View tags and config"}),i.allPools&&i.allPools.length?(0,s.jsx)(f.u,{content:"View pools",position:"top",targetTagName:"div",children:(0,s.jsx)(v.zx,{icon:(0,s.jsx)(c.JO,{name:"concurrency"}),onClick:()=>a("pools")})}):null,!(0,ev.j)(i)||i.hasDeletePermission?(0,s.jsx)(el.J2,{position:"bottom-right",content:(0,s.jsxs)(er.v2,{children:[(0,ev.j)(i)?null:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.u,{content:"Loadable in dagster-webserver-debug",position:"left",targetTagName:"div",children:(0,s.jsx)(er.sN,{text:"Download debug file",icon:"download_for_offline",onClick:()=>window.open("".concat(u,"/download_debug/").concat(i.id))})}),i.status===L.VOA.QUEUED?(0,s.jsx)(er.sN,{tagName:"button",icon:"history_toggle_off",text:"View queue criteria",intent:"none",onClick:()=>a("queue-criteria")}):null,l&&ec.G?(0,s.jsx)(er.sN,{tagName:"button",icon:"asset_plot",text:"View container metrics",intent:"none",onClick:()=>a("metrics")}):null,i.hasConcurrencyKeySlots&&eg.cv.has(i.status)?(0,s.jsx)(er.sN,{text:"Free concurrency slots",icon:"lock",onClick:g}):null]}),i.hasDeletePermission?(0,s.jsx)(er.sN,{icon:"delete",text:"Delete",intent:"danger",onClick:()=>a("delete")}):null]}),children:(0,s.jsx)(v.zx,{icon:(0,s.jsx)(c.JO,{name:"expand_more"})})}):null]}),(0,s.jsx)(ep.U,{isOpen:"config"===r,onClose:()=>a(null),mode:i.mode,runConfigYaml:i.runConfigYaml,tags:i.tags,isJob:o}),i.status===L.VOA.QUEUED?(0,s.jsx)(ed.f,{run:i,isOpen:"queue-criteria"===r,onClose:()=>a(null)}):null,l&&ec.G?(0,s.jsx)(ec.G,{runId:i.id,isOpen:"metrics"===r,onClose:()=>a(null)}):null,i.hasDeletePermission?(0,s.jsx)(eu.N,{isOpen:"delete"===r,onClose:()=>a(null),onComplete:()=>{i.repositoryOrigin?p.push((0,ew.jT)({repoName:i.repositoryOrigin.repositoryName,repoLocation:i.repositoryOrigin.repositoryLocationName,pipelineName:i.pipelineName,isJob:o,path:"/runs"})):a(null)},onTerminateInstead:()=>a("terminate"),selectedRuns:{[i.id]:i.canTerminate}}):null,i.hasTerminatePermission?(0,s.jsx)(ef.A,{isOpen:"terminate"===r,onClose:()=>a(null),onComplete:()=>{d()},selectedRuns:{[i.id]:i.canTerminate}}):null,i.allPools&&i.allPools.length?(0,s.jsx)(em,{isOpen:"pools"===r,pools:i.allPools,onClose:()=>a(null)}):null]})};var eC=t(4498),eI=t(86224),eR=t(71813),eE=t(6317),eO=t(26893);let eN=e=>{let{loading:n,run:t}=e;return(0,s.jsxs)(s.Fragment,{children:[(null==t?void 0:t.startTime)?(0,s.jsx)(el.J2,{interactionKind:"hover",placement:"bottom",content:(0,s.jsx)(o.x,{padding:16,children:(0,s.jsx)(eR.s9,{run:t,loading:n})}),children:(0,s.jsx)(r.V,{icon:"schedule",children:(0,s.jsx)(eO.v,{timestamp:t.startTime,timeFormat:{showSeconds:!0,showTimezone:!1}})})}):t.updateTime?(0,s.jsx)(r.V,{icon:"schedule",children:(0,s.jsx)(eO.v,{timestamp:t.updateTime,timeFormat:{showSeconds:!0,showTimezone:!1}})}):void 0,(null==t?void 0:t.startTime)&&(null==t?void 0:t.endTime)?(0,s.jsx)(el.J2,{interactionKind:"hover",placement:"bottom",content:(0,s.jsx)(o.x,{padding:16,children:(0,s.jsx)(eR.s9,{run:t,loading:n})}),children:(0,s.jsx)(r.V,{icon:"timer",children:(0,s.jsx)("span",{style:{fontVariantNumeric:"tabular-nums"},children:(null==t?void 0:t.startTime)?(0,eE.R4)(((null==t?void 0:t.endTime)*1e3||Date.now())-(null==t?void 0:t.startTime)*1e3):"–"})})}):null]})};var eT=t(7055),e_=t(2636),eP=t(45511),eL=t(47333),eD=t(66974),eF=t(91987);let eA=e=>{let{instigationSelector:n,instigationType:t,tickId:i}=e,[l,a]=(0,h.useState)(!1),[c,u]=(0,h.useState)(!1),d=t===eI.H.ScheduleName?"schedule":"sensors",{name:p,repositoryName:x,repositoryLocationName:m}=n,g=(0,eF.kQ)(x,m),f=[{label:"View ".concat(t===eI.H.ScheduleName?"schedule":"sensor"),to:(0,ew.$U)(g,"".concat(t===eI.H.ScheduleName?"/schedules":"/sensors","/").concat(p))},{label:"View tick details",onClick:()=>a(!0)},{label:"View tick logs",onClick:()=>u(!0)}];return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eD.c,{actions:f,data:{key:"Launched by",value:p},children:(0,s.jsx)(r.V,{icon:d,children:(0,s.jsxs)(o.x,{flex:{direction:"row"},children:[(0,s.jsx)("span",{children:"Launched by\xa0"}),(0,s.jsx)("div",{style:{maxWidth:"140px"},children:(0,s.jsx)(e_.g,{text:p})})]})})}),(0,s.jsx)(eP.X,{isOpen:l,tickResultType:"runs",onClose:()=>a(!1),instigationSelector:n,tickId:i}),(0,s.jsx)(eL.l,{isOpen:c,onClose:()=>u(!1),instigationSelector:n,tickId:i})]})};var eV=t(96798),eU=t(54123),eq=t(20635),eK=t(55638);let ez=new Intl.Collator(navigator.language,{sensitivity:"base"}),eJ=e=>{var n,t;let{assetKeys:i,evaluationId:l}=e,[a,u]=(0,h.useState)(null),d=(0,h.useMemo)(()=>[...i].sort((e,n)=>ez.compare(e.path.join("/"),n.path.join("/"))),[i]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(el.J2,{placement:"bottom",content:(0,s.jsxs)("div",{style:{width:"400px"},children:[(0,s.jsx)(o.x,{padding:{vertical:8,horizontal:12},border:"bottom",style:{fontWeight:600},children:"Automation condition"}),(0,s.jsx)(o.x,{flex:{direction:"column",gap:16},padding:{vertical:12},style:{maxHeight:"220px",overflowY:"auto"},children:d.map(e=>{let n=(0,eK.p)(e,{view:"automation",evaluation:l});return(0,s.jsxs)(o.x,{padding:{vertical:8,left:12,right:16},flex:{direction:"row",justifyContent:"space-between",alignItems:"center",gap:16},style:{overflow:"hidden"},children:[(0,s.jsxs)(o.x,{flex:{direction:"row",alignItems:"center",gap:8},style:{overflow:"hidden"},children:[(0,s.jsx)(c.JO,{name:"asset"}),(0,s.jsx)(e_.g,{text:e.path.join("/")})]}),(0,s.jsx)(eU.Z,{onClick:()=>u({assetKeyPath:e.path,evaluationId:l}),style:{whiteSpace:"nowrap"},children:"View evaluation"})]},n)})})]}),interactionKind:"hover",children:(0,s.jsx)(r.V,{icon:"automation_condition",children:"Automation condition"})}),(0,s.jsx)(eq.s,{assetKeyPath:null!==(n=null==a?void 0:a.assetKeyPath)&&void 0!==n?n:[],isOpen:!!a,onClose:()=>u(null),evaluationID:null!==(t=null==a?void 0:a.evaluationId)&&void 0!==t?t:""})]})};var eM=t(89164),eQ=t(32549),eH=t(71271);function e$(){let e=(0,i._)(["\n  query RunRootQuery($runId: ID!) {\n    pipelineRunOrError(runId: $runId) {\n      ... on Run {\n        id\n        ...RunPageFragment\n      }\n    }\n  }\n\n  ","\n"]);return e$=function(){return e},e}let eZ=()=>{var e;(0,eV.Px)();let{runId:n}=(0,x.UO)();(0,D.j)(n?"Run ".concat(n.slice(0,8)):"Run");let{data:t,loading:i}=(0,W.aM)(eG,{variables:{runId:n}}),a=(null==t?void 0:t.pipelineRunOrError.__typename)==="Run"?t.pipelineRunOrError:null,c=null==a?void 0:a.pipelineSnapshotId,u=(0,eH.n)(a),d=(null==u?void 0:u.match)?(0,eF.kQ)(u.match.repository.name,u.match.repositoryLocation.name):null,p=(0,h.useMemo)(()=>!!(a&&u&&(0,eQ.E8)(u.match,a.pipelineName)),[a,u]),m=(0,h.useMemo)(()=>(null==a?void 0:a.tags.find(e=>e.key===eI.H.AssetEvaluationID))||null,[a]),g=(0,h.useMemo)(()=>{if(d){let e=(null==a?void 0:a.tags)||[],n=e.find(e=>e.key===eI.H.TickId);if(n){let t=e.find(e=>e.key===eI.H.ScheduleName||e.key===eI.H.SensorName);if(t){let e={name:t.value,repositoryName:d.name,repositoryLocationName:d.location};return{tickId:n.value,instigationType:t.key,instigationSelector:e}}}}return null},[a,d]),f=null==a?void 0:a.tags.find(e=>e.key===eI.H.Partition);return(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",minWidth:0,width:"100%",height:"100%",overflow:"hidden"},children:[(0,s.jsx)(o.x,{flex:{direction:"row",alignItems:"flex-start"},style:{position:"relative",zIndex:1},children:(0,s.jsx)(l.m,{title:(0,s.jsx)(eX,{run:a,runId:n}),tags:a?(0,s.jsxs)(o.x,{flex:{direction:"row",alignItems:"flex-start",gap:12,wrap:"wrap"},children:[(0,s.jsx)(eC.KG,{status:a.status}),(0,T.pv)(a.pipelineName)?null:(0,s.jsxs)(r.V,{icon:"run",children:["Run of"," ",(0,s.jsx)(eM.h,{pipelineName:null==a?void 0:a.pipelineName,pipelineHrefContext:d||"repo-unknown",snapshotId:c,size:"small",isJob:p})]}),g?(0,s.jsx)(eA,{instigationSelector:g.instigationSelector,instigationType:g.instigationType,tickId:g.tickId}):null,f&&(0,s.jsx)(eI.i,{tag:f}),(0,s.jsx)(et,{run:a}),(0,s.jsx)(X,{run:a}),(0,s.jsx)(eN,{run:a,loading:i}),m&&(null===(e=a.assetSelection)||void 0===e?void 0:e.length)?(0,s.jsx)(eJ,{assetKeys:a.assetSelection,evaluationId:m.value}):null]}):null,right:a?(0,s.jsx)(eb,{run:a,isJob:p}):null})}),(0,s.jsx)(eW,{data:t,runId:n})]})};var eB=eZ;let eW=e=>{let{data:n,runId:t}=e;if(!n||!n.pipelineRunOrError)return null;if("Run"!==n.pipelineRunOrError.__typename)return(0,s.jsx)(o.x,{padding:{vertical:64},children:(0,s.jsx)(a.t,{icon:"error",title:"No run found",description:"The run with this ID does not exist or has been cleaned up."})});if((0,ev.j)(n.pipelineRunOrError)){let e=(0,ev.Z)(n.pipelineRunOrError);return e?(0,s.jsx)(o.x,{padding:{vertical:64},children:(0,s.jsx)(a.t,{icon:"job",title:"This run was remotely executed",description:(0,s.jsxs)(o.x,{flex:{direction:"row",alignItems:"center"},children:[(0,s.jsx)("a",{href:e,target:"_blank",rel:"noreferrer",children:"View the execution logs"}),(0,s.jsx)(c.JO,{name:"open_in_new",size:16,style:{marginLeft:8}})]})})}):(0,s.jsx)(o.x,{padding:{vertical:64},children:(0,s.jsx)(a.t,{icon:"job",title:"No external URL found",description:"This run was executed externally, but does not have an external URL."})})}return(0,s.jsx)(J,{run:n.pipelineRunOrError,runId:t})},eG=(0,W.Ps)(e$(),es.tQ),eX=e=>{let{run:n,runId:t}=e,i=(0,h.useMemo)(()=>null==n?void 0:n.tags.find(e=>e.key===eI.H.Backfill),[n]);if(i){var o;return(0,s.jsxs)(u.X6,{children:[(0,s.jsx)(m.rU,{to:"/runs",style:{color:d.$()},children:"Runs"})," / ",(0,s.jsx)(m.rU,{to:(0,eT.M)(i.value,!!(null==n?void 0:null===(o=n.assetSelection)||void 0===o?void 0:o.length)),style:{color:d.$()},children:i.value})," / ",t.slice(0,8)]})}return(0,s.jsxs)(u.X6,{style:{display:"flex",flexDirection:"row",gap:6},children:[(0,s.jsx)(m.rU,{to:"/runs",children:"Runs"}),(0,s.jsx)("span",{children:"/"}),(0,s.jsx)("span",{style:{fontFamily:p.b.monospace},children:t.slice(0,8)})]})}},47333:function(e,n,t){t.d(n,{l:function(){return g}});var i=t(73235),s=t(52322),o=t(39361),l=t(48177),r=t(3217),a=t(94466),c=t(99564),u=t(15997),d=t(20940),p=t(14553),h=t(4760),x=t(26893);function m(){let e=(0,i._)(["\n  query TickLogEventsQuery($instigationSelector: InstigationSelector!, $tickId: ID!) {\n    instigationStateOrError(instigationSelector: $instigationSelector) {\n      ... on InstigationState {\n        id\n        instigationType\n        tick(tickId: $tickId) {\n          id\n          status\n          timestamp\n          logEvents {\n            events {\n              ...InstigationEventLog\n            }\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return m=function(){return e},e}let g=e=>{let{tickId:n,timestamp:t,instigationSelector:i,isOpen:c,onClose:u}=e;return(0,s.jsxs)(o.Vq,{isOpen:c,onClose:u,style:{width:"70vw",maxWidth:"1200px",minWidth:"800px"},title:(0,s.jsx)("span",{children:t?(0,s.jsxs)("span",{children:[(0,s.jsxs)("span",{children:["Logs for ",i.name,": "]}),(0,s.jsx)(x.v,{timestamp:t,timeFormat:{showSeconds:!0}})]}):(0,s.jsxs)("span",{children:["Logs for ",i.name]})}),children:[n?(0,s.jsx)(f,{instigationSelector:i,tickId:n}):null,(0,s.jsx)(l.x,{background:r.v8(),style:{zIndex:3,position:"relative"},children:(0,s.jsx)(o.cN,{topBorder:!0,children:(0,s.jsx)(a.zx,{onClick:u,children:"Done"})})})]})},f=e=>{let{instigationSelector:n,tickId:t}=e,{data:i,loading:o}=(0,h.aM)(v,{variables:{instigationSelector:n,tickId:t},notifyOnNetworkStatusChange:!0}),r=(null==i?void 0:i.instigationStateOrError.__typename)==="InstigationState"&&(null==i?void 0:i.instigationStateOrError.tick)?null==i?void 0:i.instigationStateOrError.tick.logEvents.events:void 0;if(o)return(0,s.jsx)(l.x,{style:{height:500},flex:{justifyContent:"center",alignItems:"center"},children:(0,s.jsx)(c.f,{label:"Loading logs…"})});if(r&&r.length)return(0,s.jsx)(l.x,{style:{height:500},flex:{direction:"column"},children:(0,s.jsx)(p.g,{events:r})});let x=(null==i?void 0:i.instigationStateOrError.__typename)==="InstigationState"?null==i?void 0:i.instigationStateOrError.tick.status:void 0,m=(null==i?void 0:i.instigationStateOrError.__typename)==="InstigationState"?null==i?void 0:i.instigationStateOrError.instigationType:void 0,g="SENSOR"===m?"https://docs.dagster.io/concepts/partitions-schedules-sensors/sensors#logging-in-sensors":"SCHEDULE"===m?"https://docs.dagster.io/concepts/partitions-schedules-sensors/schedules#logging-in-schedules":void 0;return(0,s.jsx)(l.x,{style:{height:500},flex:{justifyContent:"center",alignItems:"center"},padding:{vertical:48},children:(0,s.jsx)(u.t,{icon:"no-results",title:"No logs to display",description:(0,s.jsxs)(l.x,{flex:{direction:"column",gap:12},children:[(0,s.jsx)("div",{children:"Your evaluation did not emit any logs. To learn how to emit logs in your evaluation, visit the documentation for more information."}),"FAILURE"===x&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{children:"For failed evaluations, logs will only be displayed if your Dagster and Dagster Cloud agent versions 1.5.14 or higher."}),(0,s.jsx)("div",{children:"Upgrade your Dagster versions to view logs for failed evaluations."})]})]}),action:g&&(0,s.jsx)(a.fr,{href:g,rightIcon:(0,s.jsx)(d.JO,{name:"open_in_new"}),children:"View documentation"})})})},v=(0,h.Ps)(m(),p.n)}}]);
//# sourceMappingURL=6553.6cecc3f405b286e3.js.map