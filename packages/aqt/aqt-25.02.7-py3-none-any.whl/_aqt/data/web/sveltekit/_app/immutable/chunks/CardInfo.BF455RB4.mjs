import{a as $,b as C,c as Le,n as Me}from"./disclose-version.CZXCSga2.mjs";import{i as ne}from"./legacy.Cvgq_wkp.mjs";import{p as oe,c as u,t as x,r as o,b as ve,l as H,a as pe,N as p,g as v,m as V,s as U,M as ae,f as me}from"./runtime.NF8NW0fQ.mjs";import{p as ee,i as J}from"./props.C4_rjmFK.mjs";import{c as Ie,C as Ke}from"./Container.C0RC8RQ7.mjs";import{R as he}from"./Row.BoykZ5Sj.mjs";import{a as R,s as Ye,p as le,b as Pe}from"./store.CrzbHEEA.mjs";import{U as We,V as Be,W as Ge,X as Oe,Y as Ue,Z as ze,_ as $e,$ as Fe,a0 as je,a1 as ke,a2 as Te,a3 as He,a4 as Ve,a5 as Je,a6 as Xe,a7 as Ze,a8 as Qe,a9 as et,aa as tt,ab as at,ac as rt,ad as it,ae as st,af as lt,ag as nt,ah as ot,q as xe,ai as De,aj as vt,ak as ct,al as dt,am as ut,an as ft,ao as mt,ap as pt,aq as gt,ar as bt,u as ht,as as de,at as yt,au as _t,av as St,aw as wt}from"./runtime-require.ClQzQQRm.mjs";import{e as Z,i as Q}from"./theme.DvYw8rH4.mjs";import{t as G,D as xt,T as Ce}from"./time.CAj5JaQP.mjs";import{R as Y}from"./backend.CuvxjHSt.mjs";import{y as Dt,z as ye,A as Rt,B as Lt,C as $t,D as Ft,E as kt,F as Re,G as Tt,H as Ct,I as Et,J as At,K as Nt,N as qt,L as Mt,M as It}from"./HoverColumns.msZBrzf5.mjs";import{m as Kt}from"./min.D1slsF82.mjs";import{t as Yt}from"./time.DB6l0vbb.mjs";import{b as ue}from"./input.Cvf2xTFQ.mjs";import{b as Pt}from"./this.COGKo2H1.mjs";import{w as Wt}from"./index.BmKPAsrv.mjs";var Bt=C('<div class="card-info-placeholder svelte-16vamgt"> </div>');function Gt(n,f){oe(f,!1),ne();var i=Bt(),a=u(i,!0);x(()=>R(a,We())),o(i),$(n,i),ve()}var Ot=C('<tr><th class="align-start svelte-1ws7hzc"> </th><td> </td></tr>'),Ut=C('<table class="stats-table align-start svelte-1ws7hzc"><tbody></tbody></table>');function zt(n,f){oe(f,!1);let i=ee(f,"stats",8);function a(e){return new Ce(Number(e)).dateString()}function d(e){const l=[];if(l.push({label:Be(),value:a(e.added)}),e.firstReview!=null&&l.push({label:Ge(),value:a(e.firstReview)}),e.latestReview!=null&&l.push({label:Oe(),value:a(e.latestReview)}),e.dueDate!=null&&l.push({label:Ue(),value:a(e.dueDate)}),e.duePosition!=null&&l.push({label:ze(),value:e.duePosition}),e.interval&&l.push({label:$e(),value:G(e.interval*xt)}),e.memoryState){let h=G(e.memoryState.stability*86400,!1,!1);if(e.memoryState.stability>31){const t=e.memoryState.stability.toFixed(0);h+=` (${t})`}l.push({label:Fe(),value:h});const m=((e.memoryState.difficulty-1)/9*100).toFixed(0);if(l.push({label:je(),value:`${m}%`}),e.fsrsRetrievability){const t=(e.fsrsRetrievability*100).toFixed(0);l.push({label:ke(),value:`${t}%`})}}else e.ease&&l.push({label:Te(),value:`${e.ease/10}%`});l.push({label:He(),value:e.reviews}),l.push({label:Ve(),value:e.lapses}),e.totalSecs&&(l.push({label:Je(),value:G(e.averageSecs)}),l.push({label:Xe(),value:G(e.totalSecs)})),l.push({label:Ze(),value:e.cardType}),l.push({label:Qe(),value:e.notetype});let w;if(e.originalDeck?w=`${e.deck} (${e.originalDeck})`:w=e.deck,l.push({label:et(),value:w}),l.push({label:tt(),value:e.preset}),l.push({label:at(),value:e.cardId}),l.push({label:rt(),value:e.noteId}),e.customData){let h;try{const m=JSON.parse(e.customData);h=Object.entries(m).map(([t,c])=>`${t}=${c}`).join(" ")}catch{h=e.customData}l.push({label:it(),value:h})}return l}let s=V();H(()=>ae(i()),()=>{U(s,d(i()))}),pe(),ne();var S=Ut(),L=u(S);Z(L,5,()=>v(s),Q,(e,l)=>{var w=Ot(),h=u(w),m=u(h,!0);o(h);var t=p(h),c=u(t,!0);o(t),o(w),x(()=>{R(m,v(l).label),R(c,v(l).value)}),$(e,w)}),o(L),o(S),$(n,S),ve()}const jt=19/81,Ht=-.5,Vt=1e3;function fe(n,f){return Math.pow(f/n*jt+1,Ht)}var _=(n=>(n[n.Week=0]="Week",n[n.Month=1]="Month",n[n.Year=2]="Year",n[n.AllTime=3]="AllTime",n))(_||{});const Jt={0:7,1:30,2:365,3:1/0};function Xt(n,f){return n.filter(i=>i.daysSinceFirstLearn<=f)}function _e(n){return n.reviewKind!==Y.MANUAL&&n.reviewKind!==Y.RESCHEDULED&&(n.reviewKind!==Y.FILTERED||n.ease!==0)}function Zt(n){const f=[];for(const i of n){if(i.reviewKind===Y.MANUAL&&i.ease===0)break;f.push(i)}return f.filter(i=>_e(i))}function Qt(n,f){const i=[];let a=0,d=0;const s=Math.min(f/Vt,1);let S=0;if(n.slice().reverse().forEach((c,g)=>{var q,T;const y=Number(c.time);if(g===0){a=y,d=((q=c.memoryState)==null?void 0:q.stability)||0,i.push({date:new Date(y*1e3),daysSinceFirstLearn:0,elapsedDaysSinceLastReview:0,retrievability:100,stability:d});return}const E=(y-a)/86400;let F=0;for(;F<E-s;){F+=s;const r=fe(d,F);i.push({date:new Date((a+F*86400)*1e3),daysSinceFirstLearn:i[i.length-1].daysSinceFirstLearn+s,elapsedDaysSinceLastReview:F,retrievability:r*100,stability:d})}S+=E,i.push({date:new Date((a+E*86400)*1e3),daysSinceFirstLearn:S,retrievability:100,elapsedDaysSinceLastReview:0,stability:d}),a=y,d=((T=c.memoryState)==null?void 0:T.stability)||0}),i.length===0)return[];const L=Date.now()/1e3,e=(L-a)/86400;let l=0;for(;l<e-s;){l+=s;const c=fe(d,l);i.push({date:new Date((a+l*86400)*1e3),daysSinceFirstLearn:i[i.length-1].daysSinceFirstLearn+s,elapsedDaysSinceLastReview:l,retrievability:c*100,stability:d})}S+=e;const w=fe(d,e);i.push({date:new Date(L*1e3),daysSinceFirstLearn:S,elapsedDaysSinceLastReview:e,retrievability:w*100,stability:d});const h=f-e;let m=0;for(;m<h;){m+=s;const c=fe(d,l+m);i.push({date:new Date((L+m*86400)*1e3),daysSinceFirstLearn:i[i.length-1].daysSinceFirstLearn+s,elapsedDaysSinceLastReview:e+m,retrievability:c*100,stability:d})}return Xt(i,f)}function Ee(n,f){if(n.length===0)return 0;const i=new Date,a=(i.getTime()/1e3-Number(n[n.length-1].time))/86400,d=(i.getTime()/1e3-Number(n[0].time))/86400,s=n[0].interval/86400,S=Math.max(s*1.5-d,s*.5);return Math.min(a+S,Jt[f])}function ea(n,f,i,a,d){const s=Dt(i),S=s.transition().duration(600);if(n.length===0){ye(s,!1);return}const L=Ee(n,f),e=Qt(n,L);if(e.length===0){ye(s,!1);return}else ye(s,!0);s.selectAll(".forgetting-curve-line").remove(),s.select(".hover-columns").remove();const l=Kt(e,r=>r.date),w=Rt(e,r=>r.date),h=Yt().domain([l,w]).range([a.marginLeft,a.width-a.marginRight]),m=Math.max(0,100-1.2*(100-Math.min(...e.map(r=>r.retrievability)))),t=Lt().domain([m,100]).range([a.height-a.marginBottom,a.marginTop]);s.select(".x-ticks").call(r=>r.transition(S).call($t(h).ticks(5).tickSizeOuter(0))).attr("direction","ltr"),s.select(".y-ticks").attr("transform",`translate(${a.marginLeft},0)`).call(r=>r.transition(S).call(Ft(t).tickSizeOuter(0))).attr("direction","ltr"),s.select(".y-ticks .y-axis-title").remove(),s.select(".y-ticks").append("text").attr("class","y-axis-title").attr("transform","rotate(-90)").attr("y",0-a.marginLeft).attr("x",0-a.height/2).attr("font-size","1rem").attr("dy","1.1em").attr("fill","currentColor");const c=kt().x(r=>h(r.date)).y(r=>t(r.retrievability)),g=d*100;s.append("linearGradient").attr("id","line-gradient").attr("gradientUnits","userSpaceOnUse").attr("x1",0).attr("y1",t(0)).attr("x2",0).attr("y2",t(100)).selectAll("stop").data([{offset:"0%",color:"tomato"},{offset:`${g}%`,color:"steelblue"},{offset:"100%",color:"green"}]).enter().append("stop").attr("offset",r=>r.offset).attr("stop-color",r=>r.color);const y=new Date,E=e.filter(r=>r.date<=y),F=e.filter(r=>r.date>=y);s.append("path").datum(E).attr("class","forgetting-curve-line").attr("fill","none").attr("stroke","url(#line-gradient)").attr("stroke-width",1.5).attr("d",c),s.append("path").datum(F).attr("class","forgetting-curve-line").attr("fill","none").attr("stroke","url(#line-gradient)").attr("stroke-width",1.5).attr("stroke-dasharray","4 4").attr("d",c),s.select(".desired-retention-line").remove(),g>m&&s.append("line").attr("class","desired-retention-line").attr("x1",a.marginLeft).attr("x2",a.width-a.marginRight).attr("y1",t(g)).attr("y2",t(g)).attr("stroke","steelblue").attr("stroke-dasharray","4 4").attr("stroke-width",1.2);const q=s.append("line").attr("class","focus-line").attr("y1",a.marginTop).attr("y2",a.height-a.marginBottom).attr("stroke","black").attr("stroke-width",1).style("opacity",0);function T(r){return`${L>=365?"Date":"Date Time"}: ${L>=365?r.date.toLocaleDateString():r.date.toLocaleString()}<br>
        ${lt()}: ${G(r.elapsedDaysSinceLastReview*86400)}<br>${ke()}: ${r.retrievability.toFixed(2)}%<br>${Fe()}: ${G(r.stability*86400)}`}s.append("g").attr("class","hover-columns").selectAll("rect").data(e).join("rect").attr("x",r=>h(r.date)-1).attr("y",a.marginTop).attr("width",2).attr("height",a.height-a.marginTop-a.marginBottom).attr("fill","transparent").on("mousemove",(r,k)=>{const[A,O]=Re(r,document.body),[ce,z]=Re(r,s.node()),P=t(g);q.attr("x1",h(k.date)-1).attr("x2",h(k.date)+1).style("opacity",1);let j=T(k);z>=P-10&&z<=P+10&&(j+=`<br>${st()}: ${d.toFixed(2)}`),Tt(j,A,O)}).on("mouseout",()=>{q.style("opacity",0),Ct()})}var ta=C('<div class="svelte-1bf093q"><b> </b> <span class="hidden-xs svelte-1bf093q"> </span></div>'),aa=C("<div> </div>"),ra=C("<div> </div>"),ia=C('<div class="svelte-1bf093q"> </div>'),sa=C('<div class="svelte-1bf093q"> </div>'),la=C('<div class="svelte-1bf093q"> </div>'),na=C('<div class="revlog-table svelte-1bf093q"><div class="column svelte-1bf093q"><div class="column-head svelte-1bf093q"> </div> <div class="column-content svelte-1bf093q"></div></div> <div class="column hidden-xs svelte-1bf093q"><div class="column-head svelte-1bf093q"> </div> <div class="column-content svelte-1bf093q"></div></div> <div class="column svelte-1bf093q"><div class="column-head svelte-1bf093q"> </div> <div class="column-content svelte-1bf093q"></div></div> <div class="column svelte-1bf093q"><div class="column-head svelte-1bf093q"> </div> <div class="column-content right svelte-1bf093q"></div></div> <div class="column hidden-xs svelte-1bf093q"><div class="column-head svelte-1bf093q"> </div> <div class="column-content svelte-1bf093q"></div></div> <div class="column svelte-1bf093q"><div class="column-head svelte-1bf093q"> </div> <div class="column-content right svelte-1bf093q"></div></div> <!></div>');function oa(n,f){oe(f,!1);const i=V();let a=ee(f,"revlog",8),d=ee(f,"fsrsEnabled",8,!1);function s(t){switch(t.reviewKind){case Y.LEARNING:return"revlog-learn";case Y.REVIEW:return"revlog-review";case Y.RELEARNING:return"revlog-relearn"}return""}function S(t){switch(t.reviewKind){case Y.LEARNING:return gt();case Y.REVIEW:return pt();case Y.RELEARNING:return mt();case Y.FILTERED:return ft();case Y.MANUAL:return ut();case Y.RESCHEDULED:return dt()}}function L(t){return t.buttonChosen===1?"revlog-ease1":""}function e(t,c){var y;const g=new Ce(Number(t.time));return{date:g.dateString(),time:g.timeString(),reviewKind:S(t),reviewKindClass:s(t),rating:t.buttonChosen,ratingClass:L(t),interval:G(t.interval),ease:l(t.ease),takenSecs:G(t.takenSecs,!0),elapsedTime:c,stability:(y=t.memoryState)!=null&&y.stability?G(t.memoryState.stability*86400):""}}function l(t){if(t===0)return"";const c=t/10;return c<=110?`D:${(c-10).toFixed(0)}%`:`${c.toFixed(0)}%`}H(()=>(ae(a()),G),()=>{U(i,a().map((t,c)=>{let g,y=c+1;for(;y<a().length;){if(_e(a()[y])){g=a()[y];break}y++}let E="N/A";return _e(t)&&(E=g?G(Number(t.time)-Number(g.time)):"0"),e(t,E)}))}),pe(),ne();var w=Le(),h=me(w);{var m=t=>{var c=na(),g=u(c),y=u(g),E=u(y,!0);x(()=>R(E,nt())),o(y);var F=p(y,2);Z(F,5,()=>v(i),Q,(M,I)=>{var b=ta(),K=u(b),Ne=u(K,!0);o(K);var Se=p(K,2),qe=u(Se);o(Se),o(b),x(()=>{var we;R(Ne,v(I).date),R(qe,`@ ${(we=v(I).time)!=null?we:""}`)}),$(M,b)}),o(F),o(g);var q=p(g,2),T=u(q),r=u(T,!0);x(()=>R(r,ot())),o(T);var k=p(T,2);Z(k,5,()=>v(i),Q,(M,I)=>{var b=aa(),K=u(b,!0);o(b),x(()=>{xe(b,De(v(I).reviewKindClass),"svelte-1bf093q"),R(K,v(I).reviewKind)}),$(M,b)}),o(k),o(q);var A=p(q,2),O=u(A),ce=u(O,!0);x(()=>R(ce,vt())),o(O);var z=p(O,2);Z(z,5,()=>v(i),Q,(M,I)=>{var b=ra(),K=u(b,!0);o(b),x(()=>{xe(b,De(v(I).ratingClass),"svelte-1bf093q"),R(K,v(I).rating)}),$(M,b)}),o(z),o(A);var P=p(A,2),j=u(P),ge=u(j,!0);x(()=>R(ge,$e())),o(j);var re=p(j,2);Z(re,5,()=>v(i),Q,(M,I)=>{var b=ia(),K=u(b,!0);o(b),x(()=>R(K,v(I).interval)),$(M,b)}),o(re),o(P);var ie=p(P,2),se=u(ie),be=u(se,!0);x(()=>R(be,Te())),o(se);var D=p(se,2);Z(D,5,()=>v(i),Q,(M,I)=>{var b=sa(),K=u(b,!0);o(b),x(()=>R(K,v(I).ease)),$(M,b)}),o(D),o(ie);var W=p(ie,2),N=u(W),X=u(N,!0);x(()=>R(X,ct())),o(N);var te=p(N,2);Z(te,5,()=>v(i),Q,(M,I)=>{var b=la(),K=u(b,!0);o(b),x(()=>R(K,v(I).takenSecs)),$(M,b)}),o(te),o(W);var B=p(W,2);{var Ae=M=>{};J(B,M=>{d()&&M(Ae)})}o(c),$(t,c)};J(h,t=>{a().length>0&&t(m)})}$(n,w),ve()}var va=C('<label class="svelte-1niucon"><input type="radio" class="svelte-1niucon"> </label>'),ca=C('<label class="svelte-1niucon"><input type="radio" class="svelte-1niucon"> </label>'),da=C('<div class="time-range-selector svelte-1niucon"><label class="svelte-1niucon"><input type="radio" class="svelte-1niucon"> </label> <label class="svelte-1niucon"><input type="radio" class="svelte-1niucon"> </label> <!> <!></div>'),ua=Me("<svg><!><!><!></svg>"),fa=C('<div class="forgetting-curve svelte-1niucon"><!> <!></div>');function ma(n,f){oe(f,!1);const i=Ye(),a=()=>Pe(t,"$timeRange",i),d=V(),s=V(),S=[];let L=ee(f,"revlog",8),e=ee(f,"desiredRetention",8),l=V(null);const w=Mt(),h=bt();let m=V(_.Week);const t=Wt(v(m));H(()=>ae(L()),()=>{U(d,Zt(L()))}),H(()=>(v(d),_),()=>{U(s,Ee(v(d),_.AllTime))}),H(()=>(v(s),_),()=>{v(s)>365?U(m,_.AllTime):v(s)>30?U(m,_.Year):v(s)>7&&U(m,_.Month)}),H(()=>v(m),()=>{le(t,v(m))}),H(()=>(v(d),a(),v(l),ae(e())),()=>{ea(v(d),a(),v(l),w,e())}),pe(),ne();var c=fa(),g=u(c);{var y=F=>{It(F,{children:(q,T)=>{var r=da(),k=u(r),A=u(k);de(A);var O,ce=p(A);x(()=>{var D;return R(ce,` ${(D=yt())!=null?D:""}`)}),o(k);var z=p(k,2),P=u(z);de(P);var j,ge=p(P);x(()=>{var D;return R(ge,` ${(D=_t())!=null?D:""}`)}),o(z);var re=p(z,2);{var ie=D=>{var W=va(),N=u(W);de(N);var X,te=p(N);x(()=>{var B;return R(te,` ${(B=St())!=null?B:""}`)}),o(W),x(()=>{X!==(X=_.Year)&&(N.value=(N.__value=_.Year)==null?"":_.Year)}),ue(S,[],N,()=>(_.Year,a()),B=>le(t,B)),$(D,W)};J(re,D=>{v(s)>30&&D(ie)})}var se=p(re,2);{var be=D=>{var W=ca(),N=u(W);de(N);var X,te=p(N);x(()=>{var B;return R(te,` ${(B=wt())!=null?B:""}`)}),o(W),x(()=>{X!==(X=_.AllTime)&&(N.value=(N.__value=_.AllTime)==null?"":_.AllTime)}),ue(S,[],N,()=>(_.AllTime,a()),B=>le(t,B)),$(D,W)};J(se,D=>{v(s)>365&&D(be)})}o(r),x(()=>{O!==(O=_.Week)&&(A.value=(A.__value=_.Week)==null?"":_.Week),j!==(j=_.Month)&&(P.value=(P.__value=_.Month)==null?"":_.Month)}),ue(S,[],A,()=>(_.Week,a()),D=>le(t,D)),ue(S,[],P,()=>(_.Month,a()),D=>le(t,D)),$(q,r)},$$slots:{default:!0}})};J(g,F=>{v(s)>7&&F(y)})}var E=p(g,2);Et(E,{title:h,children:(F,q)=>{var T=ua(),r=u(T);At(r,{bounds:w});var k=p(r);Nt(k);var A=p(k);qt(A,{bounds:w}),o(T),Pt(T,O=>U(l,O),()=>v(l)),x(()=>ht(T,"viewBox",`0 0 ${w.width} ${w.height}`)),$(F,T)},$$slots:{default:!0}}),o(c),$(n,c),ve()}var pa=C("<!> <!> <!>",1),ga=C('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function Na(n,f){oe(f,!1);const i=V(),a=V();let d=ee(f,"stats",8,null),s=ee(f,"showRevlog",8,!0);H(()=>ae(d()),()=>{var e;U(i,((e=d())==null?void 0:e.memoryState)!=null)}),H(()=>ae(d()),()=>{var e,l;U(a,(l=(e=d())==null?void 0:e.desiredRetention)!=null?l:.9)}),pe(),ne();var S=ga(),L=me(S);Ie(L,()=>({"--gutter-inline":"1rem","--gutter-block":"0.5rem"})),Ke(L.lastChild,{breakpoint:"md",children:(e,l)=>{var w=Le(),h=me(w);{var m=c=>{var g=pa(),y=me(g);he(y,{children:(r,k)=>{zt(r,{get stats(){return d()}})},$$slots:{default:!0}});var E=p(y,2);{var F=r=>{he(r,{children:(k,A)=>{oa(k,{get revlog(){return d().revlog},get fsrsEnabled(){return v(i)}})},$$slots:{default:!0}})};J(E,r=>{s()&&r(F)})}var q=p(E,2);{var T=r=>{he(r,{children:(k,A)=>{ma(k,{get revlog(){return d().revlog},get desiredRetention(){return v(a)}})},$$slots:{default:!0}})};J(q,r=>{v(i)&&r(T)})}$(c,g)},t=c=>{Gt(c,{})};J(h,c=>{d()?c(m):c(t,!1)})}$(e,w)},$$slots:{default:!0}}),o(L),$(n,S),ve()}export{Na as C};
