import{c as j,a as p,b as I,t as et}from"./disclose-version.CZXCSga2.mjs";import{i as H}from"./legacy.Cvgq_wkp.mjs";import{p as L,l as R,M as D,a as G,f as q,b as U,g as t,s as $,c as _,N as P,r as m,t as C,m as N,aD as W,a_ as ht,n as K}from"./runtime.NF8NW0fQ.mjs";import{p as k,i as A}from"./props.C4_rjmFK.mjs";import{c as J,C as nt}from"./Container.C0RC8RQ7.mjs";import{s as V,p as rt,v as bt,w as _t}from"./backend.CuvxjHSt.mjs";import{I as yt,b as xt}from"./IconButton.DdPSxNFx.mjs";import{s as wt,a as E,b as $t,e as it}from"./store.CrzbHEEA.mjs";import{t as kt,bb as St,u as X,q as lt,bc as Tt,bd as It,be as Nt,bf as dt,bg as Y,bh as Pt,bi as ct,bj as ut,bk as Ct,bl as Bt,bm as qt,bn as zt,bo as Dt,bp as Et,bq as Ft,br as Mt,ai as Ot,bs as Rt,bt as At,bu as Ht,bv as Lt,bw as Ut,bx as jt}from"./runtime-require.ClQzQQRm.mjs";import{r as Qt}from"./progress.CDY_0XMd.mjs";import{p as Wt,e as vt,i as Vt}from"./theme.DvYw8rH4.mjs";import{S as Gt,g as Jt,n as Kt,l as Xt,u as Yt,q as Zt,I as mt,r as te,f as ee}from"./Shortcut.6Snuvz9J.mjs";import{B as re}from"./ButtonToolbar.B1riy2Y6.mjs";import{S as se,L as ae}from"./LabelButton.CsMTQuqp.mjs";import{R as st}from"./Row.BoykZ5Sj.mjs";import{T as at}from"./TitledContainer.e0Zsj5mE.mjs";import{b as Z}from"./this.COGKo2H1.mjs";import{W as oe}from"./WithTooltip.CBYxWk4z.mjs";import{c as ne,o as ie}from"./index-client.CMnCpbS1.mjs";var le=I('<div class="progress svelte-z9dt5x"><div class="spinner svelte-z9dt5x"><div class="svelte-z9dt5x"></div> <div class="svelte-z9dt5x"></div> <div class="svelte-z9dt5x"></div> <div class="svelte-z9dt5x"></div></div> <div id="label" class="svelte-z9dt5x"> </div></div>');function de(n,e){L(e,!1);const r=wt(),s=()=>$t(Wt,"$pageTheme",r);let o=k(e,"task",8),d=k(e,"result",12),f=k(e,"error",12),h=N("");function b(a){a.value.value&&a.value.case!=="none"&&t(h)!==a.value.value.toString()&&$(h,a.value.value.toString())}R(()=>(D(d()),D(f()),D(o())),()=>{(async()=>{if(!d()&&!f())try{d(await Qt(o(),b))}catch(a){if(a instanceof Error)f(a);else throw a}})()}),G(),H();var i=j(),x=q(i);{var y=a=>{var l=le(),u=_(l),g=P(u,2),S=_(g,!0);m(g),m(l),C(()=>{kt(u,"nightMode",s().isDark),E(S,t(h))}),p(a,l)};A(x,a=>{d()||a(y)})}p(n,i),U()}var ce=I('<div class="message svelte-1ebpei3"> </div>');function ue(n,e){L(e,!1);let r=k(e,"error",8);H();var s=ce(),o=_(s,!0);m(s),C(()=>E(o,r().message)),p(n,s),U()}var ve=I('<div class="import svelte-zco36t"> </div>'),me=I('<div class="filename svelte-zco36t"> </div> <svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!>',1),pe=I('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function fe(n,e){L(e,!1);let r=k(e,"path",8),s=k(e,"onImport",8);const o="Control+Enter";function d(b){return b.split(/[\\/]/).pop()}H();var f=pe(),h=q(f);J(h,()=>({"--gutter-block":"0.5rem","--gutter-inline":"0.25rem","--sticky-borders":"0 0 1px"})),se(h.lastChild,{breakpoint:"sm",children:(b,i)=>{re(b,{class:"justify-content-between",wrap:!1,children:(x,y)=>{var a=me(),l=q(a),u=_(l,!0);C(()=>E(u,d(r()))),m(l);var g=P(l,2),S=W(()=>Jt(o));J(g,()=>({"--border-left-radius":"5px","--border-right-radius":"5px"})),ae(g.lastChild,{primary:!0,get tooltip(){return t(S)},$$events:{click(...w){var T;(T=s())==null||T.apply(this,w)}},children:(w,T)=>{var z=ve(),O=_(z,!0);C(()=>E(O,St())),m(z),p(w,z)},$$slots:{default:!0}}),m(g);var F=P(g,2);Gt(F,{keyCombination:o,$$events:{action(...w){var T;(T=s())==null||T.apply(this,w)}}}),p(x,a)},$$slots:{default:!0}})},$$slots:{default:!0}}),m(h),p(n,f),U()}var ge=I("<tr><td></td></tr>"),he=I("<tr><td></td></tr>"),be=I('<div class="outer svelte-1c3gv3l"><table tabindex="-1"><thead><!></thead><tbody><!><!><!></tbody></table></div>');function _e(n,e){L(e,!1);const r=N(),s=N(),o=N(),d=N(),f=N();let h=k(e,"class",8,""),b=k(e,"itemsCount",8,0),i=k(e,"itemHeight",8),x=k(e,"bottomOffset",8,0),y=N(),a=N(0);window.addEventListener("resize",()=>{$(r,t(r))}),R(()=>(t(y),D(x()),D(i())),()=>{$(r,t(y)?Math.floor((document.documentElement.clientHeight-t(y).offsetTop-x())/i())*i():0)}),R(()=>(t(r),D(i())),()=>{$(s,Math.ceil(t(r)/i()))}),R(()=>(t(a),D(i())),()=>{$(o,Math.floor(t(a)/i()))}),R(()=>(t(o),t(s),D(b())),()=>{$(d,Math.min(t(o)+t(s),b()))}),R(()=>(t(d),t(o)),()=>{$(f,new Array(t(d)-t(o)).fill(0).map((v,c)=>t(o)+c))}),G(),H();var l=be(),u=_(l),g=_(u),S=_(g);V(S,e,"headers",{}),m(g);var F=P(g),w=_(F);{var T=v=>{var c=ge(),M=_(c);m(c),C(()=>X(M,"style",`height: ${i()*t(o)}px;`)),p(v,c)};A(w,v=>{i()*t(o)>0&&v(T)})}var z=P(w);vt(z,1,()=>t(f),v=>v,(v,c)=>{var M=j(),Q=q(M);V(Q,e,"row",{get index(){return t(c)}}),p(v,M)});var O=P(z);{var B=v=>{var c=he(),M=_(c);m(c),C(()=>X(M,"style",`height: ${i()*b()-i()*t(d)}px;`)),p(v,c)};A(O,v=>{i()*b()-i()*t(d)>0&&v(B)})}m(F),m(u),m(l),Z(l,v=>$(y,v),()=>t(y)),C(()=>{var v,c;X(l,"style",`--container-height: ${(v=t(r))!=null?v:""}px`),lt(u,`table ${(c=h())!=null?c:""} svelte-1c3gv3l`)}),it("scroll",l,()=>$(a,t(y).scrollTop)),p(n,l),U()}function ye(n){let e,r;n.dupeResolution===rt.DUPLICATE?(e=Ft(),r=Mt()):n.dupeResolution===rt.PRESERVE?(e=dt(),r=Y()):(e=ct(),r=ut());const s={reason:e,notes:n.firstFieldMatch};return{action:r,queue:s}}function xe(n){const e=[{queues:[{notes:n.new,reason:Tt()}],action:It(),summaryTemplate:Nt,canBrowse:!0,icon:Kt},{queues:[{notes:n.duplicate,reason:dt()}],action:Y(),summaryTemplate:Pt,canBrowse:!0,icon:Xt},{queues:[{notes:n.updated,reason:ct()}],action:ut(),summaryTemplate:Ct,canBrowse:!0,icon:Yt},{queues:[{notes:n.conflicting,reason:Bt()},{notes:n.missingNotetype,reason:qt()},{notes:n.missingDeck,reason:zt()},{notes:n.emptyFirstField,reason:Dt()}],action:Y(),summaryTemplate:Et,canBrowse:!1,icon:Zt}],r=ye(n);for(const s of e)if(s.action===r.action){s.queues.push(r.queue);break}return e}function we(n){const e=[];for(const r of n)for(const s of r.queues)if(s.notes)for(const o of s.notes)e.push({summary:r,queue:s,note:o});return e}function pt(n){bt({filter:{case:"nids",value:{ids:n.map(e=>e.id.nid)}}})}var $e=I("<td><!></td>");function ke(n,e){L(e,!1);let r=k(e,"class",8,"");const s=ne();let o=N();ie(async()=>{s("mount",{element:t(o)})}),H();var d=$e(),f=_(d);V(f,e,"default",{}),m(d),Z(d,h=>$(o,h),()=>t(o)),C(()=>lt(d,Ot(r()))),p(n,d),U()}function ot(n,e){let r=k(e,"class",8,""),s=k(e,"tooltip",8);oe(n,{get tooltip(){return s()},children:ht,$$slots:{default:(o,d)=>{const f=W(()=>d.createTooltip);ke(o,{get class(){return r()},$$events:{mount:h=>t(f)(h.detail.element)},children:(h,b)=>{var i=j(),x=q(i);V(x,e,"default",{}),p(h,i)},$$slots:{default:!0}})}}})}var Se=I('<tr slot="headers" class="svelte-1blptr9"><th>#</th><th> </th><th> </th><th></th></tr>'),Te=I('<tr class="svelte-1blptr9"><td class="index-cell svelte-1blptr9"> </td><!><!><td class="search-cell"><!></td></tr>'),Ie=I("<div><!></div>");function Ne(n,e){L(e,!1);const r=N();let s=k(e,"summaries",8),o=k(e,"bottomOffset",8,0),d=N();R(()=>D(s()),()=>{$(r,we(s()))}),G(),H();var f=Ie(),h=_(f);{var b=i=>{_e(i,{class:"details-table",itemHeight:40,get itemsCount(){return t(r).length},get bottomOffset(){return o()},$$slots:{headers:(x,y)=>{var a=Se(),l=P(_(a)),u=_(l,!0);C(()=>E(u,Rt())),m(l);var g=P(l),S=_(g,!0);C(()=>E(S,At())),m(g),K(),m(a),p(x,a)},row:(x,y)=>{const a=W(()=>y.index);var l=Te(),u=_(l),g=_(u,!0);m(u);var S=P(u);ot(S,{class:"status-cell",get tooltip(){return t(r)[t(a)].queue.reason},children:(B,v)=>{K();var c=et();C(()=>E(c,t(r)[t(a)].summary.action)),p(B,c)},$$slots:{default:!0}});var F=P(S),w=W(()=>t(r)[t(a)].note.fields.join(","));ot(F,{class:"contents-cell",get tooltip(){return t(w)},children:(B,v)=>{K();var c=et();C(()=>E(c,t(r)[t(a)].note.fields.join(","))),p(B,c)},$$slots:{default:!0}});var T=P(F),z=_(T),O=W(()=>!t(r)[t(a)].summary.canBrowse);yt(z,{class:"search-icon",iconSize:100,active:!1,get disabled(){return t(O)},$$events:{click:()=>{pt([t(r)[t(a)].note])}},children:(B,v)=>{mt(B,{icon:te})},$$slots:{default:!0}}),m(T),m(l),C(()=>E(g,t(a)+1)),p(x,l)}}})};A(h,i=>{t(d)&&i(b)})}m(f),Z(f,i=>$(d,i),()=>t(d)),p(n,f),U()}var Pe=I('<button class="desktop-only"> </button>'),Ce=I('<li class="svelte-ohwq2k"><!> <!></li>');function Be(n,e){L(e,!1);const r=N();let s=k(e,"summary",8);function o(b){pt(t(r)),b.preventDefault()}R(()=>D(s()),()=>{$(r,s().queues.map(b=>b.notes).flat())}),G(),H();var d=j(),f=q(d);{var h=b=>{var i=Ce(),x=_(i);ee(x,{children:(u,g)=>{mt(u,{get icon(){return s().icon}})},$$slots:{default:!0}});var y=P(x);C(()=>{var u;return E(y,` ${(u=s().summaryTemplate({count:t(r).length}))!=null?u:""} `)});var a=P(y);{var l=u=>{var g=Pe(),S=_(g,!0);C(()=>E(S,Ht())),m(g),it("click",g,o),p(u,g)};A(a,u=>{s().canBrowse&&u(l)})}m(i),p(b,i)};A(f,b=>{t(r).length&&b(h)})}p(n,d),U()}var qe=I("<p> </p> <ul></ul>",1),ze=I("<!> <!>",1),De=I('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function Ee(n,e){L(e,!1);const r=N(),s=N();let o=k(e,"response",8);const d=.5,f=getComputedStyle(document.documentElement),h=parseInt(f.fontSize),b=(3*d+.75)*h;R(()=>D(o()),()=>{$(r,xe(o().log))}),R(()=>D(o()),()=>{var y,a;$(s,(a=(y=o().log)==null?void 0:y.foundNotes)!=null?a:0)}),G(),H();var i=De(),x=q(i);J(x,()=>({"--gutter-inline":"0.25rem","--gutter-block":`${d}rem`})),nt(x.lastChild,{breakpoint:"sm",children:(y,a)=>{var l=ze(),u=q(l);st(u,{children:(S,F)=>{var w=W(()=>Ut());at(S,{get title(){return t(w)},children:(T,z)=>{var O=qe(),B=q(O),v=_(B,!0);C(()=>E(v,Lt({notes:t(s)}))),m(B);var c=P(B,2);vt(c,5,()=>t(r),Vt,(M,Q)=>{Be(M,{get summary(){return t(Q)}})}),m(c),p(T,O)},$$slots:{default:!0}})},$$slots:{default:!0}});var g=P(u,2);st(g,{children:(S,F)=>{var w=W(()=>jt());at(S,{get title(){return t(w)},children:(T,z)=>{Ne(T,{get summaries(){return t(r)},bottomOffset:b})},$$slots:{default:!0}})},$$slots:{default:!0}}),p(y,l)},$$slots:{default:!0}}),m(x),p(n,i),U()}var Fe=I('<div class="pre-import-page svelte-1rmka3z"><!> <svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div>');function sr(n,e){L(e,!1);let r=k(e,"path",8),s=k(e,"importer",8);const o=!1;let d=N(void 0),f=N(void 0),h=N(o);async function b(){const l=await s().doImport();return await _t({}),$(h,!1),l}H();var i=j(),x=q(i);{var y=l=>{ue(l,{get error(){return t(f)}})},a=l=>{var u=j(),g=q(u);{var S=w=>{Ee(w,{get response(){return t(d)}})},F=w=>{var T=j(),z=q(T);{var O=v=>{de(v,{task:b,get result(){return t(d)},set result(c){$(d,c)},get error(){return t(f)},set error(c){$(f,c)},$$legacy:!0})},B=v=>{var c=Fe(),M=_(c);fe(M,{get path(){return r()},onImport:()=>$(h,!0)});var Q=P(M,2);J(Q,()=>({"--gutter-inline":"0.25rem","--gutter-block":"0.5rem"})),nt(Q.lastChild,{breakpoint:"sm",class:"container-columns",children:(ft,Me)=>{var tt=j(),gt=q(tt);V(gt,e,"default",{}),p(ft,tt)},$$slots:{default:!0}}),m(Q),m(c),p(v,c)};A(z,v=>{t(h)?v(O):v(B,!1)},!0)}p(w,T)};A(g,w=>{t(d)?w(S):w(F,!1)},!0)}p(l,u)};A(x,l=>{t(f)?l(y):l(a,!1)})}return p(n,i),xt(e,"noOptions",o),U({noOptions:o})}export{sr as I};
