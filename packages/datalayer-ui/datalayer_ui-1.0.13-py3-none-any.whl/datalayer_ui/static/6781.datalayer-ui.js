(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[6781],{18565:function(e,t,n){var r=n(42165);!function(e){"use strict";var t="undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},o=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e},s=Object.prototype.hasOwnProperty;function i(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function a(e){try{return encodeURIComponent(e)}catch(e){return null}}var c={stringify:function(e,t){t=t||"";var n,r,o=[];for(r in"string"!=typeof t&&(t="?"),e)if(s.call(e,r)){if((n=e[r])||null!=n&&!isNaN(n)||(n=""),r=a(r),n=a(n),null===r||null===n)continue;o.push(r+"="+n)}return o.length?t+o.join("&"):""},parse:function(e){for(var t,n=/([^=?#&]+)=?([^&]*)/g,r={};t=n.exec(e);){var o=i(t[1]),s=i(t[2]);null===o||null===s||o in r||(r[o]=s)}return r}},l=/[\n\r\t]/g,u=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,h=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,p=/^[a-zA-Z]:/,d=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/;function g(e){return(e||"").toString().replace(d,"")}var f=[["#","hash"],["?","query"],function(e,t){return m(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],v={hash:1,query:1};function y(e){var n,r=("undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{}).location||{},o={},s=typeof(e=e||r);if("blob:"===e.protocol)o=new w(unescape(e.pathname),{});else if("string"===s)for(n in o=new w(e,{}),v)delete o[n];else if("object"===s){for(n in e)n in v||(o[n]=e[n]);void 0===o.slashes&&(o.slashes=u.test(e.href))}return o}function m(e){return"file:"===e||"ftp:"===e||"http:"===e||"https:"===e||"ws:"===e||"wss:"===e}function S(e,t){e=(e=g(e)).replace(l,""),t=t||{};var n,r=h.exec(e),o=r[1]?r[1].toLowerCase():"",s=!!r[2],i=!!r[3],a=0;return s?i?(n=r[2]+r[3]+r[4],a=r[2].length+r[3].length):(n=r[2]+r[4],a=r[2].length):i?(n=r[3]+r[4],a=r[3].length):n=r[4],"file:"===o?a>=2&&(n=n.slice(2)):m(o)?n=r[4]:o?s&&(n=n.slice(2)):a>=2&&m(t.protocol)&&(n=r[4]),{protocol:o,slashes:s||m(o),slashesCount:a,rest:n}}function w(e,t,n){if(e=(e=g(e)).replace(l,""),!(this instanceof w))return new w(e,t,n);var r,s,i,a,u,h,d=f.slice(),v=typeof t,E=this,b=0;for("object"!==v&&"string"!==v&&(n=t,t=null),n&&"function"!=typeof n&&(n=c.parse),r=!(s=S(e||"",t=y(t))).protocol&&!s.slashes,E.slashes=s.slashes||r&&t.slashes,E.protocol=s.protocol||t.protocol||"",e=s.rest,("file:"===s.protocol&&(2!==s.slashesCount||p.test(e))||!s.slashes&&(s.protocol||s.slashesCount<2||!m(E.protocol)))&&(d[3]=[/(.*)/,"pathname"]);b<d.length;b++)"function"!=typeof(a=d[b])?(i=a[0],h=a[1],i!=i?E[h]=e:"string"==typeof i?~(u="@"===i?e.lastIndexOf(i):e.indexOf(i))&&("number"==typeof a[2]?(E[h]=e.slice(0,u),e=e.slice(u+a[2])):(E[h]=e.slice(u),e=e.slice(0,u))):(u=i.exec(e))&&(E[h]=u[1],e=e.slice(0,u.index)),E[h]=E[h]||r&&a[3]&&t[h]||"",a[4]&&(E[h]=E[h].toLowerCase())):e=a(e,E);n&&(E.query=n(E.query)),r&&t.slashes&&"/"!==E.pathname.charAt(0)&&(""!==E.pathname||""!==t.pathname)&&(E.pathname=function(e,t){if(""===e)return t;for(var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),r=n.length,o=n[r-1],s=!1,i=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),i++):i&&(0===r&&(s=!0),n.splice(r,1),i--);return s&&n.unshift(""),"."!==o&&".."!==o||n.push(""),n.join("/")}(E.pathname,t.pathname)),"/"!==E.pathname.charAt(0)&&m(E.protocol)&&(E.pathname="/"+E.pathname),o(E.port,E.protocol)||(E.host=E.hostname,E.port=""),E.username=E.password="",E.auth&&(~(u=E.auth.indexOf(":"))?(E.username=E.auth.slice(0,u),E.username=encodeURIComponent(decodeURIComponent(E.username)),E.password=E.auth.slice(u+1),E.password=encodeURIComponent(decodeURIComponent(E.password))):E.username=encodeURIComponent(decodeURIComponent(E.auth)),E.auth=E.password?E.username+":"+E.password:E.username),E.origin="file:"!==E.protocol&&m(E.protocol)&&E.host?E.protocol+"//"+E.host:"null",E.href=E.toString()}w.prototype={set:function(e,t,n){var r=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(n||c.parse)(t)),r[e]=t;break;case"port":r[e]=t,o(t,r.protocol)?t&&(r.host=r.hostname+":"+t):(r.host=r.hostname,r[e]="");break;case"hostname":r[e]=t,r.port&&(t+=":"+r.port),r.host=t;break;case"host":r[e]=t,/:\d+$/.test(t)?(t=t.split(":"),r.port=t.pop(),r.hostname=t.join(":")):(r.hostname=t,r.port="");break;case"protocol":r.protocol=t.toLowerCase(),r.slashes=!n;break;case"pathname":case"hash":if(t){var s="pathname"===e?"/":"#";r[e]=t.charAt(0)!==s?s+t:t}else r[e]=t;break;case"username":case"password":r[e]=encodeURIComponent(t);break;case"auth":var i=t.indexOf(":");~i?(r.username=t.slice(0,i),r.username=encodeURIComponent(decodeURIComponent(r.username)),r.password=t.slice(i+1),r.password=encodeURIComponent(decodeURIComponent(r.password))):r.username=encodeURIComponent(decodeURIComponent(t))}for(var a=0;a<f.length;a++){var l=f[a];l[4]&&(r[l[1]]=r[l[1]].toLowerCase())}return r.auth=r.password?r.username+":"+r.password:r.username,r.origin="file:"!==r.protocol&&m(r.protocol)&&r.host?r.protocol+"//"+r.host:"null",r.href=r.toString(),r},toString:function(e){e&&"function"==typeof e||(e=c.stringify);var t,n=this,r=n.host,o=n.protocol;o&&":"!==o.charAt(o.length-1)&&(o+=":");var s=o+(n.protocol&&n.slashes||m(n.protocol)?"//":"");return n.username?(s+=n.username,n.password&&(s+=":"+n.password),s+="@"):n.password?(s+=":"+n.password,s+="@"):"file:"!==n.protocol&&m(n.protocol)&&!r&&"/"!==n.pathname&&(s+="@"),":"===r[r.length-1]&&(r+=":"),s+=r+n.pathname,(t="object"==typeof n.query?e(n.query):n.query)&&(s+="?"!==t.charAt(0)?"?"+t:t),n.hash&&(s+=n.hash),s}},w.extractProtocol=S,w.location=y,w.trimLeft=g,w.qs=c;var E=w;function b(e,t){setTimeout((function(t){return e.call(t)}),4,t)}function k(e,t){void 0!==r&&console[e].call(null,t)}function _(e,t){void 0===e&&(e=[]);var n=[];return e.forEach((function(e){t(e)||n.push(e)})),n}var C=function(){this.listeners={}};function O(e){var t=e.indexOf("?");return t>=0?e.slice(0,t):e}C.prototype.addEventListener=function(e,t){"function"==typeof t&&(Array.isArray(this.listeners[e])||(this.listeners[e]=[]),0===function(e,t){void 0===e&&(e=[]);var n=[];return e.forEach((function(e){t(e)&&n.push(e)})),n}(this.listeners[e],(function(e){return e===t})).length&&this.listeners[e].push(t))},C.prototype.removeEventListener=function(e,t){var n=this.listeners[e];this.listeners[e]=_(n,(function(e){return e===t}))},C.prototype.dispatchEvent=function(e){for(var t=this,n=[],r=arguments.length-1;r-- >0;)n[r]=arguments[r+1];var o=e.type,s=this.listeners[o];return!!Array.isArray(s)&&(s.forEach((function(r){n.length>0?r.apply(t,n):r.call(t,e)})),!0)};var R=function(){this.urlMap={}};R.prototype.attachWebSocket=function(e,t){var n=O(t),r=this.urlMap[n];if(r&&r.server&&-1===r.websockets.indexOf(e))return r.websockets.push(e),r.server},R.prototype.addMembershipToRoom=function(e,t){var n=this.urlMap[O(e.url)];n&&n.server&&-1!==n.websockets.indexOf(e)&&(n.roomMemberships[t]||(n.roomMemberships[t]=[]),n.roomMemberships[t].push(e))},R.prototype.attachServer=function(e,t){var n=O(t);if(!this.urlMap[n])return this.urlMap[n]={server:e,websockets:[],roomMemberships:{}},e},R.prototype.serverLookup=function(e){var t=O(e),n=this.urlMap[t];if(n)return n.server},R.prototype.websocketsLookup=function(e,t,n){var r,o=O(e),s=this.urlMap[o];return r=s?s.websockets:[],t&&(r=s.roomMemberships[t]||[]),n?r.filter((function(e){return e!==n})):r},R.prototype.removeServer=function(e){delete this.urlMap[O(e)]},R.prototype.removeWebSocket=function(e,t){var n=O(t),r=this.urlMap[n];r&&(r.websockets=_(r.websockets,(function(t){return t===e})))},R.prototype.removeMembershipFromRoom=function(e,t){var n=this.urlMap[O(e.url)],r=n.roomMemberships[t];n&&null!==r&&(n.roomMemberships[t]=_(r,(function(t){return t===e})))};var M=new R,N=1e3,L=1005,I=1006,P={CONSTRUCTOR_ERROR:"Failed to construct 'WebSocket':",CLOSE_ERROR:"Failed to execute 'close' on 'WebSocket':",EVENT:{CONSTRUCT:"Failed to construct 'Event':",MESSAGE:"Failed to construct 'MessageEvent':",CLOSE:"Failed to construct 'CloseEvent':"}},T=function(){};T.prototype.stopPropagation=function(){},T.prototype.stopImmediatePropagation=function(){},T.prototype.initEvent=function(e,t,n){void 0===e&&(e="undefined"),void 0===t&&(t=!1),void 0===n&&(n=!1),this.type=""+e,this.bubbles=Boolean(t),this.cancelable=Boolean(n)};var x=function(e){function t(t,n){if(void 0===n&&(n={}),e.call(this),!t)throw new TypeError(P.EVENT_ERROR+" 1 argument required, but only 0 present.");if("object"!=typeof n)throw new TypeError(P.EVENT_ERROR+" parameter 2 ('eventInitDict') is not an object.");var r=n.bubbles,o=n.cancelable;this.type=""+t,this.timeStamp=Date.now(),this.target=null,this.srcElement=null,this.returnValue=!0,this.isTrusted=!1,this.eventPhase=0,this.defaultPrevented=!1,this.currentTarget=null,this.cancelable=!!o&&Boolean(o),this.cancelBubble=!1,this.bubbles=!!r&&Boolean(r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(T),A=function(e){function t(t,n){if(void 0===n&&(n={}),e.call(this),!t)throw new TypeError(P.EVENT.MESSAGE+" 1 argument required, but only 0 present.");if("object"!=typeof n)throw new TypeError(P.EVENT.MESSAGE+" parameter 2 ('eventInitDict') is not an object");var r=n.bubbles,o=n.cancelable,s=n.data,i=n.origin,a=n.lastEventId,c=n.ports;this.type=""+t,this.timeStamp=Date.now(),this.target=null,this.srcElement=null,this.returnValue=!0,this.isTrusted=!1,this.eventPhase=0,this.defaultPrevented=!1,this.currentTarget=null,this.cancelable=!!o&&Boolean(o),this.canncelBubble=!1,this.bubbles=!!r&&Boolean(r),this.origin=""+i,this.ports=void 0===c?null:c,this.data=void 0===s?null:s,this.lastEventId=""+(a||"")}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(T),j=function(e){function t(t,n){if(void 0===n&&(n={}),e.call(this),!t)throw new TypeError(P.EVENT.CLOSE+" 1 argument required, but only 0 present.");if("object"!=typeof n)throw new TypeError(P.EVENT.CLOSE+" parameter 2 ('eventInitDict') is not an object");var r=n.bubbles,o=n.cancelable,s=n.code,i=n.reason,a=n.wasClean;this.type=""+t,this.timeStamp=Date.now(),this.target=null,this.srcElement=null,this.returnValue=!0,this.isTrusted=!1,this.eventPhase=0,this.defaultPrevented=!1,this.currentTarget=null,this.cancelable=!!o&&Boolean(o),this.cancelBubble=!1,this.bubbles=!!r&&Boolean(r),this.code="number"==typeof s?parseInt(s,10):0,this.reason=""+(i||""),this.wasClean=!!a&&Boolean(a)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(T);function D(e){var t=e.type,n=e.target,r=new x(t);return n&&(r.target=n,r.srcElement=n,r.currentTarget=n),r}function U(e){var t=e.type,n=e.origin,r=e.data,o=e.target,s=new A(t,{data:r,origin:n});return o&&(s.target=o,s.srcElement=o,s.currentTarget=o),s}function K(e){var t=e.code,n=e.reason,r=e.type,o=e.target,s=e.wasClean;s||(s=t===N||t===L);var i=new j(r,{code:t,reason:n,wasClean:s});return o&&(i.target=o,i.srcElement=o,i.currentTarget=o),i}function W(e,t,n){e.readyState=B.CLOSING;var r=M.serverLookup(e.url),o=K({type:"close",target:e.target,code:t,reason:n});b((function(){M.removeWebSocket(e,e.url),e.readyState=B.CLOSED,e.dispatchEvent(o),r&&r.dispatchEvent(o,r)}),e)}function G(e){return"[object Blob]"===Object.prototype.toString.call(e)||e instanceof ArrayBuffer||(e=String(e)),e}var q=new WeakMap;function J(e){if(q.has(e))return q.get(e);var t=new Proxy(e,{get:function(n,r){if("close"===r)return function(e){void 0===e&&(e={});var n=e.code||N,r=e.reason||"";W(t,n,r)};if("send"===r)return function(t){t=G(t),e.dispatchEvent(U({type:"message",data:t,origin:this.url,target:e}))};var o=function(e){return"message"===e?"server::"+e:e};return"on"===r?function(t,n){e.addEventListener(o(t),n)}:"off"===r?function(t,n){e.removeEventListener(o(t),n)}:"target"===r?e:n[r]}});return q.set(e,t),t}var B=function(e){function t(n,r){e.call(this),this._onopen=null,this._onmessage=null,this._onerror=null,this._onclose=null,this.url=function(e){var t=new E(e),n=t.pathname,r=t.protocol,o=t.hash;if(!e)throw new TypeError(P.CONSTRUCTOR_ERROR+" 1 argument required, but only 0 present.");if(n||(t.pathname="/"),""===r)throw new SyntaxError(P.CONSTRUCTOR_ERROR+" The URL '"+t.toString()+"' is invalid.");if("ws:"!==r&&"wss:"!==r)throw new SyntaxError(P.CONSTRUCTOR_ERROR+" The URL's scheme must be either 'ws' or 'wss'. '"+r+"' is not allowed.");if(""!==o)throw new SyntaxError(P.CONSTRUCTOR_ERROR+" The URL contains a fragment identifier ('"+o+"'). Fragment identifiers are not allowed in WebSocket URLs.");return t.toString()}(n),r=function(e){if(void 0===e&&(e=[]),!Array.isArray(e)&&"string"!=typeof e)throw new SyntaxError(P.CONSTRUCTOR_ERROR+" The subprotocol '"+e.toString()+"' is invalid.");"string"==typeof e&&(e=[e]);var t=e.map((function(e){return{count:1,protocol:e}})).reduce((function(e,t){return e[t.protocol]=(e[t.protocol]||0)+t.count,e}),{}),n=Object.keys(t).filter((function(e){return t[e]>1}));if(n.length>0)throw new SyntaxError(P.CONSTRUCTOR_ERROR+" The subprotocol '"+n[0]+"' is duplicated.");return e}(r),this.protocol=r[0]||"",this.binaryType="blob",this.readyState=t.CONNECTING;var o=J(this),s=M.attachWebSocket(o,this.url);b((function(){if(this.readyState===t.CONNECTING)if(s)if(s.options.verifyClient&&"function"==typeof s.options.verifyClient&&!s.options.verifyClient())this.readyState=t.CLOSED,k("error","WebSocket connection to '"+this.url+"' failed: HTTP Authentication failed; no valid credentials available"),M.removeWebSocket(o,this.url),this.dispatchEvent(D({type:"error",target:this})),this.dispatchEvent(K({type:"close",target:this,code:N}));else{if(s.options.selectProtocol&&"function"==typeof s.options.selectProtocol){var e=s.options.selectProtocol(r),n=""!==e,i=-1!==r.indexOf(e);if(n&&!i)return this.readyState=t.CLOSED,k("error","WebSocket connection to '"+this.url+"' failed: Invalid Sub-Protocol"),M.removeWebSocket(o,this.url),this.dispatchEvent(D({type:"error",target:this})),void this.dispatchEvent(K({type:"close",target:this,code:N}));this.protocol=e}this.readyState=t.OPEN,this.dispatchEvent(D({type:"open",target:this})),s.dispatchEvent(D({type:"connection"}),o)}else this.readyState=t.CLOSED,this.dispatchEvent(D({type:"error",target:this})),this.dispatchEvent(K({type:"close",target:this,code:N})),k("error","WebSocket connection to '"+this.url+"' failed")}),this)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={onopen:{},onmessage:{},onclose:{},onerror:{}};return n.onopen.get=function(){return this._onopen},n.onmessage.get=function(){return this._onmessage},n.onclose.get=function(){return this._onclose},n.onerror.get=function(){return this._onerror},n.onopen.set=function(e){this.removeEventListener("open",this._onopen),this._onopen=e,this.addEventListener("open",e)},n.onmessage.set=function(e){this.removeEventListener("message",this._onmessage),this._onmessage=e,this.addEventListener("message",e)},n.onclose.set=function(e){this.removeEventListener("close",this._onclose),this._onclose=e,this.addEventListener("close",e)},n.onerror.set=function(e){this.removeEventListener("error",this._onerror),this._onerror=e,this.addEventListener("error",e)},t.prototype.send=function(e){var n=this;if(this.readyState===t.CONNECTING)throw new Error("Failed to execute 'send' on 'WebSocket': Still in CONNECTING state");var r=U({type:"server::message",origin:this.url,data:G(e)}),o=M.serverLookup(this.url);o&&b((function(){n.dispatchEvent(r,e)}),o)},t.prototype.close=function(e,n){if(void 0!==e&&("number"!=typeof e||1e3!==e&&(e<3e3||e>4999)))throw new TypeError(P.CLOSE_ERROR+" The code must be either 1000, or between 3000 and 4999. "+e+" is neither.");if(void 0!==n&&(r=n,o=encodeURIComponent(r).match(/%[89ABab]/g),r.length+(o?o.length:0)>123))throw new SyntaxError(P.CLOSE_ERROR+" The message must not be greater than 123 bytes.");var r,o;if(this.readyState!==t.CLOSING&&this.readyState!==t.CLOSED){var s=J(this);this.readyState===t.CONNECTING?function(e,t,n){e.readyState=B.CLOSING;var r=M.serverLookup(e.url),o=K({type:"close",target:e.target,code:t,reason:n,wasClean:!1}),s=D({type:"error",target:e.target});b((function(){M.removeWebSocket(e,e.url),e.readyState=B.CLOSED,e.dispatchEvent(s),e.dispatchEvent(o),r&&r.dispatchEvent(o,r)}),e)}(s,e||I,n):W(s,e||L,n)}},Object.defineProperties(t.prototype,n),t}(C);B.CONNECTING=0,B.prototype.CONNECTING=B.CONNECTING,B.OPEN=1,B.prototype.OPEN=B.OPEN,B.CLOSING=2,B.prototype.CLOSING=B.CLOSING,B.CLOSED=3,B.prototype.CLOSED=B.CLOSED;var V=function(e){function t(n,r){var o=this;void 0===n&&(n="socket.io"),void 0===r&&(r=""),e.call(this),this.binaryType="blob";var s=new E(n);s.pathname||(s.pathname="/"),this.url=s.toString(),this.readyState=t.CONNECTING,this.protocol="",this.target=this,"string"==typeof r||"object"==typeof r&&null!==r?this.protocol=r:Array.isArray(r)&&r.length>0&&(this.protocol=r[0]);var i=M.attachWebSocket(this,this.url);b((function(){i?(this.readyState=t.OPEN,i.dispatchEvent(D({type:"connection"}),i,this),i.dispatchEvent(D({type:"connect"}),i,this),this.dispatchEvent(D({type:"connect",target:this}))):(this.readyState=t.CLOSED,this.dispatchEvent(D({type:"error",target:this})),this.dispatchEvent(K({type:"close",target:this,code:N})),k("error","Socket.io connection to '"+this.url+"' failed"))}),this),this.addEventListener("close",(function(e){o.dispatchEvent(K({type:"disconnect",target:e.target,code:e.code}))}))}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={broadcast:{}};return t.prototype.close=function(){if(this.readyState===t.OPEN){var e=M.serverLookup(this.url);return M.removeWebSocket(this,this.url),this.readyState=t.CLOSED,this.dispatchEvent(K({type:"close",target:this,code:N})),e&&e.dispatchEvent(K({type:"disconnect",target:this,code:N}),e),this}},t.prototype.disconnect=function(){return this.close()},t.prototype.emit=function(e){for(var n=[],r=arguments.length-1;r-- >0;)n[r]=arguments[r+1];if(this.readyState!==t.OPEN)throw new Error("SocketIO is already in CLOSING or CLOSED state");var o=U({type:e,origin:this.url,data:n}),s=M.serverLookup(this.url);return s&&s.dispatchEvent.apply(s,[o].concat(n)),this},t.prototype.send=function(e){return this.emit("message",e),this},n.broadcast.get=function(){if(this.readyState!==t.OPEN)throw new Error("SocketIO is already in CLOSING or CLOSED state");var e=this,n=M.serverLookup(this.url);if(!n)throw new Error("SocketIO can not find a server at the specified URL ("+this.url+")");return{emit:function(t,r){return n.emit(t,r,{websockets:M.websocketsLookup(e.url,null,e)}),e},to:function(t){return n.to(t,e)},in:function(t){return n.in(t,e)}}},t.prototype.on=function(e,t){return this.addEventListener(e,t),this},t.prototype.off=function(e,t){this.removeEventListener(e,t)},t.prototype.hasListeners=function(e){var t=this.listeners[e];return!!Array.isArray(t)&&!!t.length},t.prototype.join=function(e){M.addMembershipToRoom(this,e)},t.prototype.leave=function(e){M.removeMembershipFromRoom(this,e)},t.prototype.to=function(e){return this.broadcast.to(e)},t.prototype.in=function(){return this.to.apply(null,arguments)},t.prototype.dispatchEvent=function(e){for(var t=this,n=[],r=arguments.length-1;r-- >0;)n[r]=arguments[r+1];var o=e.type,s=this.listeners[o];if(!Array.isArray(s))return!1;s.forEach((function(r){n.length>0?r.apply(t,n):r.call(t,e.data?e.data:e)}))},Object.defineProperties(t.prototype,n),t}(C);V.CONNECTING=0,V.OPEN=1,V.CLOSING=2,V.CLOSED=3;var z=function(e,t){return new V(e,t)};z.connect=function(e,t){return z(e,t)};function F(){return"undefined"!=typeof window?window:"object"==typeof r&&"object"==typeof n.g?n.g:this}var H={mock:!0,verifyClient:null,selectProtocol:null},$=function(e){function t(t,n){void 0===n&&(n=H),e.call(this);var r=new E(t);if(r.pathname||(r.pathname="/"),this.url=r.toString(),this.originalWebSocket=null,!M.attachServer(this,this.url))throw this.dispatchEvent(D({type:"error"})),new Error("A mock server is already listening on this url");this.options=Object.assign({},H,n),this.options.mock&&this.mockWebsocket()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.mockWebsocket=function(){var e=F();this.originalWebSocket=e.WebSocket,e.WebSocket=B},t.prototype.restoreWebsocket=function(){var e=F();null!==this.originalWebSocket&&(e.WebSocket=this.originalWebSocket),this.originalWebSocket=null},t.prototype.stop=function(e){void 0===e&&(e=function(){}),this.options.mock&&this.restoreWebsocket(),M.removeServer(this.url),"function"==typeof e&&e()},t.prototype.on=function(e,t){this.addEventListener(e,t)},t.prototype.off=function(e,t){this.removeEventListener(e,t)},t.prototype.close=function(e){void 0===e&&(e={});var t=e.code,n=e.reason,r=e.wasClean,o=M.websocketsLookup(this.url);M.removeServer(this.url),o.forEach((function(e){e.readyState=B.CLOSED,e.dispatchEvent(K({type:"close",target:e.target,code:t||N,reason:n||"",wasClean:r}))})),this.dispatchEvent(K({type:"close"}),this)},t.prototype.emit=function(e,t,n){var r=this;void 0===n&&(n={});var o,s=n.websockets;s||(s=M.websocketsLookup(this.url)),"object"!=typeof n||arguments.length>3?(t=Array.prototype.slice.call(arguments,1,arguments.length),o=t.map((function(e){return G(e)}))):o=G(t),s.forEach((function(n){var s=n instanceof V?t:o;Array.isArray(s)?n.dispatchEvent.apply(n,[U({type:e,data:s,origin:r.url,target:n.target})].concat(s)):n.dispatchEvent(U({type:e,data:s,origin:r.url,target:n.target}))}))},t.prototype.clients=function(){return M.websocketsLookup(this.url)},t.prototype.to=function(e,t,n){var r=this;void 0===n&&(n=[]);var o=this,s=n.concat(M.websocketsLookup(this.url,e,t)).reduce((function(e,t){return e.indexOf(t)>-1?e:e.concat(t)}),[]);return{to:function(e,t){return r.to.call(r,e,t,s)},emit:function(e,t){o.emit(e,t,{websockets:s})}}},t.prototype.in=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return this.to.apply(null,e)},t.prototype.simulate=function(e){var t=M.websocketsLookup(this.url);"error"===e&&t.forEach((function(e){e.readyState=B.CLOSED,e.dispatchEvent(D({type:"error",target:e.target}))}))},t}(C);$.of=function(e){return new $(e)};var Y=$,Z=B,Q=z;e.Server=Y,e.WebSocket=Z,e.SocketIO=Q,Object.defineProperty(e,"__esModule",{value:!0})}(t)},19326:(e,t,n)=>{"use strict";n.d(t,{Ui:()=>i,vw:()=>s});var r=n(97283),o=n(7282);const s=(0,r.y)(((e,t)=>({cells:new Map,source:"",outputsCount:0,adapter:void 0,areAllKernelSessionsReady:!1,isAnyCellExecuting:!1,setCells:t=>e((e=>({cells:t}))),setSource:(n,r)=>{const o=t().cells,s=o.get(n);s?s.source=r:o.set(n,{source:r}),e((e=>({cells:o})))},setOutputsCount:(n,r)=>{const o=t().cells,s=o.get(n);s?s.outputsCount=r:o.set(n,{outputsCount:r}),e((e=>({cells:o})))},setKernelSessionAvailable:(n,r)=>{const o=t().cells,s=o.get(n);s?s.isKernelSessionAvailable=r:o.set(n,{isKernelSessionAvailable:r});const i=(e=>{for(const t of e.values())if(!t.isKernelSessionAvailable)return!1;return!0})(o);e((e=>({cells:o,areAllKernelSessionsReady:i})))},setAdapter:(n,r)=>{const o=t().cells,s=o.get(n);s?s.adapter=r:o.set(n,{adapter:r}),e((e=>({cells:o})))},getAdapter:e=>t().cells.get(e)?.adapter,getSource:e=>t().cells.get(e)?.source,getOutputsCount:e=>t().cells.get(e)?.outputsCount,isKernelSessionAvailable:e=>t().cells.get(e)?.isKernelSessionAvailable,execute:e=>{const n=t().cells.get(e);n?n.adapter?.execute():t().cells.forEach((e=>e.adapter?.execute()))},setIsExecuting:(n,r)=>{const o=t().cells,s=o.get(n);s?s.isExecuting=r:(t().cells.forEach((e=>e.adapter?.execute())),o.set(n,{isExecuting:r}));const i=(e=>{for(const t of e.values())if(t.isExecuting)return!0;return!1})(o);e((e=>({cells:o,isAnyCellExecuting:i})))}})));function i(e){return(0,o.Pj)(s,e)}},37838:(e,t,n)=>{"use strict";n.d(t,{uJ:()=>L,zV:()=>I});var r=n(9387),o=n(97283),s=n(7282),i=n(97789),a=n(60548),c=n(98820),l=n(72490),u=n(18565),h=n(58264);class p{constructor(e){this._isDisposed=!1,this._serverSettings=e.serverSettings,this._stream=new l.Stream(this)}async emit({data:e,schema_id:t}){this._stream.emit({...e,schema_id:t})}dispose(){this.isDisposed||(this._isDisposed=!0,l.Signal.clearData(this),this._stream.stop())}get isDisposed(){return this._isDisposed}get stream(){return this._stream}get serverSettings(){return this._serverSettings}}class d extends c.l{constructor(e){var t;super(e),this.name="JupyterLite Server",this.namespace=this.name,this.version="unknown",this._router=new h.I;const n={...i.ServerConnection.makeSettings(),WebSocket:u.WebSocket,fetch:null!==(t=this.fetch.bind(this))&&void 0!==t?t:void 0};this._serviceManager=new i.ServiceManager({standby:"never",serverSettings:n,events:new p({serverSettings:n})})}get router(){return this._router}get serviceManager(){return this._serviceManager}async fetch(e,t){if(!(e instanceof Request))throw Error("Request info is not a Request");return this._router.route(e)}attachShell(e){}evtResize(e){}registerPluginModule(e){let t=e.default;Object.prototype.hasOwnProperty.call(e,"__esModule")||(t=e),Array.isArray(t)||(t=[t]),t.forEach((e=>{try{this.registerPlugin(e)}catch(e){console.error(e)}}))}registerPluginModules(e){e.forEach((e=>{this.registerPluginModule(e)}))}}var g=n(63711);const f=(e=!0)=>async function(){const e=[],t=await Promise.all([n.e(484),n.e(7176),n.e(9382)]).then(n.bind(n,49382));for(const n of function*(e){let t;t=e.hasOwnProperty("__esModule")?e.default:e;const n=Array.isArray(t)?t:[t];for(const e of n)g.PageConfig.Extension.isDisabled(e.id)?console.info(`JupyterLite plugin '${e.id}' has been disabled.`):yield e}(t))e.push(n);const r=new d({});return r.registerPluginModules(e),await r.start(),r}().then((async t=>{const r="boolean"==typeof e?await Promise.all([n.e(484),n.e(5378)]).then(n.bind(n,28924)):await e;let o=r.default;Object.prototype.hasOwnProperty.call(r,"__esModule")||(o=r),Array.isArray(o)||(o=[o]);const s=o.map((e=>{try{return t.registerPlugin(e),e.id}catch(e){return console.error(e),null}}));await Promise.all(s.filter((e=>e)).map((e=>t.activatePlugin(e))));const i=t.serviceManager;return i.__NAME__="LiteServiceManager",console.log("Lite Service Manager is created",i),i}));var v=n(42968),y=n(11444),m=n(42389),S=n(38921),w=n(98238),E=n(17402),b=n(36848);class k{_clientId;_connectionStatus;_id;_info;_kernelConnection;_kernelManager;_kernelName;_kernelSpecManager;_kernelSpecName;_kernelType;_path;_ready;_session;_sessionId;_sessionManager;constructor(e){const{kernelManager:t,kernelName:n,kernelType:r,kernelspecsManager:o,kernelSpecName:s,kernelModel:i,path:a,sessionManager:c}=e;this._kernelSpecManager=o,this._kernelManager=t,this._kernelName=n,this._kernelType=r??"notebook",this._kernelSpecName=s,this._sessionManager=c,this._ready=new w.PromiseDelegate,this.requestKernel(i,a)}async requestKernel(e,t){if(await this._kernelManager.ready,await this._sessionManager.ready,e){await this._kernelManager.refreshRunning();const t=Array.from(this.kernelManager.running()),n=(0,S.find)(t,(t=>e.id===t.id));if(!n)return void console.log("Something is wrong... can not find an existing model for",e);{console.log("Creating a session to an existing Jupyter Kernel model.",n);const t="kernel-"+e.id;this._path=t,this._session=await this._sessionManager.startNew({name:n.name,path:t,type:"notebook",kernel:n},{kernelConnectionOptions:{handleComms:!0}})}}else{let e=t??(0,E.Ri)(this.cookieName);e||(e="path-"+(0,E.YG)(),document.cookie=this.cookieName+"="+e),this._path=e,this._session=await this._sessionManager.startNew({name:this._kernelName,path:this._path,type:this._kernelType,kernel:{name:this._kernelSpecName}},{kernelConnectionOptions:{handleComms:!0}})}this._kernelConnection=this._session.kernel;const n=()=>{"connected"===this._connectionStatus&&(this._clientId=this._session.kernel.clientId,this._id=this._session.kernel.id,this._ready.resolve())};this._kernelConnection&&(this._sessionId=this._session.id,this._connectionStatus=this._kernelConnection.connectionStatus,n(),this._kernelConnection.connectionStatusChanged.connect(((e,t)=>{this._connectionStatus=t,n()})),this._kernelConnection.info.then((e=>{this._info=e,console.log("Kernel Information.",e),console.log("Kernel Session.",this._session),console.log("Kernel Details.",this.toJSON())})))}get clientId(){return this._clientId}get connection(){return this._kernelConnection}get cookieName(){return"jupyter-react-kernel-path_"+this._kernelSpecName}get id(){return this._id}get info(){return this._info}get kernelManager(){return this._kernelManager}get kernelSpecManager(){return this._kernelSpecManager}get path(){return this._path}get ready(){return this._ready.promise}get sessionId(){return this._sessionId}get session(){return this._session}get sessionManager(){return this._sessionManager}execute(e,{model:t,iopubMessageHooks:n=[],shellMessageHooks:r=[],silent:o,stopOnError:s,storeHistory:i,allowStdin:a,suppressCodeExecutionErrors:c=!1,onExecutionPhaseChanged:l}={}){if(this._kernelConnection){const u=new b.A({connection:this._kernelConnection,model:t,onExecutionPhaseChanged:l});return u.execute(e,{iopubMessageHooks:n,shellMessageHooks:r,silent:o,stopOnError:s,storeHistory:i,allowStdin:a,suppressCodeExecutionErrors:c}),u}}interrupt(){return this._kernelConnection?.interrupt()??Promise.resolve()}restart(){return this._kernelConnection?.restart()??Promise.resolve()}async shutdown(){await(this._session.kernel?.shutdown()),this.connection?.dispose()}toJSON(){return{path:this._path,id:this.id,clientId:this.clientId,sessionId:this.sessionId,kernelInfo:this.info}}toString(){return`id:${this.id} - client_id:${this.clientId} - session_id:${this.sessionId} - path:${this._path}`}}var _=n(19326);const C=(0,o.y)(((e,t)=>({outputs:0,adapter:void 0,execute:()=>{},setOutputs:t=>e((e=>({outputs:t}))),setAdapter:t=>e((e=>({adapter:t})))})));var O=n(16476),R=n(55388);const M=(0,o.y)(((e,t)=>({dark:!1,adapter:void 0,setDark:t=>e((e=>({dark:t}))),setAdapter:t=>e((e=>({adapter:t})))})));let N;try{const e=document.getElementById("datalayer-config-data");e?.innerText&&(N=JSON.parse(e?.innerText))}catch(e){console.debug("Issue with page configuration.",e)}const L=(0,o.y)(((e,t)=>({collaborative:!1,datalayerConfig:N,version:"",jupyterConfig:void 0,kernelIsLoading:!0,kernel:void 0,serviceManager:void 0,serverSettings:void 0,cellsStore:_.vw.getState(),consoleStore:C.getState(),notebookStore:O.Fg.getState(),outputStore:R.A4.getState(),terminalStore:M.getState(),setDatalayerConfig:t=>{e((e=>({datalayerConfig:t})))},setJupyterConfig:t=>{e((e=>({jupyterConfig:t})))},setServiceManager:t=>{e((e=>({serviceManager:t})))},setVersion:n=>{n&&!t().version&&e((e=>({version:n})))}})));function I(e){const{defaultKernelName:t=a.oH,initCode:n="",jupyterServerToken:o=e.serviceManager?.serverSettings.token??"",jupyterServerUrl:c=e.serviceManager?.serverSettings.baseUrl??"",lite:l=!1,serverless:u,serviceManager:h,startDefaultKernel:p=!1,terminals:d=!1,useRunningKernelId:g=e.useRunningKernelId,useRunningKernelIndex:S=e.useRunningKernelIndex||-1}=e,w=(0,r.useMemo)((()=>{const e=(0,y.CG)({lite:l,jupyterServerUrl:c,jupyterServerToken:o,terminals:d});return L.getState().setJupyterConfig(e),e}),[]),[E,b]=(0,r.useState)(h),[_,C]=(0,r.useState)(),[O,R]=(0,r.useState)(p||S>-1);return(0,r.useEffect)((()=>{h&&(console.log("Setting Service Manager from props",h),b(h),L.getState().setServiceManager(h))}),[h]),(0,r.useEffect)((()=>{if(u){const e=new m.Od;return b(e),void L.getState().setServiceManager(e)}if(!E){if(l)return void f(l).then((e=>{b(e),L.getState().setServiceManager(e)}));const e=(0,v.V9)(w.jupyterServerUrl,w.jupyterServerToken);(0,v.kA)(e).then((t=>{if(!t){const e=(0,y.G)()+"/login?next="+window.location;console.warn("You need to authenticate on the Jupyter Server URL",e)}if(g&&S>-1)throw new Error("You can not ask for useRunningKernelId and useRunningKernelIndex at the same time.");if(p&&(g||S>-1))throw new Error("You can not ask for startDefaultKernel and (useRunningKernelId or useRunningKernelIndex) at the same time.");const n=new i.ServiceManager({serverSettings:e});b(n),L.getState().setServiceManager(n)}))}}),[l,u,c]),(0,r.useEffect)((()=>{console.log("Checking kernels for the new Service Manager:",E),E?.kernels.ready.then((async()=>{const e=E.kernels;if(console.log("Jupyter Kernel Manager is ready",e),S>-1){await E.sessions.refreshRunning();const t=Array.from(e.running())[S],r=new k({kernelManager:e,kernelName:t.name,kernelSpecName:t.name,kernelModel:t,kernelspecsManager:E.kernelspecs,sessionManager:E.sessions});if(n)try{await(r.execute(n)?.done)}catch(e){console.error("Failed to execute the initial code",e)}C(r),L.getState().kernel=r,R(!1),L.getState().kernelIsLoading=!1}else if(p){console.log("Starting a Jupyter Kernel:",t);const r=new k({kernelManager:e,kernelName:t,kernelSpecName:t,kernelspecsManager:E.kernelspecs,sessionManager:E.sessions});r.ready.then((async()=>{if(n)try{await(r.execute(n)?.done)}catch(e){console.error("Failed to execute the initial code",e)}console.log("Jupyter Kernel is ready",r),C(r),L.getState().kernel=r,R(!1),L.getState().kernelIsLoading=!1}))}}))}),[E]),(0,s.Pj)(L)}},42968:(e,t,n)=>{"use strict";n.d(t,{V9:()=>p,kA:()=>h,PD:()=>u}),n(18683);var r=n(9387),o=n(97789),s=n(37838),i=n(63711);class a extends Error{}const c=a,l=(0,r.createContext)(void 0),u=(l.Consumer,l.Provider,e=>{const t=(0,r.useContext)(l);if(t)return t;const{jupyterConfig:n,kernel:o,kernelIsLoading:i,serviceManager:a}=(0,s.zV)(e??{});return{defaultKernel:o,jupyterServerUrl:n.jupyterServerUrl,kernel:o,kernelIsLoading:i,kernelManager:a?.kernels,lite:e?.lite,serverless:e?.serverless??!1,serverSettings:a?.serverSettings,serviceManager:a}}),h=async e=>{try{return await async function(e,t="api",n="",r={}){const s=i.URLExt.join(e.baseUrl,t,n);let a;try{if(a=await o.ServerConnection.makeRequest(s,r,e),403===a.status)throw new c}catch(e){throw new o.ServerConnection.NetworkError(e)}let l=await a.text();if(l.length>0)try{l=JSON.parse(l)}catch(e){console.warn("Not a JSON response body.",a)}if(!a.ok)throw new o.ServerConnection.ResponseError(a,l.message||l);return l}(e,"api",""),!0}catch(e){return console.log("The Jupyter Server API has failed with reason",e),!1}},p=(e,t)=>o.ServerConnection.makeSettings({baseUrl:e,wsUrl:e.replace(/^http/,"ws"),token:t,appendToken:!0,init:{mode:"cors",credentials:"include",cache:"no-store"}})},55388:(e,t,n)=>{"use strict";n.d(t,{A4:()=>s,LC:()=>i});var r=n(97283),o=n(7282);const s=(0,r.y)(((e,t)=>({outputs:new Map,getAdapter:e=>t().outputs.get(e)?.adapter,getInput:e=>t().outputs.get(e)?.input,getModel:e=>t().outputs.get(e)?.model,getDataset:e=>t().outputs.get(e)?.dataset,getExecuteRequest:e=>t().outputs.get(e)?.code,getGradeSuccess:e=>t().outputs.get(e)?.gradeSuccess,setOutputs:(t,n)=>e((e=>({outputs:n}))),setAdapter:(n,r)=>{const o=t().outputs,s=o.get(n);s?s.adapter=r:o.set(n,{adapter:r}),e((e=>({outputs:o})))},setDataset:(n,r)=>{const o=t().outputs,s=o.get(n);s?s.dataset=r:o.set(n,{dataset:r}),e((e=>({outputs:o})))},setExecuteRequest:(n,r)=>{const o=t().outputs,s=o.get(n);s?s.code=r:o.set(n,{code:r}),e((e=>({outputs:o})))},setModel:(n,r)=>{const o=t().outputs,s=o.get(n);s?s.model=r:o.set(n,{model:r}),e((e=>({outputs:o})))},setInput:(n,r)=>{const o=t().outputs,s=o.get(n);s?s.input=r:o.set(n,{input:r}),e((e=>({outputs:o})))},setGradeSuccess:(n,r)=>{const o=t().outputs,s=o.get(n);s?s.gradeSuccess=r:o.set(n,{gradeSuccess:r}),e((e=>({outputs:o})))}})));function i(e){return(0,o.Pj)(s,e)}},58264:(e,t,n)=>{"use strict";n.d(t,{I:()=>r});class r{constructor(){this._routes=[]}get(e,t){this._add("GET",e,t)}put(e,t){this._add("PUT",e,t)}post(e,t){this._add("POST",e,t)}patch(e,t){this._add("PATCH",e,t)}delete(e,t){this._add("DELETE",e,t)}async route(e){const t=new URL(e.url),{method:n}=e,{pathname:r}=t;for(const o of this._routes){if(o.method!==n)continue;const s=r.match(o.pattern);if(!s)continue;const i=s.slice(1);let a;if("PATCH"===o.method||"PUT"===o.method||"POST"===o.method)try{a=JSON.parse(await e.text())}catch{a=void 0}return o.callback.call(null,{pathname:r,body:a,query:Object.fromEntries(t.searchParams)},...i)}throw new Error("Cannot route "+e.method+" "+e.url)}_add(e,t,n){"string"==typeof t&&(t=new RegExp(t)),this._routes.push({method:e,pattern:t,callback:n})}}},98820:(e,t,n)=>{"use strict";n.d(t,{l:()=>i});var r=n(16950),o=n(98238),s=n(14809);class i{constructor(e){var t;this._delegate=new o.PromiseDelegate,this._started=!1,this._bubblingKeydown=!1,this.pluginRegistry=null!==(t=e.pluginRegistry)&&void 0!==t?t:new o.PluginRegistry(e),this.pluginRegistry.application=this,this.commands=new r.J,this.contextMenu=new s.tz({commands:this.commands,renderer:e.contextMenuRenderer}),this.shell=e.shell}get deferredPlugins(){return this.pluginRegistry.deferredPlugins}get started(){return this._delegate.promise}async activateDeferredPlugins(){await this.pluginRegistry.activatePlugins("defer")}async activatePlugin(e){return this.pluginRegistry.activatePlugin(e)}async deactivatePlugin(e){return this.pluginRegistry.deactivatePlugin(e)}deregisterPlugin(e,t){this.pluginRegistry.deregisterPlugin(e,t)}getPluginDescription(e){return this.pluginRegistry.getPluginDescription(e)}hasPlugin(e){return this.pluginRegistry.hasPlugin(e)}isPluginActivated(e){return this.pluginRegistry.isPluginActivated(e)}listPlugins(){return this.pluginRegistry.listPlugins()}registerPlugin(e){this.pluginRegistry.registerPlugin(e)}registerPlugins(e){this.pluginRegistry.registerPlugins(e)}async resolveOptionalService(e){return this.pluginRegistry.resolveOptionalService(e)}async resolveRequiredService(e){return this.pluginRegistry.resolveRequiredService(e)}async start(e={}){var t,n;if(this._started)return this._delegate.promise;this._started=!0,this._bubblingKeydown=null!==(t=e.bubblingKeydown)&&void 0!==t&&t;const r=null!==(n=e.hostID)&&void 0!==n?n:"";await this.pluginRegistry.activatePlugins("startUp",e),this.attachShell(r),this.addEventListeners(),this._delegate.resolve()}handleEvent(e){switch(e.type){case"resize":this.evtResize(e);break;case"keydown":this.evtKeydown(e);break;case"keyup":this.evtKeyup(e);break;case"contextmenu":this.evtContextMenu(e)}}attachShell(e){s.x0.attach(this.shell,e&&document.getElementById(e)||document.body)}addEventListeners(){document.addEventListener("contextmenu",this),document.addEventListener("keydown",this,!this._bubblingKeydown),document.addEventListener("keyup",this,!this._bubblingKeydown),window.addEventListener("resize",this)}evtKeydown(e){this.commands.processKeydownEvent(e)}evtKeyup(e){this.commands.processKeyupEvent(e)}evtContextMenu(e){e.shiftKey||this.contextMenu.open(e)&&(e.preventDefault(),e.stopPropagation())}evtResize(e){this.shell.update()}}}}]);