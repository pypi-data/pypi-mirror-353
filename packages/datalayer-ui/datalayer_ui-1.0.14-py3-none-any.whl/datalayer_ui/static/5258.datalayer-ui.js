"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[5258],{46916:(e,t,n)=>{n.d(t,{E:()=>l});var a=n(71791),s=n(99180),r=n(38621),i=n(9387),o=n(18683);function l(e){const{commandRegistry:t,runtimeDesc:n,save:l,sessionConnection:c}=e,[d,u]=(0,i.useState)();return(0,i.useEffect)((()=>{const e=()=>{u(c?.kernel?.status)};return e(),c?.statusChanged.connect(e),c?.connectionStatusChanged.connect(e),()=>{c?.statusChanged.disconnect(e),c?.connectionStatusChanged.disconnect(e)}}),[c]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.Q,{variant:"invisible",size:"small",leadingVisual:r.udU,disabled:!n?.location||"busy"===d,onClick:e=>t?.execute(a.nx.runAll),children:"Run all"}),(0,o.jsx)(s.Q,{variant:"invisible",size:"small",leadingVisual:r.wFz,disabled:!n?.location||"busy"!==d,onClick:e=>t?.execute(a.nx.interrupt),children:"Interrupt"})]})}},64991:(e,t,n)=>{n.d(t,{w:()=>i});var a=n(49370),s=n(320),r=n(63711);const i=(e="api/ai-agents/v1")=>{const{configuration:t}=(0,s._O)(),{requestRun:n}=(0,a.X)({notifyOnError:!1});return{createAIAgent:(a,s,i,o,l,{signal:c,baseUrl:d=e}={})=>n({url:r.URLExt.join(t.aiagentsRunUrl,d,"agents"),method:"POST",body:{room_id:a,room_type:s,runtime:{ingress:i,token:o,kernel_id:l}},signal:c}),getAIAgents:({signal:a,baseUrl:s=e}={})=>n({url:r.URLExt.join(t.aiagentsRunUrl,s,"agents"),method:"GET",signal:a}),deleteAIAgent:(a,{signal:s,baseUrl:i=e}={})=>n({url:r.URLExt.join(t.aiagentsRunUrl,i,"agents",a),method:"DELETE",signal:s}),getAIAgent:(a,{signal:s,baseUrl:i=e}={})=>n({url:r.URLExt.join(t.aiagentsRunUrl,i,"agents",a),method:"GET",signal:s}),patchAIAgent:(a,s,i,o,{signal:l,baseUrl:c=e}={})=>n({url:r.URLExt.join(t.aiagentsRunUrl,c,"agents",a),method:"PATCH",body:{runtime:s&&i&&o?{ingress:s,token:i,kernel_id:o}:null},signal:l})}}},81390:(e,t,n)=>{n.d(t,{Ks:()=>i});var a=n(97283),s=n(7282);const r=(0,a.y)((e=>({aiAgents:[],addAIAgent:t=>{e((e=>e.aiAgents.includes(t)?{}:{aiAgents:e.aiAgents.concat([t])}))},deleteAIAgent:t=>{e((e=>({aiAgents:e.aiAgents.filter((e=>e.documentId===t))})))},updateAIAgent:(t,n)=>{e((e=>{const a=e.aiAgents.findIndex((e=>e.documentId===t));return a>=0?(e.aiAgents[a].runtimeId=n,{aiAgents:[...e.aiAgents]}):{}}))}})));function i(e){return(0,s.Pj)(r,e)}},85258:(e,t,n)=>{n.r(t),n.d(t,{NotebookEdit:()=>at,default:()=>st});var a=n(9387),s=n(20568),r=n(97789),i=n(16950),o=n(3345),l=n(90537),c=n(99180),d=n(93054),u=n(48453),m=n(64315),p=n(24860),h=n(92243),g=n(3556),f=n(80006),x=n(38621),v=n(42389),b=n(16476),j=n(2159),y=n(5700),C=n(2606),k=n(72217),w=n(9403),S=n(18683);const A=e=>{const{data:t,fileName:n,variant:a,extension:s}=e;return(0,S.jsx)(c.Q,{variant:a,leadingVisual:x.s3U,onClick:e=>(0,w.xD)(t,n,s),children:"Download"})};A.defaultProps={variant:"default",name:"data",extension:"json"};var _=n(154),I=n(50596),N=n(88106),R=n(59179),T=n(5279),E=n(9175),D=n(98754),P=n(65047),M=n(80736),$=n(63948),U=n(43),L=n(50787),z=n(51857),V=function(e){return e[e.None=0]="None",e[e.New=1]="New",e[e.Transfer=2]="Transfer",e}(V||{});function O(e){const{assignKernel:t,sessionConnection:n}=e,{remoteKernels:s,multiServiceManager:r,jupyterLabAdapter:i}=(0,z.xb)(),[o,l]=(0,a.useState)(),[d,u]=(0,a.useState)({}),[m,p]=(0,a.useState)(V.None),[h,g]=(0,a.useState)("");(0,a.useEffect)((()=>{if(n){function e(e){g(`Runtime ${e.kernel?.connectionStatus} - Status: ${e.kernel?.status}`)}return e(n),n?.statusChanged.connect(e),n?.connectionStatusChanged.connect(e),()=>{n?.statusChanged.disconnect(e),n?.connectionStatusChanged.disconnect(e)}}g("No kernel")}),[n]);const f=(0,a.useCallback)((async()=>{r?.remote?.kernels&&await r.remote.kernels.refresh()}),[r?.remote?.kernels]),v=(0,a.useCallback)((()=>{p(V.New)}),[]),b=(0,a.useCallback)((e=>{if(e)switch(m){case V.New:f().then((()=>{l("remote"),t({runtimeDesc:e,kernelModel:r?.remote?.kernels.get().find((t=>t.id===e.id))})}));break;case V.Transfer:l("remote"),t({runtimeDesc:e,transferState:!0})}p(V.None)}),[f,r?.remote,m]);return(0,a.useEffect)((()=>{i?Promise.all([i.jupyterLab.resolveOptionalService(T.co),i.jupyterLab.resolveOptionalService(R.zG)]).then((e=>{u({[T.co.name]:e[0],[R.zG.name]:e[1]})})):u({})}),[i]),(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(E.W,{children:[(0,S.jsx)(E.W.Button,{leadingVisual:()=>{switch(o){case"browser":return(0,S.jsx)($.A,{});case"remote":return(0,S.jsx)(x.hpF,{});case void 0:return(0,S.jsx)(x.bMW,{})}return(0,S.jsx)(_.Cx,{type:"runtime"})},trailingVisual:()=>n?(0,S.jsx)(D.A,{sx:{paddingTop:"5px"},children:(0,S.jsx)(N.T1,{kernel:n.kernel})}):(0,S.jsx)(S.Fragment,{}),size:"small",variant:"invisible",children:(0,S.jsx)(P.m,{text:h,direction:"s",children:(0,S.jsx)(c.Q,{variant:"invisible",size:"small",children:n?.kernel?.name??"Runtimes"})})}),(0,S.jsx)(E.W.Overlay,{width:"medium",children:(0,S.jsxs)(M.l,{selectionVariant:"single",showDividers:!0,children:[(0,S.jsxs)(M.l.Group,{children:[(0,S.jsxs)(M.l.Item,{selected:void 0===o&&void 0===n,onSelect:()=>{l(void 0),t({runtimeDesc:void 0})},children:[(0,S.jsx)(M.l.LeadingVisual,{children:(0,S.jsx)(x.bMW,{})}),"Viewer",(0,S.jsx)(M.l.Description,{variant:"block",children:"A simple Notebook Viewer without Runtime."})]}),(0,S.jsxs)(M.l.Item,{selected:"browser"===o,onSelect:()=>{l("browser"),t({runtimeDesc:{name:"pyodide",location:"browser",language:"python"}})},children:[(0,S.jsx)(M.l.LeadingVisual,{children:(0,S.jsx)($.A,{})}),"Browser Runtime",(0,S.jsx)(M.l.Description,{variant:"block",children:"A Browser Runtime based on Pyodide."})]})]}),s.length>0&&(0,S.jsxs)(M.l.Group,{children:[(0,S.jsx)(M.l.GroupHeading,{children:"Cloud Runtimes"}),s.map((e=>(0,S.jsxs)(M.l.Item,{selected:n?.kernel?.id===e.id,onSelect:()=>{l("remote"),t({runtimeDesc:{name:e.environment_name,language:"",location:"remote",displayName:e.kernel_given_name,id:e.id,burningRate:e.burning_rate,podName:e.jupyter_pod_name},kernelModel:e})},children:[(0,S.jsx)(M.l.LeadingVisual,{children:(0,S.jsx)(_.Cx,{type:"runtime"})}),e.kernel_given_name,(0,S.jsx)(M.l.Description,{variant:"block",children:e.environment_name})]},e.id)))]}),(0,S.jsx)(M.l.Divider,{}),(0,S.jsxs)(M.l.Group,{children:[(0,S.jsxs)(M.l.Item,{selected:!1,onSelect:v,children:[(0,S.jsx)(M.l.LeadingVisual,{children:(0,S.jsx)(U.A,{})}),"Launch a new Runtime…"]}),(0,S.jsxs)(M.l.Item,{disabled:"browser"!==o,selected:!1,onSelect:()=>{p(V.Transfer)},title:"Transfer the state of the current Runtime to a new Remote Runtime.",children:[(0,S.jsx)(M.l.LeadingVisual,{children:(0,S.jsx)(x.e0J,{})}),"Transfer state to a new Runtime…"]})]})]})})]}),r?.remote&&m>0&&(0,S.jsx)(L.s,{dialogTitle:m===V.Transfer?"Switch to a new Cloud Runtime":void 0,manager:r.remote,onSubmit:b,markdownParser:d[T.co.name],sanitizer:d[R.zG.name],startKernel:m===V.Transfer?"defer":m===V.New})]})}var F=n(59651),W=n(46343),G=n(11471),K=n(48370),B=n(10680),Q=n(71623),H=n(97734),q=n(24991),J=n(47775),X=n(61783);function Y(e){const{children:t,connection:n,podName:s,multiServiceManager:r,disabled:i}=e,{addKernelSnapshot:o,jupyterRunUrl:l,kernelSnapshots:c,setKernelSnapshots:d}=(0,z.xb)(),{trackAsyncTask:u}=(0,H.d)(),[p,h]=(0,a.useState)(!1),[g,f]=(0,a.useState)(!1),[x,v]=(0,a.useState)(!1),[b,j]=(0,a.useState)(c[0]?.id??""),[y,C]=(0,a.useState)();(0,a.useEffect)((()=>{(0,q.v2)().then((e=>{d(e),!b&&e.length>0&&j(e[0].id)})).catch((e=>{console.error(`Failed to fetch remote kernel snapshots; ${e}`)}))}),[l]);const k=(0,a.useCallback)((()=>{C(void 0),h(!0)}),[]),w=(0,a.useCallback)((e=>{j(e.target.value)}),[]),A=(0,a.useCallback)((async({id:e,connection:t,podName:n})=>{n?await(0,q.Wm)({id:n,from:e}):t&&await(0,J.M)({connection:t,id:e})}),[]),_=(0,a.useCallback)((async()=>{try{let e,t;v(!0);let a="",i="";if(s&&r?.remote)i=(0,X.m)("cloud"),t=r.remote.kernels.snapshot({podName:s,name:i,description:i,stop:!1}),a=s.split("-",2).reverse()[0],t.then((t=>{e=t}));else if(n&&r?.browser){const s=n.model;a=s.id,i=(0,X.m)("browser");let o=!0;t=(0,J._)({connection:r.browser.kernels.connectTo({model:s}),metadata:{filename:`${i}.data`},onUploadProgress:()=>{o&&(o=!1,(0,q.v2)().then((t=>{e=t.find((e=>e.name===i))})))}})}t&&(u(t,{error:{message:(e,t)=>"Empty snapshot"===e?`Runtime ${a} will not be snapshotted as it does not contain any serializable state.`:`Failed to pause runtime ${a} - ${e}`},pending:{message:`Taking a snapshot of runtime ${a}…`},success:{message:()=>`Runtime ${a} successfully snapshotted as ${i}.`}}),await t,e&&o(e))}finally{v(!1)}}),[n,s,r]);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(E.W,{children:[(0,S.jsx)(E.W.Button,{leadingVisual:W.A,variant:"invisible",size:"small",disabled:g||x||i,children:t}),(0,S.jsx)(E.W.Overlay,{children:(0,S.jsxs)(M.l,{children:[(0,S.jsx)(M.l.Item,{onSelect:k,disabled:g||0===c.length,children:"Load a runtime snapshot…"}),(0,S.jsx)(M.l.Item,{onSelect:_,disabled:x,children:"Take a runtime snapshot"})]})})]}),p&&(0,S.jsx)(Q.l,{title:"Choose a runtime snapshot to load",onClose:()=>{h(!1)},footerButtons:[{buttonType:"default",content:"Cancel",onClick:e=>{e.defaultPrevented||(e.preventDefault(),h(!1))}},{buttonType:"primary",content:g?(0,S.jsx)(G.A,{size:"small"}):"Load",disabled:g,onClick:async e=>{if(!e.defaultPrevented){e.preventDefault(),f(!0);try{C(void 0);const e=c.find((e=>e.id===b));e&&(n||s)?await A({connection:n,id:e.id,podName:s}):C("No runtime snapshot found.")}finally{f(!1),h(!1)}}},autoFocus:!0}],children:(0,S.jsxs)(D.A,{as:"form",children:[(0,S.jsxs)(m.A,{children:[(0,S.jsx)(m.A.Label,{children:"Snapshot"}),(0,S.jsx)(K.A,{name:"snapshot",value:b,onChange:w,block:!0,children:c.map((e=>(0,S.jsx)(K.A.Option,{value:e.id,children:e.name?`${e.name} (${e.id})`:e.id},e.id)))})]}),y&&(0,S.jsx)(B.A,{variant:"danger",children:y})]})})]})}Y.defaultProps={disabled:!1};var Z=n(63711),ee=n(98238),te=n(58875),ne=n(82864),ae=n(8222),se=n(48461),re=n(55285),ie=n(2381);function oe(e,t){let n=e.map((e=>({...e,fileType:t?.getFileTypeForModel(e)})));return n=n.filter((e=>!e.name.startsWith("."))),n.sort(((e,t)=>"directory"===e.type&&"directory"!==t.type?-1:"directory"!==e.type&&"directory"===t.type?1:e.name.localeCompare(t.name))),n}function le(e){const{item:t,contents:n,current:s,documentRegistry:r,onContextMenu:i,onSelect:o}=e,l=(0,a.useRef)(null),[c,d]=(0,a.useState)(null),[u,m]=(0,a.useState)(!1),p=(0,a.useCallback)((()=>{m(!0),n.get(t.path).then((e=>{m(!1),d(oe(e.content,r))})).catch((()=>{m(!1)}))}),[n,t,r]),h=(0,a.useCallback)((async e=>{null===c&&e&&p()}),[c,t,n]);return(0,S.jsxs)(ne.G.Item,{ref:l,id:`${t.type}-${t.name}`,onExpandedChange:h,onSelect:()=>{o(t,p)},current:t.path===s?.path,children:[(0,S.jsx)(ne.G.LeadingVisual,{children:(0,S.jsx)(ne.G.DirectoryIcon,{})}),(0,S.jsx)("span",{onContextMenu:e=>{e.preventDefault(),s?.path!==t.path&&o(t,p),i(l)},children:t.name}),(0,S.jsx)(ne.G.SubTree,{state:u?"loading":(c?.length??-1)>=0?"done":"initial",children:c?.map((e=>"directory"===e.type?(0,S.jsx)(le,{item:e,contents:n,current:s,documentRegistry:r,onContextMenu:i,onSelect:o},e.name):(0,S.jsx)(ce,{item:e,current:e.path===s?.path,onSelect:e=>o(e,p),onContextMenu:i},e.name)))})]})}function ce(e){const{item:t,current:n,onSelect:s,onContextMenu:r}=e,i=(0,a.useRef)(null),o=t.fileType?.icon;return(0,S.jsxs)(ne.G.Item,{ref:i,id:`${t.type}-${t.name}`,current:n,onSelect:()=>{s(t)},children:[(0,S.jsx)(ne.G.LeadingVisual,{children:o?(0,S.jsx)(o.react,{tag:"span"}):(0,S.jsx)(x.oSV,{})}),(0,S.jsx)("span",{onContextMenu:e=>{e.preventDefault(),n||s(t),r(i)},children:t.name})]},t.name)}const de=1048576;function ue(e){const{contents:t,localContents:n,documentRegistry:s}=e,r=(0,re.aq)(),{trackAsyncTask:i}=(0,H.d)(),[o,l]=(0,a.useState)(null),[c,d]=(0,a.useState)(!0),[u,m]=(0,a.useState)(null),[p,h]=(0,a.useState)(null),[f,x]=(0,a.useState)(!1),[v,b]=(0,a.useState)(!1),j=(0,a.useCallback)((()=>{t.get("").then((e=>{d(!1),l(oe(e.content,s))})).catch((e=>{d(!1),console.error(`Failed to fetch folder '' content for manager ${t.serverSettings.appUrl}.`,e)}))}),[t]);(0,a.useEffect)((()=>{j()}),[j]);const y=(0,a.useCallback)((async e=>{const n=()=>{if(!r())return Promise.reject(`Failed to upload ${e.name}; StorageBrowser component is unmounted.`)};n();const a=e.size>de,s=u?"directory"===u.type?u.path:Z.PathExt.dirname(u.path):"",o=s?Z.PathExt.join(s,e.name):e.name,l=e.name,c=async(a,s)=>{n();const r=new FileReader;r.readAsDataURL(a),await new Promise(((t,n)=>{r.onload=t,r.onerror=t=>n(`Failed to upload "${e.name}":`+t)})),n();const i=r.result.split(",")[1],c={type:"file",format:"base64",name:l,chunk:s,content:i};return await t.save(o,c)},d={error:{message:t=>{const n=`Failed to upload ${e.name}.`;return console.error(n,t),n}},pending:{message:`Uploading ${e.name}…`},success:{message:()=>`${e.name} uploaded.`}};if(!a){const t=c(e);return i(t,d),t.then((()=>{u?u.refresh():j()})),t}{const t=new ee.PromiseDelegate;i(t.promise,d);try{let n;for(let a=0;!n;a+=de){const s=a+de,r=s>=e.size,i=r?-1:s/de,o=await c(e.slice(a,s),i);r&&(n=o,t.resolve(n))}return u?u.refresh():j(),n}catch(e){throw t.reject(e),e}}}),[t,u,j]),C=(0,a.useCallback)((e=>{h(p===e?null:e)}),[p]),k=(0,a.useCallback)((()=>{x(!0)}),[]),w=(0,a.useCallback)((()=>{if(u){const e=t.delete(u.path);i(e,{success:{message:()=>`${u.path} deleted.`},pending:{message:`Deleting ${u.path}…`},error:{message:e=>{const t=`Failed to delete ${u.path}.`;return console.error(t,e),t}}}),e.finally((()=>{u.refresh()}))}x(!1)}),[t,u]),A=(0,a.useCallback)((()=>{b(!0)}),[]),_=(0,a.useCallback)((()=>{u&&n&&t.get(u.path).then((e=>{const t=n?.save(e.path,e);i(t,{success:{message:()=>`${u.path} copied to local.`},pending:{message:`Copying to local ${u.path}…`},error:{message:e=>{const t=`Failed to copy to local ${u.path}.`;return console.error(t,e),t}}}),t.finally((()=>{u.refresh()})),b(!1)}))}),[n,u]),I=(0,a.useCallback)(((e,t)=>{m(e.path===u?.path?null:{...e,refresh:t})}),[u]);return(0,S.jsxs)(D.A,{sx:{display:"grid",gridTemplateAreas:'"header" "content"'},children:[(0,S.jsxs)(D.A,{sx:{gridArea:"header",display:"flex",alignItems:"center"},children:[(0,S.jsx)(g.A,{as:"h4",sx:{fontSize:"var(--text-title-size-small)",lineHeight:"var(--text-title-lineHeight-medium)",fontWeight:"var(--text-title-weight-medium)",flex:"1 1 auto"},children:"Contents Browser"}),(0,S.jsxs)(D.A,{children:[(0,S.jsx)(te.K,{variant:"invisible","aria-label":"Refresh contents browser.",title:"Refresh contents browser.",icon:se.A,onClick:j}),(0,S.jsx)(ie.HF,{label:"Upload a file",multiple:!0,upload:y})]})]}),c?(0,S.jsx)(D.A,{sx:{gridArea:"content",display:"flex",alignItems:"center",justifyContent:"center",minHeight:"40px",height:"100vh"},children:(0,S.jsx)(G.A,{})}):(0,S.jsx)(D.A,{sx:{gridArea:"content"},children:o?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ne.G,{children:o?.map((e=>(e.fileType,"directory"===e.type?(0,S.jsx)(le,{item:e,contents:t,current:u,documentRegistry:s,onContextMenu:C,onSelect:I},e.name):(0,S.jsx)(ce,{item:e,current:u?.path===e.path,onSelect:e=>{I(e,j)},onContextMenu:C},e.name))))}),(0,S.jsx)(E.W,{anchorRef:p??void 0,open:null!==p?.current,onOpenChange:()=>{h(null)},children:(0,S.jsx)(E.W.Overlay,{children:(0,S.jsxs)(M.l,{children:[(0,S.jsx)(M.l.Item,{title:"Delete the active item.",onSelect:k,children:"Delete…"}),n&&(0,S.jsx)(M.l.Item,{title:"Copy the active item to the local drive.",onSelect:A,children:"Copy to local drive…"})]})})}),f&&(0,S.jsx)(Q.l,{title:"Confirm deletion",onClose:()=>{x(!1)},footerButtons:[{buttonType:"default",content:"Cancel",onClick:()=>{x(!1)}},{buttonType:"danger",content:"Delete",onClick:()=>{w()}}],children:`Are you sure you want to delete ${u?.path}?`}),v&&(0,S.jsx)(Q.l,{title:"Confirm copy to local",onClose:()=>{b(!1)},footerButtons:[{buttonType:"default",content:"Cancel",onClick:()=>{b(!1)}},{buttonType:"danger",content:"Copy to local",onClick:()=>{_()}}],children:`Are you sure you want to copy to local ${u?.path}?`})]}):(0,S.jsx)(ae.E,{children:(0,S.jsx)(ae.E.Heading,{children:"No contents"})})})]})}var me=n(46916),pe=n(77108),he=n(77606),ge=n(10815),fe=n(68822);const xe=28,ve="DatalayerSpacer",be=3e4;var je=function(e){return e.PROGRESS="var(--borderColor-accent-emphasis)",e.ERROR="var(--borderColor-danger-emphasis)",e.SUCCESS="var(--borderColor-success-emphasis)",e}(je||{});const ye={"-1":je.ERROR,0:je.PROGRESS,1:je.SUCCESS};function Ce({awareness:e,currentUserHandle:t}){const[n,s]=(0,a.useState)([]);return(0,a.useEffect)((()=>{const n=()=>{const n=e.getStates();s(Array.from(n.values()).filter((e=>e.user&&e.user?.name!==t&&!(e.user?.agent??"").startsWith(ve))).reduce(((e,t)=>{const n=t.user,a=!((t.notification?.timestamp??0)+be<Date.now()),s=n.agent?{avatarUrl:"https://static.vecteezy.com/system/resources/previews/006/662/139/large_2x/artificial-intelligence-ai-processor-chip-icon-symbol-for-graphic-design-logo-web-site-social-media-mobile-app-ui-illustration-free-vector.jpg",color:n.color,displayName:n.agent,handle:"agent",initials:"AI",username:n.agent,notification:a?`${t.notification?.message} ${(0,ge.g)(new Date(t.notification.timestamp))}`:void 0,notificationType:a&&void 0!==t.notification?.message_type?ye[t.notification?.message_type.toString()]:void 0}:{avatarUrl:n.avatar_url,color:n.color,displayName:n.display_name,handle:n.name,initials:n.initials,username:n.username};return e.map((e=>e.username)).includes(s.username)||e.push(s),e}),[]))};n(),e.on("change",n);const a=setInterval(n,be/3);return()=>{clearInterval(a),e.off("change",n)}}),[e,t]),(0,S.jsx)(pe.A,{children:n.map((e=>{let t=`${e.displayName}\n${e.handle}`;return e.notification&&(t+=`\n${e.notification}`),(0,S.jsx)(he.A,{sx:{border:e.notificationType?`var(--borderWidth-thick) solid ${e.notificationType}`:"none"},title:t,src:e.avatarUrl?(0,fe.$K)(e.avatarUrl):(n=e.color,a=e.initials,"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="12" fill="${n}" stroke="none" /><text x="12" y="12" fill="black">${a}</text></svg>`)),size:xe},e.displayName);var n,a}))})}var ke=n(17810),we=n(23530),Se=n(81390),Ae=n(64991);var _e=n(48716),Ie=n(54087),Ne=n(320),Re=n(44536),Te=n(27199),Ee=n(97283),De=n(7282);const Pe=(0,Ee.y)(((e,t)=>({datasources:[],updateDatasources:t=>e((e=>({datasources:t})))})));function Me(e){return(0,De.Pj)(Pe,e)}var $e=n(48315),Ue=n(88037),Le=n(41630);function ze(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ve extends Ue._Q{constructor(e){super(),ze(this,"_rows",void 0),ze(this,"_mimeType",void 0),this._mimeType=e.mimeType,this._rows=[]}renderModel(e){const t=e.data[this._mimeType].split("\n").map((e=>e.split(";")));return this._rows=t,Promise.resolve()}render(){return 0===(this._rows.length>0?this._rows[0].length:0)?(0,S.jsx)("div",{children:"No data found!"}):(0,S.jsx)(Le.NP,{children:this._rows.map((e=>(0,S.jsx)(D.A,{mt:3,children:e})))})}}const Oe={safe:!0,mimeTypes:["application/vnd.datalayer.csv"],createRenderer:e=>new Ve(e)};var Fe=n(66741),We=n(25344),Ge=n(14809),Ke=n(17310),Be=n(16181);function Qe(e){const{createAIAgent:t}=(0,Ae.w)(),{aiAgents:n,addAIAgent:s}=(0,Se.Ks)(),{cell:r,extensionProps:i}=e,{notebookId:o}=i,[l,d]=(0,a.useState)(!1),[u,p]=(0,a.useState)(),[g,f]=(0,a.useState)({prompt:""}),[v,b]=(0,a.useState)({prompt:void 0});(0,a.useEffect)((()=>{const e=(e,t)=>{if("datalayer"===t.key&&u)for(const e of r.model.sharedModel.getMetadata("datalayer")?.ai?.messages??[])if(e.parent_id===u){p(void 0);break}};return r.model.sharedModel.metadataChanged.connect(e),()=>{r.model?.sharedModel.metadataChanged.disconnect(e)}}),[r,u]),(0,a.useEffect)((()=>{u||d(!1)}),[u]),(0,a.useEffect)((()=>{b({...v,prompt:void 0===g.prompt?void 0:g.prompt.length>0})}),[g]);const j=(0,a.useCallback)((async()=>{const e=i.panel.context.sessionContext.session?.kernel,a=e?.serverSettings,l=e?.id;n.find((e=>e.documentId===o&&e.runtimeId===l))||(await t(o,"notebook_persist",a?.baseUrl,a?.token,l),s({documentId:o,runtimeId:l}));const c=(0,Be.f)();!function(e,t,n){const a=e.model.getMetadata("datalayer")??{},s=a.ai??{prompts:[],messages:[]},r=s.prompts??[];r.push({id:t,prompt:n,username:void 0,timestamp:Date.now()}),s.prompts=r,a.ai=s,e.model.setMetadata("datalayer",a)}(r,c,g.prompt),p(c)}),[n,r,i.panel.context.sessionContext.session?.kernel,g.prompt,o,t]),y=(0,a.useCallback)((e=>{e.ctrlKey&&"Enter"===e.key&&j()}),[j]);return(0,S.jsx)(Le.NP,{children:(0,S.jsx)(D.A,{display:"flex",style:{justifyContent:"right"},children:(0,S.jsx)(D.A,{className:"dla-Cell-ai-agent-button",children:(0,S.jsxs)(E.W,{open:l,onOpenChange:e=>d(e),children:[(0,S.jsx)(E.W.Anchor,{id:"custom-anchor-id",children:(0,S.jsx)(te.K,{icon:x.SD8,variant:"invisible","aria-label":"AI Agents menu"})}),(0,S.jsx)(E.W.Overlay,{width:"large",children:(0,S.jsxs)(D.A,{as:"form",m:3,children:[(0,S.jsxs)(m.A,{children:[(0,S.jsx)(m.A.Label,{visuallyHidden:!0}),(0,S.jsx)(h.Ay,{block:!0,value:g.prompt,onChange:e=>{f((t=>({...t,prompt:e.target.value})))},disabled:!!u,onKeyDown:y})]}),(0,S.jsxs)(D.A,{sx:{display:"flex",width:"100%",gap:"2px",marginTop:"var(--stack-gap-normal)"},children:[(0,S.jsx)(D.A,{flexGrow:1}),(0,S.jsx)(c.Q,{onClick:e=>d(!1),variant:"default",children:"Cancel"}),(0,S.jsx)(c.Q,{leadingVisual:Ke.A,onClick:j,disabled:!v.prompt||!!u,variant:"primary",children:u?(0,S.jsx)(G.A,{size:"small"}):"Ask AI"})]})]})})]})})})})}var He=n(94247);const qe=e=>{const{cell:t}=e,{datasources:n}=Me(),[s,r]=(0,a.useState)(),[i,o]=(0,a.useState)("df");(0,a.useEffect)((()=>{const e=(e,t)=>{if("datalayer"===(t?.key??"datalayer")){const t=(e=>{const t=e.getMetadata("datalayer");if(t){const e=t.datasource;if(e)return e.id}})(e);if(t)for(const e of n)if(t===e.id){r(t);break}}};return e(t.model),t.model.metadataChanged.connect(e),()=>{t.model?.metadataChanged.disconnect(e)}}),[t,n]);const l=e=>{const n=t.model.getMetadata("datalayer");e?(t.model.setMetadata("datalayer",{...n,sql:!0,datasource:{id:e.id,variant:e.variant,name:e.name,description:e.description,database:e.database,outputBucket:e.outputBucket,destinationVar:i??"df"}}),r(e.id),t.editor.model.mimeType=He.bd):(t.model.setMetadata("datalayer",{...n,sql:!1,datasource:{}}),r(void 0),t.editor.model.mimeType=He.dC)};return(0,S.jsx)(Le.NP,{children:(0,S.jsx)(I.a,{display:"flex",style:{justifyContent:"right"},children:(0,S.jsx)(I.a,{className:"dla-Cell-datasource-button",children:(0,S.jsxs)(E.W,{children:[(0,S.jsx)(E.W.Anchor,{id:"custom-anchor-id",children:(0,S.jsx)(te.K,{icon:x.bN0,variant:"invisible","aria-label":"Open Datasources menu"})}),(0,S.jsx)(E.W.Overlay,{width:"medium",children:(0,S.jsx)(M.l,{selectionVariant:"single",showDividers:!0,children:(0,S.jsxs)(M.l.Group,{children:[(0,S.jsx)(M.l.GroupHeading,{children:"Datasources"}),0===n.length&&(0,S.jsxs)(M.l.Item,{onSelect:()=>{},children:["No Datasource available",(0,S.jsx)(M.l.Description,{variant:"block",children:"Create a new Datasource to connect your cell."})]}),n.map((e=>(0,S.jsxs)(M.l.Item,{onSelect:()=>l(e),selected:e.id===s,children:[e.name,(0,S.jsx)(M.l.Description,{variant:"block",children:e.description})]},e.id))),(0,S.jsx)(M.l.Divider,{}),(0,S.jsx)(M.l.Item,{onSelect:e=>{e.preventDefault()},children:(0,S.jsxs)(m.A,{children:[(0,S.jsx)(m.A.Label,{children:"Destination variable"}),(0,S.jsx)(p.A,{size:"small",value:i,disabled:!s,onChange:e=>(e=>{o(e);const n=t.model.getMetadata("datalayer");t.model.setMetadata("datalayer",{...n,sql:!0,datasource:{...n.datasource,destinationVar:e??"df"}})})(e.target.value)})]})}),(0,S.jsx)(M.l.Divider,{}),(0,S.jsx)(M.l.Item,{variant:"danger",onSelect:()=>l(void 0),children:"None"})]})})})]})})})})};function Je(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Xe="dla-CellToolbar-Container";class Ye extends Ue._Q{constructor(e,t){super(),Je(this,"_cell",void 0),Je(this,"_props",void 0),this._cell=e,this._props=t,this.addClass(Xe)}render(){return(0,S.jsxs)(I.a,{display:"flex",children:[(0,S.jsx)(I.a,{flexGrow:1}),(0,S.jsxs)(s.fS,{initialEntries:["/"],children:[(0,S.jsx)(s.BV,{children:(0,S.jsx)(s.qh,{path:"*",element:(0,S.jsx)(Qe,{cell:this._cell,extensionProps:this._props})})}),(0,S.jsx)(qe,{cell:this._cell,extensionProps:this._props})]})]})}}function Ze(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class et extends Ge.x0{constructor(e,t){super(),Ze(this,"_panel",void 0),Ze(this,"_props",void 0),this._panel=e,this._props=t,this.updateConnectedCell=this.updateConnectedCell.bind(this);const n=()=>{const e=this._panel.content.model?.cells;if(e){e.changed.connect(this.updateConnectedCell);for(let t=0;t<e.length;++t)this._registerCellChanges(e.get(t))}};n(),this._panel.content.modelChanged.connect((()=>{n()}))}updateConnectedCell(e,t){t.oldValues.forEach(this._deregisterCellChanges.bind(this)),t.newValues.forEach(this._registerCellChanges.bind(this))}_deregisterCellChanges(e){}_registerCellChanges(e){const t=this._getCodeCell(e);t?(t.displayChanged.connect((()=>{this._updateCodeCell(t)})),t.inViewportChanged.connect((()=>{this._updateCodeCell(t)})),this._updateCodeCell(t)):"code"===e.type&&console.error(`Could not find code cell for model: ${e}`)}_getCodeCell(e){return"code"===e.type?this._panel.content.widgets.find((t=>t.model===e)):null}_updateCodeCell(e){if(e.inputArea){const t=e.layout;if(t){const n=t;n.widgets[1].hasClass(Xe)||n.insertWidget(1,new Ye(e,this._props))}}}}class tt{constructor(){var e,t,n;e=this,n=void 0,(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t="_props"))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}init(e){this._props=e}createNew(e,t){new et(e,this._props)}get component(){return null}}const nt=new v.Od;function at(){const{notebookId:e}=(0,s.g)();if(!e)return(0,S.jsx)(S.Fragment,{});const t=(0,ke.J)(),v=(0,o.S)(),w=(0,we.Z)(),N=function(e){const{getAIAgent:t}=(0,Ae.w)(),{aiAgents:n,addAIAgent:s,deleteAIAgent:r,updateAIAgent:i}=(0,Se.Ks)();return(0,a.useEffect)((()=>{let a;const o=setInterval((async()=>{a=new AbortController;try{const o=await t(e,{signal:a.signal});if(!o.success)return void r(e);const l=n.find((t=>t.documentId===e)),c=o.agent.runtime?.id;l?l.runtimeId!==c&&i(e,c):s({documentId:e,runtimeId:c})}catch(t){r(e)}}),6e4);return()=>{a?.abort("Component unmounted"),clearInterval(o)}}),[n,e]),n.find((t=>t.documentId===e))}(e),{checkIsPlatformFeaturesPreviewer:R}=(0,_e.x)(),T=R(t),{configuration:E}=(0,Ne._O)(),{credits:D,token:P}=(0,Re.Y)(),{configuration:M,multiServiceManager:$,jupyterLabAdapter:U,remoteKernels:L}=(0,z.xb)(),[V,W]=(0,a.useState)(nt),[G,K]=(0,a.useState)(void 0),[B,Q]=(0,a.useState)(),[X,Z]=(0,a.useState)(!1),[ee,te]=(0,a.useState)(),[ne,ae]=(0,a.useState)(!1),[se,re]=(0,a.useState)(!0),[ie,oe]=(0,a.useState)(""),[le,ce]=(0,a.useState)(null),[de,pe]=(0,a.useState)(),[he,ge]=(0,a.useState)(),[fe,xe]=(0,a.useState)(null),[ve,be]=(0,a.useState)({name:"",nameConfirm:"",description:""}),[je,ye]=(0,a.useState)({name:void 0,nameConfirm:void 0,description:void 0}),{enqueueToast:Ee,trackAsyncTask:De}=(0,H.d)(),{selectNotebookModel:Pe,reset:Ue}=(0,b.Gx)(),{hideBackdrop:Le,screenCapture:ze,setItem:Ve,setScreenCapture:Ge,showBackdrop:Ke,showScreenshot:Be,space:Qe,triggerItemsRefresh:He}=(0,Te.l5)(),{cloneNotebook:qe,deleteItem:Je,getDatasources:Xe,getNotebook:Ye,refreshDatasources:Ze,refreshNotebook:et,updateNotebook:at,updateNotebookModel:st}=(0,Ie.E)(),{updateDatasources:rt}=Me(),{updateAIAgent:it}=(0,Se.Ks)(),{patchAIAgent:ot}=(0,Ae.w)(),lt=(0,a.useMemo)((()=>({baseURL:E.spacerRunUrl,token:P,roomName:e,type:"datalayer"})),[E.spacerRunUrl,e,P]),ct=(0,a.useMemo)((()=>[new tt,new j._({factory:y.N})]),[]),dt=(0,a.useMemo)((()=>new i.J),[]),ut=(0,a.useMemo)((()=>[Oe]),[]),mt=(0,a.useMemo)((()=>(0,$e.Kp)()),[]);(0,a.useEffect)((()=>{(0,Fe.wj)()}),[]),(0,a.useEffect)((()=>{if(L&&L.length>0&&!ee){const e=L[0];ht({runtimeDesc:{name:e.environment_name,language:"",location:"remote",displayName:e.kernel_given_name,id:e.id,burningRate:e.burning_rate,podName:e.jupyter_pod_name},kernelModel:e})}}),[L]),(0,a.useEffect)((()=>{le&&le.sharedModel.awareness.setLocalStateField("user",{username:t.id,name:t.handle,display_name:t.displayName,initials:`${t.firstName[0]?.toLocaleUpperCase()??"?"}${t.lastName[0]?.toLocaleUpperCase()||"?"}`,color:mt,avatar_url:t.avatarUrl})}),[le,t,mt]),(0,a.useEffect)((()=>(Ke(),et(e).then((t=>{if(Le(),t.success){const t=Ye(e);t?(pe(t),ge(t.nbformat),Ve(t),be({name:t.name,nameConfirm:"",description:t.description})):w("/")}else Ee(t.message,{variant:"error"})})).finally((()=>{Le()})),()=>{V.dispose(),pe(void 0),Ue(),Ve(void 0)})),[e]),(0,a.useEffect)((()=>{Ze().then((e=>{if(e.success){const e=Xe();rt(e)}}))}),[e]),(0,a.useEffect)((()=>{N&&ie&&N.runtimeId!==G&&(ot(e,V.serverSettings.baseUrl,V.serverSettings.token,G),it(e,G))}),[N,G,e,ie,V]),(0,a.useEffect)((()=>{ye({...je,name:void 0===ve.name?void 0:ve.name.length>2,nameConfirm:ve.nameConfirm===de?.name,description:void 0===ve.description?void 0:ve.description.length>2})}),[ve]);const pt=(0,a.useCallback)((async()=>{Ke(),at(e,ve.name,ve.description).then((e=>{e.success&&(Ee("The notebook is successfully updated.",{variant:"success"}),He(),pe({...de,name:ve.name,description:ve.description}))})).finally((()=>{Le()}))}),[e,ve.name,ve.description,de]),ht=(0,a.useCallback)((async({runtimeDesc:a,kernelModel:s,transferState:i})=>{const o=Pe(e);o?.model&&ge(o.model.toJSON()),Q(a);const l=a?.location;switch(oe(""),l){case void 0:K(void 0),re(!0),Z(!1),W(nt);break;case"browser":if($?.browser){if(U){if(!U.jupyterLab.hasPlugin("@jupyterlite/pyodide-kernel-extension:kernel")){const e=await Promise.all([n.e(484),n.e(5378)]).then(n.bind(n,28924));U.jupyterLab.registerPluginModule(e)}U.jupyterLab.isPluginActivated("@jupyterlite/pyodide-kernel-extension:kernel")||await U.jupyterLab.activatePlugin("@jupyterlite/pyodide-kernel-extension:kernel")}K(void 0),re(!1),Z(!0),W($.browser)}else console.error("Unable to use browser kernel. No service manager for it.");break;case"remote":{if(!$?.remote){console.error("Unable to use a remote kernel. No service manager for it.");break}let e;if(i&&V&&V===$?.browser&&ee?.kernel)try{Ke();let t=!0;const n=ee.kernel.id,a=`pyodide-${n}`,s=(0,J._)({connection:ee.kernel,metadata:{filename:`${a}.data`},onUploadProgress:()=>{t&&(t=!1,(0,q.v2)().then((t=>{e=t.find((e=>e.name===a))})))}});if(De(s,{error:{message:e=>`Failed to save the browser kernel state. ${e}`},pending:{message:"Saving the browser kernel state…"},success:{message:()=>"Browser kernel state saved."}}),await s,!e)throw Error("Unable to find snapshot for pyodide state.");await $.browser.kernels.shutdown(n)}finally{Le()}if(!s){const{name:n,displayName:r,params:i}=a,o=await($?.remote?.kernels.startNew({name:n,runtimeType:"notebook",givenName:r,creditsLimit:i?.creditsLimit??(D?.available??0)/Math.max(M.maxCellKernels-L.filter((e=>"cell"!==e.kernel_type)).length,1),capabilities:i?.capabilities,snapshot:e?.id},{username:t?.handle,handleComms:!0}));s=await $.remote.kernels.findById(o.id),o.dispose()}Z(!1),K(s.id),re(!1);const n=$.remote.kernels.getServices(s.jupyter_pod_name);oe(s.jupyter_pod_name);const o=new r.ServiceManager({contents:n?.contents,kernels:n?.kernels,kernelspecs:n?.kernelspecs,serverSettings:n?.serverSettings,sessions:n?.sessions,events:{dispose:()=>{}},terminals:{connectionFailure:{connect:()=>{}},dispose:()=>{},isAvailable:()=>!1}});W(o),xe("storage");break}}xt(void 0)}),[M,D,U,e,$,L,V,ee]),gt=(0,a.useCallback)((async t=>{v({title:"Are you sure?",content:"Please confirm you want to clone this notebook in your private library."}).then((t=>{t&&(Ke(),qe(e).then((e=>{Le(),e.success&&(Ee(e.message,{variant:"success"}),He(),w("/my-library"))})))}))}),[v,de]),ft=(0,a.useCallback)((e=>{ce(e)}),[]),xt=(0,a.useCallback)((e=>{te(e||void 0)}),[]),vt=(0,a.useCallback)((()=>{if(!se&&le?.cells){Ke("Saving the notebook...");const t=le.toJSON();st(e,t).then((n=>{n.success&&(Ee("The notebook is successfully updated.",{variant:"success"}),pe({...de,id:e,nbformat:t}))})).finally((()=>{Le()}))}}),[e,le,se]),bt=(0,a.useCallback)((()=>{xe("storage"!==fe&&V&&V!==nt?"storage":null)}),[fe,V]);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(l.z,{"aria-label":"Notebook Editor",children:[(0,S.jsx)(l.z.TitleArea,{variant:"subtitle",children:(0,S.jsx)(l.z.Title,{children:"Notebook Editor"})}),(0,S.jsx)(l.z.Actions,{children:de&&Qe&&(0,S.jsxs)(I.a,{sx:{flex:"0 0 auto",display:"flex",alignItems:"center"},children:[$?.remote&&ee&&ee.kernel&&(0,S.jsx)(F.m,{kernelId:ee.kernel.id,serviceManager:$.remote,onClick:()=>{w("/runtimes")}},"credits-indicator"),(0,S.jsx)(O,{assignKernel:ht,sessionConnection:ee},"kernel-picker"),(0,S.jsx)(Y,{connection:ee?.kernel??void 0,multiServiceManager:$,podName:ie,disabled:void 0===B?.location,children:"Snapshots"}),(0,S.jsx)(c.Q,{title:"Browse content on the Remote Runtime",variant:"invisible",size:"small",disabled:!V||V===nt,leadingVisual:()=>(0,S.jsx)(_.Cx,{type:"content"}),onClick:bt,children:"Storage"},"content"),(0,S.jsx)(me.E,{commandRegistry:dt,runtimeDesc:B,save:vt,sessionConnection:ee},"toolbar"),(0,S.jsx)(c.Q,{variant:"invisible",size:"small",leadingVisual:x.Nc$,onClick:gt,children:"Duplicate"},"clone"),T&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(c.Q,{title:"Capture screen",variant:"invisible",size:"small",leadingVisual:()=>(0,S.jsx)(x.rVi,{}),onClick:()=>{Be()},children:"Capture"},"capture-screen"),(0,S.jsx)(c.Q,{title:"Share",variant:"invisible",size:"small",leadingVisual:()=>(0,S.jsx)(_.Cx,{type:"share"}),onClick:e=>ae(!ne),children:"Share"},"share"),(0,S.jsx)(c.Q,{variant:"invisible",size:"small",leadingVisual:()=>(0,S.jsx)(_.Cx,{type:"page"}),onClick:t=>w(`/new/page/notebook/${e}`),children:"Publish"},"public")]}),(0,S.jsx)(c.Q,{variant:"invisible",size:"small",leadingVisual:x.L64,onClick:e=>{xe("properties"===fe?null:"properties")},children:"Properties"},"properties"),"datalayer"===lt.type&&le&&(0,S.jsx)(Ce,{awareness:le.sharedModel.awareness,currentUserHandle:t.handle},"peers")]})})]}),(0,S.jsxs)(d.O7,{children:[(0,S.jsxs)(d.O7.Content,{"aria-label":"Notebook Editor",width:"full",padding:"none",children:[ze&&(0,S.jsx)(I.a,{mt:3,children:(0,S.jsxs)(I.a,{display:"flex",children:[(0,S.jsx)(I.a,{children:(0,S.jsx)("img",{src:ze})}),(0,S.jsx)(I.a,{children:(0,S.jsx)(u.A,{href:"javascript: return false;",onClick:e=>Ge(void 0),children:(0,S.jsx)(x.uv5,{})})})]})}),ne&&(0,S.jsx)(I.a,{sx:{flexGrow:1},children:(0,S.jsx)(We.a,{})}),he&&(void 0===B?.location?(0,S.jsx)(I.a,{sx:{"& .jp-Cell":{marginTop:30}},children:(0,S.jsx)(C.j,{nbformat:he,outputs:!0})}):(0,S.jsx)(I.a,{sx:{"& .jp-WindowedPanel":{margin:0},"& .jp-WindowedPanel-viewport":{padding:0},"& .dla-CellSidebar-Container":{position:"relative",marginLeft:"auto"},"& .jp-Cell .dla-CellSidebar-Container":{display:"none"},"& .jp-Cell.jp-mod-active .dla-CellSidebar-Container":{display:"block"}},children:(0,S.jsx)(k.k,{commands:dt,extensions:ct,id:e,collaborationServer:lt,nbformat:he,readonly:se,renderers:ut,kernelId:G,serviceManager:V,startDefaultKernel:X,height:"calc(100vh - 150px)",maxHeight:"calc(100vh - 150px)",cellSidebarMargin:32,onNotebookModelChanged:ft,onSessionConnection:xt})}))]}),null!==fe&&(0,S.jsx)(d.O7.Pane,{"aria-label":"storage"===fe?"Remote Runtime Storage":"Notebook Properties",position:"start",width:"large",children:"storage"===fe&&V.contents?(0,S.jsx)(ue,{contents:V.contents,documentRegistry:U?.jupyterLab.docRegistry}):"properties"===fe?(0,S.jsxs)(I.a,{as:"form",sx:{label:{marginTop:2}},children:[(0,S.jsxs)(m.A,{children:[(0,S.jsx)(m.A.Label,{children:"Name"}),(0,S.jsx)(p.A,{block:!0,value:ve.name,onChange:e=>{be((t=>({...t,name:e.target.value})))}}),!1===je.name&&(0,S.jsx)(m.A.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,S.jsxs)(m.A,{children:[(0,S.jsx)(m.A.Label,{children:"Description"}),(0,S.jsx)(h.Ay,{block:!0,value:ve.description,onChange:e=>{be((t=>({...t,description:e.target.value})))}}),!1===je.description&&(0,S.jsx)(m.A.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,S.jsx)(m.A,{children:(0,S.jsx)(c.Q,{variant:"primary",disabled:!je.name||!je.description,sx:{marginTop:2},onClick:pt,children:"Update Notebook Properties"})}),(0,S.jsx)(I.a,{mt:3}),(0,S.jsx)(A,{variant:"default",data:he,fileName:`notebook-${e}`,extension:"ipynb"}),(0,S.jsxs)(I.a,{sx:{marginTop:3},children:[(0,S.jsx)(g.A,{as:"h2",sx:{fontSize:4,fontWeight:"normal",color:"danger.fg",mb:2},children:"Danger zone"}),(0,S.jsxs)(I.a,{sx:{border:"1px solid",borderColor:"danger.emphasis",borderRadius:2,p:3,alignItems:"center",justifyContent:"space-between",gap:3},children:[(0,S.jsxs)(I.a,{sx:{display:"grid",gap:1},children:[(0,S.jsx)(f.A,{sx:{fontSize:1,fontWeight:"bold",color:"danger.fg"},children:"Confirm the notebook name to delete"}),(0,S.jsx)(m.A,{children:(0,S.jsx)(p.A,{block:!0,value:ve.nameConfirm,onChange:e=>{be((t=>({...t,nameConfirm:e.target.value})))}})}),(0,S.jsx)(f.A,{sx:{fontSize:1,color:"fg.muted"},children:"This operation is not reversible."})]}),(0,S.jsx)(c.Q,{variant:"danger",disabled:!je.nameConfirm,onClick:async()=>{Ke("Deleting the notebook..."),Je(de.id).then((e=>{e.success&&(Ee("The notebook is successfully deleted.",{variant:"success"}),w("/my-library"))})).finally((()=>{Le()}))},children:"Delete notebook"})]})]})]}):(0,S.jsx)(S.Fragment,{})})]})]})}const st=at}}]);